import{c as cr,d as wi,g as Qv,e as ne,f as Ar,j as e1,w as Rl,k as Tl,l as lc,t as co,m as t1,o as Nl,I as mi,A as r1,U as i1,p as Q,q as s1,u as rc,v as n1,_ as o1,P as a1,V as xh,x as c1,y as u1,z as h1,Z as Ih,$ as l1,E as f1,G as so,H as p1,N as fc,J as Dl,K as Fr,L as d1,M as g1,X as as,O as Ft,Q as er,R as vi,S as ar,T as y1,Y as cs,a0 as Fl,a1 as v1,a2 as m1,a3 as _1,a4 as Ll,a5 as w1,a6 as $l,a7 as Ml,a8 as hs,a9 as ic,aa as to,ab as ls,ac as b1,ad as ro,ae as E1,af as x1,ag as I1,ah as S1,ai as P1,aj as qa,ak as Sh,al as A1,am as C1,an as O1,ao as Ph,ap as R1,aq as T1,ar as N1,as as D1,at as F1,au as L1,av as $1,aw as io,ax as jl,ay as za,az as M1,aA as j1}from"./index-3938b977.js";var uo={},Vs={};Object.defineProperty(Vs,"__esModule",{value:!0});function U1(u){if(typeof u!="string")throw new Error(`Cannot safe json parse value of type ${typeof u}`);try{return JSON.parse(u)}catch{return u}}Vs.safeJsonParse=U1;function q1(u){return typeof u=="string"?u:JSON.stringify(u,(i,r)=>typeof r>"u"?null:r)}Vs.safeJsonStringify=q1;var Ns={exports:{}},Ah;function z1(){return Ah||(Ah=1,function(){let u;function i(){}u=i,u.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},u.prototype.setItem=function(r,n){this[r]=String(n)},u.prototype.removeItem=function(r){delete this[r]},u.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},u.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},u.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof cr<"u"&&cr.localStorage?Ns.exports=cr.localStorage:typeof window<"u"&&window.localStorage?Ns.exports=window.localStorage:Ns.exports=new i}()),Ns.exports}var ka={},Ds={},Ch;function k1(){if(Ch)return Ds;Ch=1,Object.defineProperty(Ds,"__esModule",{value:!0}),Ds.IKeyValueStorage=void 0;class u{}return Ds.IKeyValueStorage=u,Ds}var Fs={},Oh;function H1(){if(Oh)return Fs;Oh=1,Object.defineProperty(Fs,"__esModule",{value:!0}),Fs.parseEntry=void 0;const u=Vs;function i(r){var n;return[r[0],u.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return Fs.parseEntry=i,Fs}var Rh;function B1(){return Rh||(Rh=1,function(u){Object.defineProperty(u,"__esModule",{value:!0});const i=wi;i.__exportStar(k1(),u),i.__exportStar(H1(),u)}(ka)),ka}Object.defineProperty(uo,"__esModule",{value:!0});uo.KeyValueStorage=void 0;const us=wi,Th=Vs,V1=us.__importDefault(z1()),K1=B1();class Ul{constructor(){this.localStorage=V1.default}getKeys(){return us.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return us.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(K1.parseEntry)})}getItem(i){return us.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(i);if(r!==null)return Th.safeJsonParse(r)})}setItem(i,r){return us.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(i,Th.safeJsonStringify(r))})}removeItem(i){return us.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(i)})}}uo.KeyValueStorage=Ul;var G1=uo.default=Ul,fs={},Ls={},Ha={},$s={};let Ui=class{};const W1=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Ui},Symbol.toStringTag,{value:"Module"})),J1=Qv(W1);var Nh;function Y1(){if(Nh)return $s;Nh=1,Object.defineProperty($s,"__esModule",{value:!0}),$s.IHeartBeat=void 0;const u=J1;class i extends u.IEvents{constructor(n){super()}}return $s.IHeartBeat=i,$s}var Dh;function ql(){return Dh||(Dh=1,function(u){Object.defineProperty(u,"__esModule",{value:!0}),wi.__exportStar(Y1(),u)}(Ha)),Ha}var Ba={},Mi={},Fh;function X1(){if(Fh)return Mi;Fh=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.HEARTBEAT_EVENTS=Mi.HEARTBEAT_INTERVAL=void 0;const u=ne;return Mi.HEARTBEAT_INTERVAL=u.FIVE_SECONDS,Mi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Mi}var Lh;function zl(){return Lh||(Lh=1,function(u){Object.defineProperty(u,"__esModule",{value:!0}),wi.__exportStar(X1(),u)}(Ba)),Ba}var $h;function Z1(){if($h)return Ls;$h=1,Object.defineProperty(Ls,"__esModule",{value:!0}),Ls.HeartBeat=void 0;const u=wi,i=Ar,r=ne,n=ql(),o=zl();class l extends n.IHeartBeat{constructor(v){super(v),this.events=new i.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=v?.interval||o.HEARTBEAT_INTERVAL}static init(v){return u.__awaiter(this,void 0,void 0,function*(){const w=new l(v);return yield w.init(),w})}init(){return u.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(v,w){this.events.on(v,w)}once(v,w){this.events.once(v,w)}off(v,w){this.events.off(v,w)}removeListener(v,w){this.events.removeListener(v,w)}initialize(){return u.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Ls.HeartBeat=l,Ls}(function(u){Object.defineProperty(u,"__esModule",{value:!0});const i=wi;i.__exportStar(Z1(),u),i.__exportStar(ql(),u),i.__exportStar(zl(),u)})(fs);var Re={},Va,Mh;function Q1(){if(Mh)return Va;Mh=1;function u(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Va=i;function i(r,n,o){var l=o&&o.stringify||u,d=1;if(typeof r=="object"&&r!==null){var v=n.length+d;if(v===1)return r;var w=new Array(v);w[0]=l(r);for(var A=1;A<v;A++)w[A]=l(n[A]);return w.join(" ")}if(typeof r!="string")return r;var L=n.length;if(L===0)return r;for(var K="",J=1-d,G=-1,M=r&&r.length||0,V=0;V<M;){if(r.charCodeAt(V)===37&&V+1<M){switch(G=G>-1?G:0,r.charCodeAt(V+1)){case 100:case 102:if(J>=L||n[J]==null)break;G<V&&(K+=r.slice(G,V)),K+=Number(n[J]),G=V+2,V++;break;case 105:if(J>=L||n[J]==null)break;G<V&&(K+=r.slice(G,V)),K+=Math.floor(Number(n[J])),G=V+2,V++;break;case 79:case 111:case 106:if(J>=L||n[J]===void 0)break;G<V&&(K+=r.slice(G,V));var ie=typeof n[J];if(ie==="string"){K+="'"+n[J]+"'",G=V+2,V++;break}if(ie==="function"){K+=n[J].name||"<anonymous>",G=V+2,V++;break}K+=l(n[J]),G=V+2,V++;break;case 115:if(J>=L)break;G<V&&(K+=r.slice(G,V)),K+=String(n[J]),G=V+2,V++;break;case 37:G<V&&(K+=r.slice(G,V)),K+="%",G=V+2,V++,J--;break}++J}++V}return G===-1?r:(G<M&&(K+=r.slice(G)),K)}return Va}var Ka,jh;function em(){if(jh)return Ka;jh=1;const u=Q1();Ka=o;const i=le().console||{},r={mapHttpRequest:M,mapHttpResponse:M,wrapRequestSerializer:V,wrapResponseSerializer:V,wrapErrorSerializer:V,req:M,res:M,err:J};function n(T,j){return Array.isArray(T)?T.filter(function(ye){return ye!=="!stdSerializers.err"}):T===!0?Object.keys(j):!1}function o(T){T=T||{},T.browser=T.browser||{};const j=T.browser.transmit;if(j&&typeof j.send!="function")throw Error("pino: transmit option must have a send function");const B=T.browser.write||i;T.browser.write&&(T.browser.asObject=!0);const ye=T.serializers||{},re=n(T.browser.serialize,ye);let ue=T.browser.serialize;Array.isArray(T.browser.serialize)&&T.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ue=!1);const Te=["error","fatal","warn","info","debug","trace"];typeof B=="function"&&(B.error=B.fatal=B.warn=B.info=B.debug=B.trace=B),T.enabled===!1&&(T.level="silent");const qe=T.level||"info",y=Object.create(B);y.log||(y.log=ie),Object.defineProperty(y,"levelVal",{get:X}),Object.defineProperty(y,"level",{get:ce,set:k});const E={transmit:j,serialize:re,asObject:T.browser.asObject,levels:Te,timestamp:G(T)};y.levels=o.levels,y.level=qe,y.setMaxListeners=y.getMaxListeners=y.emit=y.addListener=y.on=y.prependListener=y.once=y.prependOnceListener=y.removeListener=y.removeAllListeners=y.listeners=y.listenerCount=y.eventNames=y.write=y.flush=ie,y.serializers=ye,y._serialize=re,y._stdErrSerialize=ue,y.child=U,j&&(y._logEvent=K());function X(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ce(){return this._level}function k(z){if(z!=="silent"&&!this.levels.values[z])throw Error("unknown level "+z);this._level=z,l(E,y,"error","log"),l(E,y,"fatal","error"),l(E,y,"warn","error"),l(E,y,"info","log"),l(E,y,"debug","log"),l(E,y,"trace","log")}function U(z,H){if(!z)throw new Error("missing bindings for child Pino");H=H||{},re&&z.serializers&&(H.serializers=z.serializers);const Je=H.serializers;if(re&&Je){var He=Object.assign({},ye,Je),$r=T.browser.serialize===!0?Object.keys(He):re;delete z.serializers,w([z],$r,He,this._stdErrSerialize)}function xe(It){this._childLevel=(It._childLevel|0)+1,this.error=A(It,z,"error"),this.fatal=A(It,z,"fatal"),this.warn=A(It,z,"warn"),this.info=A(It,z,"info"),this.debug=A(It,z,"debug"),this.trace=A(It,z,"trace"),He&&(this.serializers=He,this._serialize=$r),j&&(this._logEvent=K([].concat(It._logEvent.bindings,z)))}return xe.prototype=this,new xe(this)}return y}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=r,o.stdTimeFunctions=Object.assign({},{nullTime:Ee,epochTime:ge,unixTime:pe,isoTime:he});function l(T,j,B,ye){const re=Object.getPrototypeOf(j);j[B]=j.levelVal>j.levels.values[B]?ie:re[B]?re[B]:i[B]||i[ye]||ie,d(T,j,B)}function d(T,j,B){!T.transmit&&j[B]===ie||(j[B]=function(ye){return function(){const ue=T.timestamp(),Te=new Array(arguments.length),qe=Object.getPrototypeOf&&Object.getPrototypeOf(this)===i?i:this;for(var y=0;y<Te.length;y++)Te[y]=arguments[y];if(T.serialize&&!T.asObject&&w(Te,this._serialize,this.serializers,this._stdErrSerialize),T.asObject?ye.call(qe,v(this,B,Te,ue)):ye.apply(qe,Te),T.transmit){const E=T.transmit.level||j.level,X=o.levels.values[E],ce=o.levels.values[B];if(ce<X)return;L(this,{ts:ue,methodLevel:B,methodValue:ce,transmitLevel:E,transmitValue:o.levels.values[T.transmit.level||j.level],send:T.transmit.send,val:j.levelVal},Te)}}}(j[B]))}function v(T,j,B,ye){T._serialize&&w(B,T._serialize,T.serializers,T._stdErrSerialize);const re=B.slice();let ue=re[0];const Te={};ye&&(Te.time=ye),Te.level=o.levels.values[j];let qe=(T._childLevel|0)+1;if(qe<1&&(qe=1),ue!==null&&typeof ue=="object"){for(;qe--&&typeof re[0]=="object";)Object.assign(Te,re.shift());ue=re.length?u(re.shift(),re):void 0}else typeof ue=="string"&&(ue=u(re.shift(),re));return ue!==void 0&&(Te.msg=ue),Te}function w(T,j,B,ye){for(const re in T)if(ye&&T[re]instanceof Error)T[re]=o.stdSerializers.err(T[re]);else if(typeof T[re]=="object"&&!Array.isArray(T[re]))for(const ue in T[re])j&&j.indexOf(ue)>-1&&ue in B&&(T[re][ue]=B[ue](T[re][ue]))}function A(T,j,B){return function(){const ye=new Array(1+arguments.length);ye[0]=j;for(var re=1;re<ye.length;re++)ye[re]=arguments[re-1];return T[B].apply(this,ye)}}function L(T,j,B){const ye=j.send,re=j.ts,ue=j.methodLevel,Te=j.methodValue,qe=j.val,y=T._logEvent.bindings;w(B,T._serialize||Object.keys(T.serializers),T.serializers,T._stdErrSerialize===void 0?!0:T._stdErrSerialize),T._logEvent.ts=re,T._logEvent.messages=B.filter(function(E){return y.indexOf(E)===-1}),T._logEvent.level.label=ue,T._logEvent.level.value=Te,ye(ue,T._logEvent,qe),T._logEvent=K(y)}function K(T){return{ts:0,messages:[],bindings:T||[],level:{label:"",value:0}}}function J(T){const j={type:T.constructor.name,msg:T.message,stack:T.stack};for(const B in T)j[B]===void 0&&(j[B]=T[B]);return j}function G(T){return typeof T.timestamp=="function"?T.timestamp:T.timestamp===!1?Ee:ge}function M(){return{}}function V(T){return T}function ie(){}function Ee(){return!1}function ge(){return Date.now()}function pe(){return Math.round(Date.now()/1e3)}function he(){return new Date(Date.now()).toISOString()}function le(){function T(j){return typeof j<"u"&&j}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return T(self)||T(window)||T(this)||{}}}return Ka}var ji={},Uh;function kl(){return Uh||(Uh=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.PINO_CUSTOM_CONTEXT_KEY=ji.PINO_LOGGER_DEFAULTS=void 0,ji.PINO_LOGGER_DEFAULTS={level:"info"},ji.PINO_CUSTOM_CONTEXT_KEY="custom_context"),ji}var Qt={},qh;function tm(){if(qh)return Qt;qh=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.generateChildLogger=Qt.formatChildLoggerContext=Qt.getLoggerContext=Qt.setBrowserLoggerContext=Qt.getBrowserLoggerContext=Qt.getDefaultLoggerOptions=void 0;const u=kl();function i(v){return Object.assign(Object.assign({},v),{level:v?.level||u.PINO_LOGGER_DEFAULTS.level})}Qt.getDefaultLoggerOptions=i;function r(v,w=u.PINO_CUSTOM_CONTEXT_KEY){return v[w]||""}Qt.getBrowserLoggerContext=r;function n(v,w,A=u.PINO_CUSTOM_CONTEXT_KEY){return v[A]=w,v}Qt.setBrowserLoggerContext=n;function o(v,w=u.PINO_CUSTOM_CONTEXT_KEY){let A="";return typeof v.bindings>"u"?A=r(v,w):A=v.bindings().context||"",A}Qt.getLoggerContext=o;function l(v,w,A=u.PINO_CUSTOM_CONTEXT_KEY){const L=o(v,A);return L.trim()?`${L}/${w}`:w}Qt.formatChildLoggerContext=l;function d(v,w,A=u.PINO_CUSTOM_CONTEXT_KEY){const L=l(v,w,A),K=v.child({context:L});return n(K,L,A)}return Qt.generateChildLogger=d,Qt}(function(u){Object.defineProperty(u,"__esModule",{value:!0}),u.pino=void 0;const i=wi,r=i.__importDefault(em());Object.defineProperty(u,"pino",{enumerable:!0,get:function(){return r.default}}),i.__exportStar(kl(),u),i.__exportStar(tm(),u)})(Re);class rm extends Ui{constructor(i){super(),this.opts=i,this.protocol="wc",this.version=2}}class im extends Ui{constructor(i,r){super(),this.core=i,this.logger=r,this.records=new Map}}class sm{constructor(i,r){this.logger=i,this.core=r}}let nm=class extends Ui{constructor(i,r){super(),this.relayer=i,this.logger=r}},om=class extends Ui{constructor(i){super()}},am=class{constructor(i,r,n,o){this.core=i,this.logger=r,this.name=n}};class cm extends Ui{constructor(i,r){super(),this.relayer=i,this.logger=r}}let um=class extends Ui{constructor(i,r){super(),this.core=i,this.logger=r}},hm=class{constructor(i,r){this.projectId=i,this.logger=r}},lm=class{constructor(i){this.opts=i,this.protocol="wc",this.version=2}},fm=class{constructor(i){this.client=i}};const pm=u=>JSON.stringify(u,(i,r)=>typeof r=="bigint"?r.toString()+"n":r),dm=u=>{const i=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=u.replace(i,'$1"$2n"$3');return JSON.parse(r,(n,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function pc(u){if(typeof u!="string")throw new Error(`Cannot safe json parse value of type ${typeof u}`);try{return dm(u)}catch{return u}}function Bs(u){return typeof u=="string"?u:pm(u)||""}var dc={},Hl={};(function(u){Object.defineProperty(u,"__esModule",{value:!0});var i=e1,r=Rl;u.DIGEST_LENGTH=64,u.BLOCK_SIZE=128;var n=function(){function v(){this.digestLength=u.DIGEST_LENGTH,this.blockSize=u.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return v.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},v.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},v.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},v.prototype.update=function(w,A){if(A===void 0&&(A=w.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var L=0;if(this._bytesHashed+=A,this._bufferLength>0){for(;this._bufferLength<u.BLOCK_SIZE&&A>0;)this._buffer[this._bufferLength++]=w[L++],A--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(A>=this.blockSize&&(L=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,w,L,A),A%=this.blockSize);A>0;)this._buffer[this._bufferLength++]=w[L++],A--;return this},v.prototype.finish=function(w){if(!this._finished){var A=this._bytesHashed,L=this._bufferLength,K=A/536870912|0,J=A<<3,G=A%128<112?128:256;this._buffer[L]=128;for(var M=L+1;M<G-8;M++)this._buffer[M]=0;i.writeUint32BE(K,this._buffer,G-8),i.writeUint32BE(J,this._buffer,G-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,G),this._finished=!0}for(var M=0;M<this.digestLength/8;M++)i.writeUint32BE(this._stateHi[M],w,M*8),i.writeUint32BE(this._stateLo[M],w,M*8+4);return this},v.prototype.digest=function(){var w=new Uint8Array(this.digestLength);return this.finish(w),w},v.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},v.prototype.restoreState=function(w){return this._stateHi.set(w.stateHi),this._stateLo.set(w.stateLo),this._bufferLength=w.bufferLength,w.buffer&&this._buffer.set(w.buffer),this._bytesHashed=w.bytesHashed,this._finished=!1,this},v.prototype.cleanSavedState=function(w){r.wipe(w.stateHi),r.wipe(w.stateLo),w.buffer&&r.wipe(w.buffer),w.bufferLength=0,w.bytesHashed=0},v}();u.SHA512=n;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(v,w,A,L,K,J,G){for(var M=A[0],V=A[1],ie=A[2],Ee=A[3],ge=A[4],pe=A[5],he=A[6],le=A[7],T=L[0],j=L[1],B=L[2],ye=L[3],re=L[4],ue=L[5],Te=L[6],qe=L[7],y,E,X,ce,k,U,z,H;G>=128;){for(var Je=0;Je<16;Je++){var He=8*Je+J;v[Je]=i.readUint32BE(K,He),w[Je]=i.readUint32BE(K,He+4)}for(var Je=0;Je<80;Je++){var $r=M,xe=V,It=ie,R=Ee,O=ge,P=pe,c=he,b=le,ee=T,fe=j,we=B,Ne=ye,Fe=re,Pe=ue,St=Te,mt=qe;if(y=le,E=qe,k=E&65535,U=E>>>16,z=y&65535,H=y>>>16,y=(ge>>>14|re<<32-14)^(ge>>>18|re<<32-18)^(re>>>41-32|ge<<32-(41-32)),E=(re>>>14|ge<<32-14)^(re>>>18|ge<<32-18)^(ge>>>41-32|re<<32-(41-32)),k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,y=ge&pe^~ge&he,E=re&ue^~re&Te,k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,y=o[Je*2],E=o[Je*2+1],k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,y=v[Je%16],E=w[Je%16],k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,X=z&65535|H<<16,ce=k&65535|U<<16,y=X,E=ce,k=E&65535,U=E>>>16,z=y&65535,H=y>>>16,y=(M>>>28|T<<32-28)^(T>>>34-32|M<<32-(34-32))^(T>>>39-32|M<<32-(39-32)),E=(T>>>28|M<<32-28)^(M>>>34-32|T<<32-(34-32))^(M>>>39-32|T<<32-(39-32)),k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,y=M&V^M&ie^V&ie,E=T&j^T&B^j&B,k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,b=z&65535|H<<16,mt=k&65535|U<<16,y=R,E=Ne,k=E&65535,U=E>>>16,z=y&65535,H=y>>>16,y=X,E=ce,k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,R=z&65535|H<<16,Ne=k&65535|U<<16,V=$r,ie=xe,Ee=It,ge=R,pe=O,he=P,le=c,M=b,j=ee,B=fe,ye=we,re=Ne,ue=Fe,Te=Pe,qe=St,T=mt,Je%16===15)for(var He=0;He<16;He++)y=v[He],E=w[He],k=E&65535,U=E>>>16,z=y&65535,H=y>>>16,y=v[(He+9)%16],E=w[(He+9)%16],k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,X=v[(He+1)%16],ce=w[(He+1)%16],y=(X>>>1|ce<<32-1)^(X>>>8|ce<<32-8)^X>>>7,E=(ce>>>1|X<<32-1)^(ce>>>8|X<<32-8)^(ce>>>7|X<<32-7),k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,X=v[(He+14)%16],ce=w[(He+14)%16],y=(X>>>19|ce<<32-19)^(ce>>>61-32|X<<32-(61-32))^X>>>6,E=(ce>>>19|X<<32-19)^(X>>>61-32|ce<<32-(61-32))^(ce>>>6|X<<32-6),k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,v[He]=z&65535|H<<16,w[He]=k&65535|U<<16}y=M,E=T,k=E&65535,U=E>>>16,z=y&65535,H=y>>>16,y=A[0],E=L[0],k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[0]=M=z&65535|H<<16,L[0]=T=k&65535|U<<16,y=V,E=j,k=E&65535,U=E>>>16,z=y&65535,H=y>>>16,y=A[1],E=L[1],k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[1]=V=z&65535|H<<16,L[1]=j=k&65535|U<<16,y=ie,E=B,k=E&65535,U=E>>>16,z=y&65535,H=y>>>16,y=A[2],E=L[2],k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[2]=ie=z&65535|H<<16,L[2]=B=k&65535|U<<16,y=Ee,E=ye,k=E&65535,U=E>>>16,z=y&65535,H=y>>>16,y=A[3],E=L[3],k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[3]=Ee=z&65535|H<<16,L[3]=ye=k&65535|U<<16,y=ge,E=re,k=E&65535,U=E>>>16,z=y&65535,H=y>>>16,y=A[4],E=L[4],k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[4]=ge=z&65535|H<<16,L[4]=re=k&65535|U<<16,y=pe,E=ue,k=E&65535,U=E>>>16,z=y&65535,H=y>>>16,y=A[5],E=L[5],k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[5]=pe=z&65535|H<<16,L[5]=ue=k&65535|U<<16,y=he,E=Te,k=E&65535,U=E>>>16,z=y&65535,H=y>>>16,y=A[6],E=L[6],k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[6]=he=z&65535|H<<16,L[6]=Te=k&65535|U<<16,y=le,E=qe,k=E&65535,U=E>>>16,z=y&65535,H=y>>>16,y=A[7],E=L[7],k+=E&65535,U+=E>>>16,z+=y&65535,H+=y>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[7]=le=z&65535|H<<16,L[7]=qe=k&65535|U<<16,J+=128,G-=128}return J}function d(v){var w=new n;w.update(v);var A=w.digest();return w.clean(),A}u.hash=d})(Hl);(function(u){Object.defineProperty(u,"__esModule",{value:!0}),u.convertSecretKeyToX25519=u.convertPublicKeyToX25519=u.verify=u.sign=u.extractPublicKeyFromSecretKey=u.generateKeyPair=u.generateKeyPairFromSeed=u.SEED_LENGTH=u.SECRET_KEY_LENGTH=u.PUBLIC_KEY_LENGTH=u.SIGNATURE_LENGTH=void 0;const i=Tl,r=Hl,n=Rl;u.SIGNATURE_LENGTH=64,u.PUBLIC_KEY_LENGTH=32,u.SECRET_KEY_LENGTH=64,u.SEED_LENGTH=32;function o(R){const O=new Float64Array(16);if(R)for(let P=0;P<R.length;P++)O[P]=R[P];return O}const l=new Uint8Array(32);l[0]=9;const d=o(),v=o([1]),w=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),A=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),L=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),K=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),J=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function G(R,O){for(let P=0;P<16;P++)R[P]=O[P]|0}function M(R){let O=1;for(let P=0;P<16;P++){let c=R[P]+O+65535;O=Math.floor(c/65536),R[P]=c-O*65536}R[0]+=O-1+37*(O-1)}function V(R,O,P){const c=~(P-1);for(let b=0;b<16;b++){const ee=c&(R[b]^O[b]);R[b]^=ee,O[b]^=ee}}function ie(R,O){const P=o(),c=o();for(let b=0;b<16;b++)c[b]=O[b];M(c),M(c),M(c);for(let b=0;b<2;b++){P[0]=c[0]-65517;for(let fe=1;fe<15;fe++)P[fe]=c[fe]-65535-(P[fe-1]>>16&1),P[fe-1]&=65535;P[15]=c[15]-32767-(P[14]>>16&1);const ee=P[15]>>16&1;P[14]&=65535,V(c,P,1-ee)}for(let b=0;b<16;b++)R[2*b]=c[b]&255,R[2*b+1]=c[b]>>8}function Ee(R,O){let P=0;for(let c=0;c<32;c++)P|=R[c]^O[c];return(1&P-1>>>8)-1}function ge(R,O){const P=new Uint8Array(32),c=new Uint8Array(32);return ie(P,R),ie(c,O),Ee(P,c)}function pe(R){const O=new Uint8Array(32);return ie(O,R),O[0]&1}function he(R,O){for(let P=0;P<16;P++)R[P]=O[2*P]+(O[2*P+1]<<8);R[15]&=32767}function le(R,O,P){for(let c=0;c<16;c++)R[c]=O[c]+P[c]}function T(R,O,P){for(let c=0;c<16;c++)R[c]=O[c]-P[c]}function j(R,O,P){let c,b,ee=0,fe=0,we=0,Ne=0,Fe=0,Pe=0,St=0,mt=0,nt=0,$e=0,Xe=0,Ze=0,ot=0,ze=0,Qe=0,De=0,Be=0,ut=0,je=0,Pt=0,Lt=0,zt=0,kt=0,jt=0,Gt=0,tr=0,Mr=0,Wt=0,Vr=0,oi=0,xi=0,ht=P[0],rt=P[1],lt=P[2],ft=P[3],at=P[4],it=P[5],At=P[6],Ct=P[7],pt=P[8],Ot=P[9],dt=P[10],_t=P[11],gt=P[12],Ye=P[13],Rt=P[14],Tt=P[15];c=O[0],ee+=c*ht,fe+=c*rt,we+=c*lt,Ne+=c*ft,Fe+=c*at,Pe+=c*it,St+=c*At,mt+=c*Ct,nt+=c*pt,$e+=c*Ot,Xe+=c*dt,Ze+=c*_t,ot+=c*gt,ze+=c*Ye,Qe+=c*Rt,De+=c*Tt,c=O[1],fe+=c*ht,we+=c*rt,Ne+=c*lt,Fe+=c*ft,Pe+=c*at,St+=c*it,mt+=c*At,nt+=c*Ct,$e+=c*pt,Xe+=c*Ot,Ze+=c*dt,ot+=c*_t,ze+=c*gt,Qe+=c*Ye,De+=c*Rt,Be+=c*Tt,c=O[2],we+=c*ht,Ne+=c*rt,Fe+=c*lt,Pe+=c*ft,St+=c*at,mt+=c*it,nt+=c*At,$e+=c*Ct,Xe+=c*pt,Ze+=c*Ot,ot+=c*dt,ze+=c*_t,Qe+=c*gt,De+=c*Ye,Be+=c*Rt,ut+=c*Tt,c=O[3],Ne+=c*ht,Fe+=c*rt,Pe+=c*lt,St+=c*ft,mt+=c*at,nt+=c*it,$e+=c*At,Xe+=c*Ct,Ze+=c*pt,ot+=c*Ot,ze+=c*dt,Qe+=c*_t,De+=c*gt,Be+=c*Ye,ut+=c*Rt,je+=c*Tt,c=O[4],Fe+=c*ht,Pe+=c*rt,St+=c*lt,mt+=c*ft,nt+=c*at,$e+=c*it,Xe+=c*At,Ze+=c*Ct,ot+=c*pt,ze+=c*Ot,Qe+=c*dt,De+=c*_t,Be+=c*gt,ut+=c*Ye,je+=c*Rt,Pt+=c*Tt,c=O[5],Pe+=c*ht,St+=c*rt,mt+=c*lt,nt+=c*ft,$e+=c*at,Xe+=c*it,Ze+=c*At,ot+=c*Ct,ze+=c*pt,Qe+=c*Ot,De+=c*dt,Be+=c*_t,ut+=c*gt,je+=c*Ye,Pt+=c*Rt,Lt+=c*Tt,c=O[6],St+=c*ht,mt+=c*rt,nt+=c*lt,$e+=c*ft,Xe+=c*at,Ze+=c*it,ot+=c*At,ze+=c*Ct,Qe+=c*pt,De+=c*Ot,Be+=c*dt,ut+=c*_t,je+=c*gt,Pt+=c*Ye,Lt+=c*Rt,zt+=c*Tt,c=O[7],mt+=c*ht,nt+=c*rt,$e+=c*lt,Xe+=c*ft,Ze+=c*at,ot+=c*it,ze+=c*At,Qe+=c*Ct,De+=c*pt,Be+=c*Ot,ut+=c*dt,je+=c*_t,Pt+=c*gt,Lt+=c*Ye,zt+=c*Rt,kt+=c*Tt,c=O[8],nt+=c*ht,$e+=c*rt,Xe+=c*lt,Ze+=c*ft,ot+=c*at,ze+=c*it,Qe+=c*At,De+=c*Ct,Be+=c*pt,ut+=c*Ot,je+=c*dt,Pt+=c*_t,Lt+=c*gt,zt+=c*Ye,kt+=c*Rt,jt+=c*Tt,c=O[9],$e+=c*ht,Xe+=c*rt,Ze+=c*lt,ot+=c*ft,ze+=c*at,Qe+=c*it,De+=c*At,Be+=c*Ct,ut+=c*pt,je+=c*Ot,Pt+=c*dt,Lt+=c*_t,zt+=c*gt,kt+=c*Ye,jt+=c*Rt,Gt+=c*Tt,c=O[10],Xe+=c*ht,Ze+=c*rt,ot+=c*lt,ze+=c*ft,Qe+=c*at,De+=c*it,Be+=c*At,ut+=c*Ct,je+=c*pt,Pt+=c*Ot,Lt+=c*dt,zt+=c*_t,kt+=c*gt,jt+=c*Ye,Gt+=c*Rt,tr+=c*Tt,c=O[11],Ze+=c*ht,ot+=c*rt,ze+=c*lt,Qe+=c*ft,De+=c*at,Be+=c*it,ut+=c*At,je+=c*Ct,Pt+=c*pt,Lt+=c*Ot,zt+=c*dt,kt+=c*_t,jt+=c*gt,Gt+=c*Ye,tr+=c*Rt,Mr+=c*Tt,c=O[12],ot+=c*ht,ze+=c*rt,Qe+=c*lt,De+=c*ft,Be+=c*at,ut+=c*it,je+=c*At,Pt+=c*Ct,Lt+=c*pt,zt+=c*Ot,kt+=c*dt,jt+=c*_t,Gt+=c*gt,tr+=c*Ye,Mr+=c*Rt,Wt+=c*Tt,c=O[13],ze+=c*ht,Qe+=c*rt,De+=c*lt,Be+=c*ft,ut+=c*at,je+=c*it,Pt+=c*At,Lt+=c*Ct,zt+=c*pt,kt+=c*Ot,jt+=c*dt,Gt+=c*_t,tr+=c*gt,Mr+=c*Ye,Wt+=c*Rt,Vr+=c*Tt,c=O[14],Qe+=c*ht,De+=c*rt,Be+=c*lt,ut+=c*ft,je+=c*at,Pt+=c*it,Lt+=c*At,zt+=c*Ct,kt+=c*pt,jt+=c*Ot,Gt+=c*dt,tr+=c*_t,Mr+=c*gt,Wt+=c*Ye,Vr+=c*Rt,oi+=c*Tt,c=O[15],De+=c*ht,Be+=c*rt,ut+=c*lt,je+=c*ft,Pt+=c*at,Lt+=c*it,zt+=c*At,kt+=c*Ct,jt+=c*pt,Gt+=c*Ot,tr+=c*dt,Mr+=c*_t,Wt+=c*gt,Vr+=c*Ye,oi+=c*Rt,xi+=c*Tt,ee+=38*Be,fe+=38*ut,we+=38*je,Ne+=38*Pt,Fe+=38*Lt,Pe+=38*zt,St+=38*kt,mt+=38*jt,nt+=38*Gt,$e+=38*tr,Xe+=38*Mr,Ze+=38*Wt,ot+=38*Vr,ze+=38*oi,Qe+=38*xi,b=1,c=ee+b+65535,b=Math.floor(c/65536),ee=c-b*65536,c=fe+b+65535,b=Math.floor(c/65536),fe=c-b*65536,c=we+b+65535,b=Math.floor(c/65536),we=c-b*65536,c=Ne+b+65535,b=Math.floor(c/65536),Ne=c-b*65536,c=Fe+b+65535,b=Math.floor(c/65536),Fe=c-b*65536,c=Pe+b+65535,b=Math.floor(c/65536),Pe=c-b*65536,c=St+b+65535,b=Math.floor(c/65536),St=c-b*65536,c=mt+b+65535,b=Math.floor(c/65536),mt=c-b*65536,c=nt+b+65535,b=Math.floor(c/65536),nt=c-b*65536,c=$e+b+65535,b=Math.floor(c/65536),$e=c-b*65536,c=Xe+b+65535,b=Math.floor(c/65536),Xe=c-b*65536,c=Ze+b+65535,b=Math.floor(c/65536),Ze=c-b*65536,c=ot+b+65535,b=Math.floor(c/65536),ot=c-b*65536,c=ze+b+65535,b=Math.floor(c/65536),ze=c-b*65536,c=Qe+b+65535,b=Math.floor(c/65536),Qe=c-b*65536,c=De+b+65535,b=Math.floor(c/65536),De=c-b*65536,ee+=b-1+37*(b-1),b=1,c=ee+b+65535,b=Math.floor(c/65536),ee=c-b*65536,c=fe+b+65535,b=Math.floor(c/65536),fe=c-b*65536,c=we+b+65535,b=Math.floor(c/65536),we=c-b*65536,c=Ne+b+65535,b=Math.floor(c/65536),Ne=c-b*65536,c=Fe+b+65535,b=Math.floor(c/65536),Fe=c-b*65536,c=Pe+b+65535,b=Math.floor(c/65536),Pe=c-b*65536,c=St+b+65535,b=Math.floor(c/65536),St=c-b*65536,c=mt+b+65535,b=Math.floor(c/65536),mt=c-b*65536,c=nt+b+65535,b=Math.floor(c/65536),nt=c-b*65536,c=$e+b+65535,b=Math.floor(c/65536),$e=c-b*65536,c=Xe+b+65535,b=Math.floor(c/65536),Xe=c-b*65536,c=Ze+b+65535,b=Math.floor(c/65536),Ze=c-b*65536,c=ot+b+65535,b=Math.floor(c/65536),ot=c-b*65536,c=ze+b+65535,b=Math.floor(c/65536),ze=c-b*65536,c=Qe+b+65535,b=Math.floor(c/65536),Qe=c-b*65536,c=De+b+65535,b=Math.floor(c/65536),De=c-b*65536,ee+=b-1+37*(b-1),R[0]=ee,R[1]=fe,R[2]=we,R[3]=Ne,R[4]=Fe,R[5]=Pe,R[6]=St,R[7]=mt,R[8]=nt,R[9]=$e,R[10]=Xe,R[11]=Ze,R[12]=ot,R[13]=ze,R[14]=Qe,R[15]=De}function B(R,O){j(R,O,O)}function ye(R,O){const P=o();let c;for(c=0;c<16;c++)P[c]=O[c];for(c=253;c>=0;c--)B(P,P),c!==2&&c!==4&&j(P,P,O);for(c=0;c<16;c++)R[c]=P[c]}function re(R,O){const P=o();let c;for(c=0;c<16;c++)P[c]=O[c];for(c=250;c>=0;c--)B(P,P),c!==1&&j(P,P,O);for(c=0;c<16;c++)R[c]=P[c]}function ue(R,O){const P=o(),c=o(),b=o(),ee=o(),fe=o(),we=o(),Ne=o(),Fe=o(),Pe=o();T(P,R[1],R[0]),T(Pe,O[1],O[0]),j(P,P,Pe),le(c,R[0],R[1]),le(Pe,O[0],O[1]),j(c,c,Pe),j(b,R[3],O[3]),j(b,b,A),j(ee,R[2],O[2]),le(ee,ee,ee),T(fe,c,P),T(we,ee,b),le(Ne,ee,b),le(Fe,c,P),j(R[0],fe,we),j(R[1],Fe,Ne),j(R[2],Ne,we),j(R[3],fe,Fe)}function Te(R,O,P){for(let c=0;c<4;c++)V(R[c],O[c],P)}function qe(R,O){const P=o(),c=o(),b=o();ye(b,O[2]),j(P,O[0],b),j(c,O[1],b),ie(R,c),R[31]^=pe(P)<<7}function y(R,O,P){G(R[0],d),G(R[1],v),G(R[2],v),G(R[3],d);for(let c=255;c>=0;--c){const b=P[c/8|0]>>(c&7)&1;Te(R,O,b),ue(O,R),ue(R,R),Te(R,O,b)}}function E(R,O){const P=[o(),o(),o(),o()];G(P[0],L),G(P[1],K),G(P[2],v),j(P[3],L,K),y(R,P,O)}function X(R){if(R.length!==u.SEED_LENGTH)throw new Error(`ed25519: seed must be ${u.SEED_LENGTH} bytes`);const O=(0,r.hash)(R);O[0]&=248,O[31]&=127,O[31]|=64;const P=new Uint8Array(32),c=[o(),o(),o(),o()];E(c,O),qe(P,c);const b=new Uint8Array(64);return b.set(R),b.set(P,32),{publicKey:P,secretKey:b}}u.generateKeyPairFromSeed=X;function ce(R){const O=(0,i.randomBytes)(32,R),P=X(O);return(0,n.wipe)(O),P}u.generateKeyPair=ce;function k(R){if(R.length!==u.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${u.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(R.subarray(32))}u.extractPublicKeyFromSecretKey=k;const U=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function z(R,O){let P,c,b,ee;for(c=63;c>=32;--c){for(P=0,b=c-32,ee=c-12;b<ee;++b)O[b]+=P-16*O[c]*U[b-(c-32)],P=Math.floor((O[b]+128)/256),O[b]-=P*256;O[b]+=P,O[c]=0}for(P=0,b=0;b<32;b++)O[b]+=P-(O[31]>>4)*U[b],P=O[b]>>8,O[b]&=255;for(b=0;b<32;b++)O[b]-=P*U[b];for(c=0;c<32;c++)O[c+1]+=O[c]>>8,R[c]=O[c]&255}function H(R){const O=new Float64Array(64);for(let P=0;P<64;P++)O[P]=R[P];for(let P=0;P<64;P++)R[P]=0;z(R,O)}function Je(R,O){const P=new Float64Array(64),c=[o(),o(),o(),o()],b=(0,r.hash)(R.subarray(0,32));b[0]&=248,b[31]&=127,b[31]|=64;const ee=new Uint8Array(64);ee.set(b.subarray(32),32);const fe=new r.SHA512;fe.update(ee.subarray(32)),fe.update(O);const we=fe.digest();fe.clean(),H(we),E(c,we),qe(ee,c),fe.reset(),fe.update(ee.subarray(0,32)),fe.update(R.subarray(32)),fe.update(O);const Ne=fe.digest();H(Ne);for(let Fe=0;Fe<32;Fe++)P[Fe]=we[Fe];for(let Fe=0;Fe<32;Fe++)for(let Pe=0;Pe<32;Pe++)P[Fe+Pe]+=Ne[Fe]*b[Pe];return z(ee.subarray(32),P),ee}u.sign=Je;function He(R,O){const P=o(),c=o(),b=o(),ee=o(),fe=o(),we=o(),Ne=o();return G(R[2],v),he(R[1],O),B(b,R[1]),j(ee,b,w),T(b,b,R[2]),le(ee,R[2],ee),B(fe,ee),B(we,fe),j(Ne,we,fe),j(P,Ne,b),j(P,P,ee),re(P,P),j(P,P,b),j(P,P,ee),j(P,P,ee),j(R[0],P,ee),B(c,R[0]),j(c,c,ee),ge(c,b)&&j(R[0],R[0],J),B(c,R[0]),j(c,c,ee),ge(c,b)?-1:(pe(R[0])===O[31]>>7&&T(R[0],d,R[0]),j(R[3],R[0],R[1]),0)}function $r(R,O,P){const c=new Uint8Array(32),b=[o(),o(),o(),o()],ee=[o(),o(),o(),o()];if(P.length!==u.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${u.SIGNATURE_LENGTH} bytes`);if(He(ee,R))return!1;const fe=new r.SHA512;fe.update(P.subarray(0,32)),fe.update(R),fe.update(O);const we=fe.digest();return H(we),y(b,ee,we),E(ee,P.subarray(32)),ue(b,ee),qe(c,b),!Ee(P,c)}u.verify=$r;function xe(R){let O=[o(),o(),o(),o()];if(He(O,R))throw new Error("Ed25519: invalid public key");let P=o(),c=o(),b=O[1];le(P,v,b),T(c,v,b),ye(c,c),j(P,P,c);let ee=new Uint8Array(32);return ie(ee,P),ee}u.convertPublicKeyToX25519=xe;function It(R){const O=(0,r.hash)(R.subarray(0,32));O[0]&=248,O[31]&=127,O[31]|=64;const P=new Uint8Array(O.subarray(0,32));return(0,n.wipe)(O),P}u.convertSecretKeyToX25519=It})(dc);const gm="EdDSA",ym="JWT",Bl=".",Vl="base64url",vm="utf8",mm="utf8",_m=":",wm="did",bm="key",zh="base58btc",Em="z",xm="K36",Im=32;function no(u){return co(lc(Bs(u),vm),Vl)}function Kl(u){const i=lc(xm,zh),r=Em+co(t1([i,u]),zh);return[wm,bm,r].join(_m)}function Sm(u){return co(u,Vl)}function Pm(u){return lc([no(u.header),no(u.payload)].join(Bl),mm)}function Am(u){return[no(u.header),no(u.payload),Sm(u.signature)].join(Bl)}function kh(u=Tl.randomBytes(Im)){return dc.generateKeyPairFromSeed(u)}async function Cm(u,i,r,n,o=ne.fromMiliseconds(Date.now())){const l={alg:gm,typ:ym},d=Kl(n.publicKey),v=o+r,w={iss:d,sub:u,aud:i,iat:o,exp:v},A=Pm({header:l,payload:w}),L=dc.sign(n.secretKey,A);return Am({header:l,payload:w,signature:L})}const Om="PARSE_ERROR",Rm="INVALID_REQUEST",Tm="METHOD_NOT_FOUND",Nm="INVALID_PARAMS",Gl="INTERNAL_ERROR",gc="SERVER_ERROR",Dm=[-32700,-32600,-32601,-32602,-32603],Hs={[Om]:{code:-32700,message:"Parse error"},[Rm]:{code:-32600,message:"Invalid Request"},[Tm]:{code:-32601,message:"Method not found"},[Nm]:{code:-32602,message:"Invalid params"},[Gl]:{code:-32603,message:"Internal error"},[gc]:{code:-32e3,message:"Server error"}},Wl=gc;function Fm(u){return Dm.includes(u)}function Hh(u){return Object.keys(Hs).includes(u)?Hs[u]:Hs[Wl]}function Lm(u){const i=Object.values(Hs).find(r=>r.code===u);return i||Hs[Wl]}function Jl(u,i,r){return u.message.includes("getaddrinfo ENOTFOUND")||u.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${i}`):u}var Yl={},ii={},Bh;function $m(){if(Bh)return ii;Bh=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.isBrowserCryptoAvailable=ii.getSubtleCrypto=ii.getBrowerCrypto=void 0;function u(){return(cr===null||cr===void 0?void 0:cr.crypto)||(cr===null||cr===void 0?void 0:cr.msCrypto)||{}}ii.getBrowerCrypto=u;function i(){const n=u();return n.subtle||n.webkitSubtle}ii.getSubtleCrypto=i;function r(){return!!u()&&!!i()}return ii.isBrowserCryptoAvailable=r,ii}var si={},Vh;function Mm(){if(Vh)return si;Vh=1,Object.defineProperty(si,"__esModule",{value:!0}),si.isBrowser=si.isNode=si.isReactNative=void 0;function u(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}si.isReactNative=u;function i(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}si.isNode=i;function r(){return!u()&&!i()}return si.isBrowser=r,si}(function(u){Object.defineProperty(u,"__esModule",{value:!0});const i=wi;i.__exportStar($m(),u),i.__exportStar(Mm(),u)})(Yl);function Xl(u=3){const i=Date.now()*Math.pow(10,u),r=Math.floor(Math.random()*Math.pow(10,u));return i+r}function yc(u=6){return BigInt(Xl(u))}function ho(u,i,r){return{id:r||Xl(),jsonrpc:"2.0",method:u,params:i}}function vc(u,i){return{id:u,jsonrpc:"2.0",result:i}}function lo(u,i,r){return{id:u,jsonrpc:"2.0",error:jm(i,r)}}function jm(u,i){return typeof u>"u"?Hh(Gl):(typeof u=="string"&&(u=Object.assign(Object.assign({},Hh(gc)),{message:u})),typeof i<"u"&&(u.data=i),Fm(u.code)&&(u=Lm(u.code)),u)}class Um{}class qm extends Um{constructor(){super()}}class zm extends qm{constructor(i){super()}}const km="^https?:",Hm="^wss?:";function Bm(u){const i=u.match(new RegExp(/^\w+:/,"gi"));if(!(!i||!i.length))return i[0]}function Zl(u,i){const r=Bm(u);return typeof r>"u"?!1:new RegExp(i).test(r)}function Kh(u){return Zl(u,km)}function Gh(u){return Zl(u,Hm)}function Vm(u){return new RegExp("wss?://localhost(:d{2,5})?").test(u)}function Ql(u){return typeof u=="object"&&"id"in u&&"jsonrpc"in u&&u.jsonrpc==="2.0"}function mc(u){return Ql(u)&&"method"in u}function fo(u){return Ql(u)&&(ni(u)||Lr(u))}function ni(u){return"result"in u}function Lr(u){return"error"in u}class bi extends zm{constructor(i){super(i),this.events=new Ar.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(i),this.connection.connected&&this.registerEventListeners()}async connect(i=this.connection){await this.open(i)}async disconnect(){await this.close()}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async request(i,r){return this.requestStrict(ho(i.method,i.params||[],i.id||yc().toString()),r)}async requestStrict(i,r){return new Promise(async(n,o)=>{if(!this.connection.connected)try{await this.open()}catch(l){o(l)}this.events.on(`${i.id}`,l=>{Lr(l)?o(l.error):n(l.result)});try{await this.connection.send(i,r)}catch(l){o(l)}})}setConnection(i=this.connection){return i}onPayload(i){this.events.emit("payload",i),fo(i)?this.events.emit(`${i.id}`,i):this.events.emit("message",{type:i.method,data:i.params})}onClose(i){i&&i.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${i.code} ${i.reason?`(${i.reason})`:""}`)),this.events.emit("disconnect")}async open(i=this.connection){this.connection===i&&this.connection.connected||(this.connection.connected&&this.close(),typeof i=="string"&&(await this.connection.open(i),i=this.connection),this.connection=this.setConnection(i),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",i=>this.onPayload(i)),this.connection.on("close",i=>this.onClose(i)),this.connection.on("error",i=>this.events.emit("error",i)),this.connection.on("register_error",i=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Km=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),Gm=()=>typeof window<"u",Wh=u=>u.split("?")[0],Jh=10,Wm=Km();class Jm{constructor(i){if(this.url=i,this.events=new Ar.EventEmitter,this.registering=!1,!Gh(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);this.url=i}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async open(i=this.url){await this.register(i)}async close(){return new Promise((i,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),i()},this.socket.close()})}async send(i,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Bs(i))}catch(n){this.onError(i.id,n)}}register(i=this.url){if(!Gh(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,o)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),o(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=i,this.registering=!0,new Promise((r,n)=>{const o=Yl.isReactNative()?void 0:{rejectUnauthorized:!Vm(i)},l=new Wm(i,[],o);Gm()?l.onerror=d=>{const v=d;n(this.emitError(v.error))}:l.on("error",d=>{n(this.emitError(d))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(i){i.onmessage=r=>this.onPayload(r),i.onclose=r=>this.onClose(r),this.socket=i,this.registering=!1,this.events.emit("open")}onClose(i){this.socket=void 0,this.registering=!1,this.events.emit("close",i)}onPayload(i){if(typeof i.data>"u")return;const r=typeof i.data=="string"?pc(i.data):i.data;this.events.emit("payload",r)}onError(i,r){const n=this.parseError(r),o=n.message||n.toString(),l=lo(i,o);this.events.emit("payload",l)}parseError(i,r=this.url){return Jl(i,Wh(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Jh&&this.events.setMaxListeners(Jh)}emitError(i){const r=this.parseError(new Error(i?.message||`WebSocket connection failed for host: ${Wh(this.url)}`));return this.events.emit("register_error",r),r}}var oo={exports:{}};oo.exports;(function(u,i){var r=200,n="__lodash_hash_undefined__",o=1,l=2,d=9007199254740991,v="[object Arguments]",w="[object Array]",A="[object AsyncFunction]",L="[object Boolean]",K="[object Date]",J="[object Error]",G="[object Function]",M="[object GeneratorFunction]",V="[object Map]",ie="[object Number]",Ee="[object Null]",ge="[object Object]",pe="[object Promise]",he="[object Proxy]",le="[object RegExp]",T="[object Set]",j="[object String]",B="[object Symbol]",ye="[object Undefined]",re="[object WeakMap]",ue="[object ArrayBuffer]",Te="[object DataView]",qe="[object Float32Array]",y="[object Float64Array]",E="[object Int8Array]",X="[object Int16Array]",ce="[object Int32Array]",k="[object Uint8Array]",U="[object Uint8ClampedArray]",z="[object Uint16Array]",H="[object Uint32Array]",Je=/[\\^$.*+?()[\]{}|]/g,He=/^\[object .+?Constructor\]$/,$r=/^(?:0|[1-9]\d*)$/,xe={};xe[qe]=xe[y]=xe[E]=xe[X]=xe[ce]=xe[k]=xe[U]=xe[z]=xe[H]=!0,xe[v]=xe[w]=xe[ue]=xe[L]=xe[Te]=xe[K]=xe[J]=xe[G]=xe[V]=xe[ie]=xe[ge]=xe[le]=xe[T]=xe[j]=xe[re]=!1;var It=typeof cr=="object"&&cr&&cr.Object===Object&&cr,R=typeof self=="object"&&self&&self.Object===Object&&self,O=It||R||Function("return this")(),P=i&&!i.nodeType&&i,c=P&&!0&&u&&!u.nodeType&&u,b=c&&c.exports===P,ee=b&&It.process,fe=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),we=fe&&fe.isTypedArray;function Ne(g,x){for(var $=-1,Y=g==null?0:g.length,Ke=0,ve=[];++$<Y;){var et=g[$];x(et,$,g)&&(ve[Ke++]=et)}return ve}function Fe(g,x){for(var $=-1,Y=x.length,Ke=g.length;++$<Y;)g[Ke+$]=x[$];return g}function Pe(g,x){for(var $=-1,Y=g==null?0:g.length;++$<Y;)if(x(g[$],$,g))return!0;return!1}function St(g,x){for(var $=-1,Y=Array(g);++$<g;)Y[$]=x($);return Y}function mt(g){return function(x){return g(x)}}function nt(g,x){return g.has(x)}function $e(g,x){return g?.[x]}function Xe(g){var x=-1,$=Array(g.size);return g.forEach(function(Y,Ke){$[++x]=[Ke,Y]}),$}function Ze(g,x){return function($){return g(x($))}}function ot(g){var x=-1,$=Array(g.size);return g.forEach(function(Y){$[++x]=Y}),$}var ze=Array.prototype,Qe=Function.prototype,De=Object.prototype,Be=O["__core-js_shared__"],ut=Qe.toString,je=De.hasOwnProperty,Pt=function(){var g=/[^.]+$/.exec(Be&&Be.keys&&Be.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),Lt=De.toString,zt=RegExp("^"+ut.call(je).replace(Je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kt=b?O.Buffer:void 0,jt=O.Symbol,Gt=O.Uint8Array,tr=De.propertyIsEnumerable,Mr=ze.splice,Wt=jt?jt.toStringTag:void 0,Vr=Object.getOwnPropertySymbols,oi=kt?kt.isBuffer:void 0,xi=Ze(Object.keys,Object),ht=ur(O,"DataView"),rt=ur(O,"Map"),lt=ur(O,"Promise"),ft=ur(O,"Set"),at=ur(O,"WeakMap"),it=ur(Object,"create"),At=Gr(ht),Ct=Gr(rt),pt=Gr(lt),Ot=Gr(ft),dt=Gr(at),_t=jt?jt.prototype:void 0,gt=_t?_t.valueOf:void 0;function Ye(g){var x=-1,$=g==null?0:g.length;for(this.clear();++x<$;){var Y=g[x];this.set(Y[0],Y[1])}}function Rt(){this.__data__=it?it(null):{},this.size=0}function Tt(g){var x=this.has(g)&&delete this.__data__[g];return this.size-=x?1:0,x}function yo(g){var x=this.__data__;if(it){var $=x[g];return $===n?void 0:$}return je.call(x,g)?x[g]:void 0}function vo(g){var x=this.__data__;return it?x[g]!==void 0:je.call(x,g)}function mo(g,x){var $=this.__data__;return this.size+=this.has(g)?0:1,$[g]=it&&x===void 0?n:x,this}Ye.prototype.clear=Rt,Ye.prototype.delete=Tt,Ye.prototype.get=yo,Ye.prototype.has=vo,Ye.prototype.set=mo;function gr(g){var x=-1,$=g==null?0:g.length;for(this.clear();++x<$;){var Y=g[x];this.set(Y[0],Y[1])}}function _o(){this.__data__=[],this.size=0}function wo(g){var x=this.__data__,$=Ii(x,g);if($<0)return!1;var Y=x.length-1;return $==Y?x.pop():Mr.call(x,$,1),--this.size,!0}function bo(g){var x=this.__data__,$=Ii(x,g);return $<0?void 0:x[$][1]}function Eo(g){return Ii(this.__data__,g)>-1}function xo(g,x){var $=this.__data__,Y=Ii($,g);return Y<0?(++this.size,$.push([g,x])):$[Y][1]=x,this}gr.prototype.clear=_o,gr.prototype.delete=wo,gr.prototype.get=bo,gr.prototype.has=Eo,gr.prototype.set=xo;function Kr(g){var x=-1,$=g==null?0:g.length;for(this.clear();++x<$;){var Y=g[x];this.set(Y[0],Y[1])}}function zi(){this.size=0,this.__data__={hash:new Ye,map:new(rt||gr),string:new Ye}}function Io(g){var x=ai(this,g).delete(g);return this.size-=x?1:0,x}function ki(g){return ai(this,g).get(g)}function So(g){return ai(this,g).has(g)}function Po(g,x){var $=ai(this,g),Y=$.size;return $.set(g,x),this.size+=$.size==Y?0:1,this}Kr.prototype.clear=zi,Kr.prototype.delete=Io,Kr.prototype.get=ki,Kr.prototype.has=So,Kr.prototype.set=Po;function Hi(g){var x=-1,$=g==null?0:g.length;for(this.__data__=new Kr;++x<$;)this.add(g[x])}function Gs(g){return this.__data__.set(g,n),this}function Ws(g){return this.__data__.has(g)}Hi.prototype.add=Hi.prototype.push=Gs,Hi.prototype.has=Ws;function Cr(g){var x=this.__data__=new gr(g);this.size=x.size}function Ao(){this.__data__=new gr,this.size=0}function Co(g){var x=this.__data__,$=x.delete(g);return this.size=x.size,$}function Oo(g){return this.__data__.get(g)}function Ro(g){return this.__data__.has(g)}function Js(g,x){var $=this.__data__;if($ instanceof gr){var Y=$.__data__;if(!rt||Y.length<r-1)return Y.push([g,x]),this.size=++$.size,this;$=this.__data__=new Kr(Y)}return $.set(g,x),this.size=$.size,this}Cr.prototype.clear=Ao,Cr.prototype.delete=Co,Cr.prototype.get=Oo,Cr.prototype.has=Ro,Cr.prototype.set=Js;function Ys(g,x){var $=Ki(g),Y=!$&&un(g),Ke=!$&&!Y&&gs(g),ve=!$&&!Y&&!Ke&&fn(g),et=$||Y||Ke||ve,Nt=et?St(g.length,String):[],Ce=Nt.length;for(var Ge in g)(x||je.call(g,Ge))&&!(et&&(Ge=="length"||Ke&&(Ge=="offset"||Ge=="parent")||ve&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||sn(Ge,Ce)))&&Nt.push(Ge);return Nt}function Ii(g,x){for(var $=g.length;$--;)if(cn(g[$][0],x))return $;return-1}function ps(g,x,$){var Y=x(g);return Ki(g)?Y:Fe(Y,$(g))}function Si(g){return g==null?g===void 0?ye:Ee:Wt&&Wt in Object(g)?tn(g):Do(g)}function ds(g){return Ai(g)&&Si(g)==v}function Pi(g,x,$,Y,Ke){return g===x?!0:g==null||x==null||!Ai(g)&&!Ai(x)?g!==g&&x!==x:Xs(g,x,$,Y,Pi,Ke)}function Xs(g,x,$,Y,Ke,ve){var et=Ki(g),Nt=Ki(x),Ce=et?w:jr(g),Ge=Nt?w:jr(x);Ce=Ce==v?ge:Ce,Ge=Ge==v?ge:Ge;var wt=Ce==ge,rr=Ge==ge,Dt=Ce==Ge;if(Dt&&gs(g)){if(!gs(x))return!1;et=!0,wt=!1}if(Dt&&!wt)return ve||(ve=new Cr),et||fn(g)?Bi(g,x,$,Y,Ke,ve):No(g,x,Ce,$,Y,Ke,ve);if(!($&o)){var tt=wt&&je.call(g,"__wrapped__"),Jt=rr&&je.call(x,"__wrapped__");if(tt||Jt){var Or=tt?g.value():g,yr=Jt?x.value():x;return ve||(ve=new Cr),Ke(Or,yr,$,Y,ve)}}return Dt?(ve||(ve=new Cr),en(g,x,$,Y,Ke,ve)):!1}function To(g){if(!ln(g)||on(g))return!1;var x=Gi(g)?zt:He;return x.test(Gr(g))}function Zs(g){return Ai(g)&&hn(g.length)&&!!xe[Si(g)]}function Qs(g){if(!an(g))return xi(g);var x=[];for(var $ in Object(g))je.call(g,$)&&$!="constructor"&&x.push($);return x}function Bi(g,x,$,Y,Ke,ve){var et=$&o,Nt=g.length,Ce=x.length;if(Nt!=Ce&&!(et&&Ce>Nt))return!1;var Ge=ve.get(g);if(Ge&&ve.get(x))return Ge==x;var wt=-1,rr=!0,Dt=$&l?new Hi:void 0;for(ve.set(g,x),ve.set(x,g);++wt<Nt;){var tt=g[wt],Jt=x[wt];if(Y)var Or=et?Y(Jt,tt,wt,x,g,ve):Y(tt,Jt,wt,g,x,ve);if(Or!==void 0){if(Or)continue;rr=!1;break}if(Dt){if(!Pe(x,function(yr,Ur){if(!nt(Dt,Ur)&&(tt===yr||Ke(tt,yr,$,Y,ve)))return Dt.push(Ur)})){rr=!1;break}}else if(!(tt===Jt||Ke(tt,Jt,$,Y,ve))){rr=!1;break}}return ve.delete(g),ve.delete(x),rr}function No(g,x,$,Y,Ke,ve,et){switch($){case Te:if(g.byteLength!=x.byteLength||g.byteOffset!=x.byteOffset)return!1;g=g.buffer,x=x.buffer;case ue:return!(g.byteLength!=x.byteLength||!ve(new Gt(g),new Gt(x)));case L:case K:case ie:return cn(+g,+x);case J:return g.name==x.name&&g.message==x.message;case le:case j:return g==x+"";case V:var Nt=Xe;case T:var Ce=Y&o;if(Nt||(Nt=ot),g.size!=x.size&&!Ce)return!1;var Ge=et.get(g);if(Ge)return Ge==x;Y|=l,et.set(g,x);var wt=Bi(Nt(g),Nt(x),Y,Ke,ve,et);return et.delete(g),wt;case B:if(gt)return gt.call(g)==gt.call(x)}return!1}function en(g,x,$,Y,Ke,ve){var et=$&o,Nt=Vi(g),Ce=Nt.length,Ge=Vi(x),wt=Ge.length;if(Ce!=wt&&!et)return!1;for(var rr=Ce;rr--;){var Dt=Nt[rr];if(!(et?Dt in x:je.call(x,Dt)))return!1}var tt=ve.get(g);if(tt&&ve.get(x))return tt==x;var Jt=!0;ve.set(g,x),ve.set(x,g);for(var Or=et;++rr<Ce;){Dt=Nt[rr];var yr=g[Dt],Ur=x[Dt];if(Y)var ys=et?Y(Ur,yr,Dt,x,g,ve):Y(yr,Ur,Dt,g,x,ve);if(!(ys===void 0?yr===Ur||Ke(yr,Ur,$,Y,ve):ys)){Jt=!1;break}Or||(Or=Dt=="constructor")}if(Jt&&!Or){var Ci=g.constructor,Ut=x.constructor;Ci!=Ut&&"constructor"in g&&"constructor"in x&&!(typeof Ci=="function"&&Ci instanceof Ci&&typeof Ut=="function"&&Ut instanceof Ut)&&(Jt=!1)}return ve.delete(g),ve.delete(x),Jt}function Vi(g){return ps(g,$o,rn)}function ai(g,x){var $=g.__data__;return nn(x)?$[typeof x=="string"?"string":"hash"]:$.map}function ur(g,x){var $=$e(g,x);return To($)?$:void 0}function tn(g){var x=je.call(g,Wt),$=g[Wt];try{g[Wt]=void 0;var Y=!0}catch{}var Ke=Lt.call(g);return Y&&(x?g[Wt]=$:delete g[Wt]),Ke}var rn=Vr?function(g){return g==null?[]:(g=Object(g),Ne(Vr(g),function(x){return tr.call(g,x)}))}:Ve,jr=Si;(ht&&jr(new ht(new ArrayBuffer(1)))!=Te||rt&&jr(new rt)!=V||lt&&jr(lt.resolve())!=pe||ft&&jr(new ft)!=T||at&&jr(new at)!=re)&&(jr=function(g){var x=Si(g),$=x==ge?g.constructor:void 0,Y=$?Gr($):"";if(Y)switch(Y){case At:return Te;case Ct:return V;case pt:return pe;case Ot:return T;case dt:return re}return x});function sn(g,x){return x=x??d,!!x&&(typeof g=="number"||$r.test(g))&&g>-1&&g%1==0&&g<x}function nn(g){var x=typeof g;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?g!=="__proto__":g===null}function on(g){return!!Pt&&Pt in g}function an(g){var x=g&&g.constructor,$=typeof x=="function"&&x.prototype||De;return g===$}function Do(g){return Lt.call(g)}function Gr(g){if(g!=null){try{return ut.call(g)}catch{}try{return g+""}catch{}}return""}function cn(g,x){return g===x||g!==g&&x!==x}var un=ds(function(){return arguments}())?ds:function(g){return Ai(g)&&je.call(g,"callee")&&!tr.call(g,"callee")},Ki=Array.isArray;function Fo(g){return g!=null&&hn(g.length)&&!Gi(g)}var gs=oi||ke;function Lo(g,x){return Pi(g,x)}function Gi(g){if(!ln(g))return!1;var x=Si(g);return x==G||x==M||x==A||x==he}function hn(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=d}function ln(g){var x=typeof g;return g!=null&&(x=="object"||x=="function")}function Ai(g){return g!=null&&typeof g=="object"}var fn=we?mt(we):Zs;function $o(g){return Fo(g)?Ys(g):Qs(g)}function Ve(){return[]}function ke(){return!1}u.exports=Lo})(oo,oo.exports);var Ym=oo.exports;const Xm=Nl(Ym);function Zm(u,i){if(u.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<u.length;o++){var l=u.charAt(o),d=l.charCodeAt(0);if(r[d]!==255)throw new TypeError(l+" is ambiguous");r[d]=o}var v=u.length,w=u.charAt(0),A=Math.log(v)/Math.log(256),L=Math.log(256)/Math.log(v);function K(M){if(M instanceof Uint8Array||(ArrayBuffer.isView(M)?M=new Uint8Array(M.buffer,M.byteOffset,M.byteLength):Array.isArray(M)&&(M=Uint8Array.from(M))),!(M instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(M.length===0)return"";for(var V=0,ie=0,Ee=0,ge=M.length;Ee!==ge&&M[Ee]===0;)Ee++,V++;for(var pe=(ge-Ee)*L+1>>>0,he=new Uint8Array(pe);Ee!==ge;){for(var le=M[Ee],T=0,j=pe-1;(le!==0||T<ie)&&j!==-1;j--,T++)le+=256*he[j]>>>0,he[j]=le%v>>>0,le=le/v>>>0;if(le!==0)throw new Error("Non-zero carry");ie=T,Ee++}for(var B=pe-ie;B!==pe&&he[B]===0;)B++;for(var ye=w.repeat(V);B<pe;++B)ye+=u.charAt(he[B]);return ye}function J(M){if(typeof M!="string")throw new TypeError("Expected String");if(M.length===0)return new Uint8Array;var V=0;if(M[V]!==" "){for(var ie=0,Ee=0;M[V]===w;)ie++,V++;for(var ge=(M.length-V)*A+1>>>0,pe=new Uint8Array(ge);M[V];){var he=r[M.charCodeAt(V)];if(he===255)return;for(var le=0,T=ge-1;(he!==0||le<Ee)&&T!==-1;T--,le++)he+=v*pe[T]>>>0,pe[T]=he%256>>>0,he=he/256>>>0;if(he!==0)throw new Error("Non-zero carry");Ee=le,V++}if(M[V]!==" "){for(var j=ge-Ee;j!==ge&&pe[j]===0;)j++;for(var B=new Uint8Array(ie+(ge-j)),ye=ie;j!==ge;)B[ye++]=pe[j++];return B}}}function G(M){var V=J(M);if(V)return V;throw new Error(`Non-${i} character`)}return{encode:K,decodeUnsafe:J,decode:G}}var Qm=Zm,e_=Qm;const ef=u=>{if(u instanceof Uint8Array&&u.constructor.name==="Uint8Array")return u;if(u instanceof ArrayBuffer)return new Uint8Array(u);if(ArrayBuffer.isView(u))return new Uint8Array(u.buffer,u.byteOffset,u.byteLength);throw new Error("Unknown type, must be binary type")},t_=u=>new TextEncoder().encode(u),r_=u=>new TextDecoder().decode(u);class i_{constructor(i,r,n){this.name=i,this.prefix=r,this.baseEncode=n}encode(i){if(i instanceof Uint8Array)return`${this.prefix}${this.baseEncode(i)}`;throw Error("Unknown type, must be binary type")}}class s_{constructor(i,r,n){if(this.name=i,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(i){if(typeof i=="string"){if(i.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(i)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(i.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(i){return tf(this,i)}}class n_{constructor(i){this.decoders=i}or(i){return tf(this,i)}decode(i){const r=i[0],n=this.decoders[r];if(n)return n.decode(i);throw RangeError(`Unable to decode multibase string ${JSON.stringify(i)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const tf=(u,i)=>new n_({...u.decoders||{[u.prefix]:u},...i.decoders||{[i.prefix]:i}});class o_{constructor(i,r,n,o){this.name=i,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new i_(i,r,n),this.decoder=new s_(i,r,o)}encode(i){return this.encoder.encode(i)}decode(i){return this.decoder.decode(i)}}const po=({name:u,prefix:i,encode:r,decode:n})=>new o_(u,i,r,n),Ks=({prefix:u,name:i,alphabet:r})=>{const{encode:n,decode:o}=e_(r,i);return po({prefix:u,name:i,encode:n,decode:l=>ef(o(l))})},a_=(u,i,r,n)=>{const o={};for(let L=0;L<i.length;++L)o[i[L]]=L;let l=u.length;for(;u[l-1]==="=";)--l;const d=new Uint8Array(l*r/8|0);let v=0,w=0,A=0;for(let L=0;L<l;++L){const K=o[u[L]];if(K===void 0)throw new SyntaxError(`Non-${n} character`);w=w<<r|K,v+=r,v>=8&&(v-=8,d[A++]=255&w>>v)}if(v>=r||255&w<<8-v)throw new SyntaxError("Unexpected end of data");return d},c_=(u,i,r)=>{const n=i[i.length-1]==="=",o=(1<<r)-1;let l="",d=0,v=0;for(let w=0;w<u.length;++w)for(v=v<<8|u[w],d+=8;d>r;)d-=r,l+=i[o&v>>d];if(d&&(l+=i[o&v<<r-d]),n)for(;l.length*r&7;)l+="=";return l},Bt=({name:u,prefix:i,bitsPerChar:r,alphabet:n})=>po({prefix:i,name:u,encode(o){return c_(o,n,r)},decode(o){return a_(o,n,r,u)}}),u_=po({prefix:"\0",name:"identity",encode:u=>r_(u),decode:u=>t_(u)});var h_=Object.freeze({__proto__:null,identity:u_});const l_=Bt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var f_=Object.freeze({__proto__:null,base2:l_});const p_=Bt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var d_=Object.freeze({__proto__:null,base8:p_});const g_=Ks({prefix:"9",name:"base10",alphabet:"0123456789"});var y_=Object.freeze({__proto__:null,base10:g_});const v_=Bt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),m_=Bt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var __=Object.freeze({__proto__:null,base16:v_,base16upper:m_});const w_=Bt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),b_=Bt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),E_=Bt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),x_=Bt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),I_=Bt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),S_=Bt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),P_=Bt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),A_=Bt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),C_=Bt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var O_=Object.freeze({__proto__:null,base32:w_,base32upper:b_,base32pad:E_,base32padupper:x_,base32hex:I_,base32hexupper:S_,base32hexpad:P_,base32hexpadupper:A_,base32z:C_});const R_=Ks({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),T_=Ks({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var N_=Object.freeze({__proto__:null,base36:R_,base36upper:T_});const D_=Ks({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),F_=Ks({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var L_=Object.freeze({__proto__:null,base58btc:D_,base58flickr:F_});const $_=Bt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),M_=Bt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),j_=Bt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),U_=Bt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var q_=Object.freeze({__proto__:null,base64:$_,base64pad:M_,base64url:j_,base64urlpad:U_});const rf=Array.from(""),z_=rf.reduce((u,i,r)=>(u[r]=i,u),[]),k_=rf.reduce((u,i,r)=>(u[i.codePointAt(0)]=r,u),[]);function H_(u){return u.reduce((i,r)=>(i+=z_[r],i),"")}function B_(u){const i=[];for(const r of u){const n=k_[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);i.push(n)}return new Uint8Array(i)}const V_=po({prefix:"",name:"base256emoji",encode:H_,decode:B_});var K_=Object.freeze({__proto__:null,base256emoji:V_}),G_=sf,Yh=128,W_=127,J_=~W_,Y_=Math.pow(2,31);function sf(u,i,r){i=i||[],r=r||0;for(var n=r;u>=Y_;)i[r++]=u&255|Yh,u/=128;for(;u&J_;)i[r++]=u&255|Yh,u>>>=7;return i[r]=u|0,sf.bytes=r-n+1,i}var X_=sc,Z_=128,Xh=127;function sc(u,n){var r=0,n=n||0,o=0,l=n,d,v=u.length;do{if(l>=v)throw sc.bytes=0,new RangeError("Could not decode varint");d=u[l++],r+=o<28?(d&Xh)<<o:(d&Xh)*Math.pow(2,o),o+=7}while(d>=Z_);return sc.bytes=l-n,r}var Q_=Math.pow(2,7),ew=Math.pow(2,14),tw=Math.pow(2,21),rw=Math.pow(2,28),iw=Math.pow(2,35),sw=Math.pow(2,42),nw=Math.pow(2,49),ow=Math.pow(2,56),aw=Math.pow(2,63),cw=function(u){return u<Q_?1:u<ew?2:u<tw?3:u<rw?4:u<iw?5:u<sw?6:u<nw?7:u<ow?8:u<aw?9:10},uw={encode:G_,decode:X_,encodingLength:cw},nf=uw;const Zh=(u,i,r=0)=>(nf.encode(u,i,r),i),Qh=u=>nf.encodingLength(u),nc=(u,i)=>{const r=i.byteLength,n=Qh(u),o=n+Qh(r),l=new Uint8Array(o+r);return Zh(u,l,0),Zh(r,l,n),l.set(i,o),new hw(u,r,i,l)};class hw{constructor(i,r,n,o){this.code=i,this.size=r,this.digest=n,this.bytes=o}}const of=({name:u,code:i,encode:r})=>new lw(u,i,r);class lw{constructor(i,r,n){this.name=i,this.code=r,this.encode=n}digest(i){if(i instanceof Uint8Array){const r=this.encode(i);return r instanceof Uint8Array?nc(this.code,r):r.then(n=>nc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const af=u=>async i=>new Uint8Array(await crypto.subtle.digest(u,i)),fw=of({name:"sha2-256",code:18,encode:af("SHA-256")}),pw=of({name:"sha2-512",code:19,encode:af("SHA-512")});var dw=Object.freeze({__proto__:null,sha256:fw,sha512:pw});const cf=0,gw="identity",uf=ef,yw=u=>nc(cf,uf(u)),vw={code:cf,name:gw,encode:uf,digest:yw};var mw=Object.freeze({__proto__:null,identity:vw});new TextEncoder,new TextDecoder;const el={...h_,...f_,...d_,...y_,...__,...O_,...N_,...L_,...q_,...K_};({...dw,...mw});function hf(u){return globalThis.Buffer!=null?new Uint8Array(u.buffer,u.byteOffset,u.byteLength):u}function _w(u=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?hf(globalThis.Buffer.allocUnsafe(u)):new Uint8Array(u)}function lf(u,i,r,n){return{name:u,prefix:i,encoder:{name:u,prefix:i,encode:r},decoder:{decode:n}}}const tl=lf("utf8","u",u=>"u"+new TextDecoder("utf8").decode(u),u=>new TextEncoder().encode(u.substring(1))),Ga=lf("ascii","a",u=>{let i="a";for(let r=0;r<u.length;r++)i+=String.fromCharCode(u[r]);return i},u=>{u=u.substring(1);const i=_w(u.length);for(let r=0;r<u.length;r++)i[r]=u.charCodeAt(r);return i}),ww={utf8:tl,"utf-8":tl,hex:el.base16,latin1:Ga,ascii:Ga,binary:Ga,...el};function bw(u,i="utf8"){const r=ww[i];if(!r)throw new Error(`Unsupported encoding "${i}"`);return(i==="utf8"||i==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?hf(globalThis.Buffer.from(u,"utf-8")):r.decoder.decode(`${r.prefix}${u}`)}const ff="wc",Ew=2,_c="core",_i=`${ff}@2:${_c}:`,xw={name:_c,logger:"error"},Iw={database:":memory:"},Sw="crypto",rl="client_ed25519_seed",Pw=ne.ONE_DAY,Aw="keychain",Cw="0.3",Ow="messages",Rw="0.3",Tw=ne.SIX_HOURS,Nw="publisher",pf="irn",Dw="error",df="wss://relay.walletconnect.com",il="wss://relay.walletconnect.org",Fw="relayer",vt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Lw="_subscription",Ms={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},$w=ne.ONE_SECOND/2,Mw="2.9.0",jw=1e4,Uw="0.3",qw="WALLETCONNECT_CLIENT_ID",Br={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},zw="subscription",kw="0.3",Hw=ne.FIVE_SECONDS*1e3,Bw="pairing",Vw="0.3",js={wc_pairingDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:0},res:{ttl:ne.ONE_DAY,prompt:!1,tag:0}}},Hr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Kw="history",Gw="0.3",Ww="expirer",Sr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Jw="0.3",Wa="verify-api",sl="https://verify.walletconnect.com";class Yw{constructor(i,r){this.core=i,this.logger=r,this.keychain=new Map,this.name=Aw,this.version=Cw,this.initialized=!1,this.storagePrefix=_i,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,o)=>{this.isInitialized(),this.keychain.set(n,o),await this.persist()},this.get=n=>{this.isInitialized();const o=this.keychain.get(n);if(typeof o>"u"){const{message:l}=Q("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(l)}return o},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=i,this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(i){await this.core.storage.setItem(this.storageKey,$l(i))}async getKeyChain(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Ml(i):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:i}=Q("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Xw{constructor(i,r,n){this.core=i,this.logger=r,this.name=Sw,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),l=kh(o);return Kl(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=s1();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const l=await this.getClientSeed(),d=kh(l),v=rc();return await Cm(v,o,Pw,d)},this.generateSharedKey=(o,l,d)=>{this.isInitialized();const v=this.getPrivateKey(o),w=n1(v,l);return this.setSymKey(w,d)},this.setSymKey=async(o,l)=>{this.isInitialized();const d=l||o1(o);return await this.keychain.set(d,o),d},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,l,d)=>{this.isInitialized();const v=a1(d),w=Bs(l);if(xh(v)){const J=v.senderPublicKey,G=v.receiverPublicKey;o=await this.generateSharedKey(J,G)}const A=this.getSymKey(o),{type:L,senderPublicKey:K}=v;return c1({type:L,symKey:A,message:w,senderPublicKey:K})},this.decode=async(o,l,d)=>{this.isInitialized();const v=u1(l,d);if(xh(v)){const L=v.receiverPublicKey,K=v.senderPublicKey;o=await this.generateSharedKey(L,K)}const w=this.getSymKey(o),A=h1({symKey:w,encoded:l});return pc(A)},this.getPayloadType=o=>{const l=Ih(o);return l1(l.type)},this.getPayloadSenderPublicKey=o=>{const l=Ih(o);return l.senderPublicKey?co(l.senderPublicKey,f1):void 0},this.core=i,this.logger=Re.generateChildLogger(r,this.name),this.keychain=n||new Yw(this.core,this.logger)}get context(){return Re.getLoggerContext(this.logger)}async setPrivateKey(i,r){return await this.keychain.set(i,r),i}getPrivateKey(i){return this.keychain.get(i)}async getClientSeed(){let i="";try{i=this.keychain.get(rl)}catch{i=rc(),await this.keychain.set(rl,i)}return bw(i,"base16")}getSymKey(i){return this.keychain.get(i)}isInitialized(){if(!this.initialized){const{message:i}=Q("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Zw extends sm{constructor(i,r){super(i,r),this.logger=i,this.core=r,this.messages=new Map,this.name=Ow,this.version=Rw,this.initialized=!1,this.storagePrefix=_i,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,o)=>{this.isInitialized();const l=hs(o);let d=this.messages.get(n);return typeof d>"u"&&(d={}),typeof d[l]<"u"||(d[l]=o,this.messages.set(n,d),await this.persist()),l},this.get=n=>{this.isInitialized();let o=this.messages.get(n);return typeof o>"u"&&(o={}),o},this.has=(n,o)=>{this.isInitialized();const l=this.get(n),d=hs(o);return typeof l[d]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Re.generateChildLogger(i,this.name),this.core=r}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(i){await this.core.storage.setItem(this.storageKey,$l(i))}async getRelayerMessages(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Ml(i):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:i}=Q("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Qw extends nm{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.events=new Ar.EventEmitter,this.name=Nw,this.queue=new Map,this.publishTimeout=ne.toMiliseconds(ne.TEN_SECONDS),this.queueTimeout=ne.toMiliseconds(ne.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,o,l)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:l}});try{const d=l?.ttl||Tw,v=ic(l),w=l?.prompt||!1,A=l?.tag||0,L=l?.id||yc().toString(),K={topic:n,message:o,opts:{ttl:d,relay:v,prompt:w,tag:A,id:L}},J=setTimeout(()=>this.queue.set(L,K),this.queueTimeout);try{await await so(this.rpcPublish(n,o,d,v,w,A,L),this.publishTimeout),clearTimeout(J),this.relayer.events.emit(vt.publish,K)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:l}})}catch(d){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(d),d}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.relayer=i,this.logger=Re.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Re.getLoggerContext(this.logger)}rpcPublish(i,r,n,o,l,d,v){var w,A,L,K;const J={method:to(o.protocol).publish,params:{topic:i,message:r,ttl:n,prompt:l,tag:d},id:v};return mi((w=J.params)==null?void 0:w.prompt)&&((A=J.params)==null||delete A.prompt),mi((L=J.params)==null?void 0:L.tag)&&((K=J.params)==null||delete K.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:J}),this.relayer.request(J)}onPublish(i){this.queue.delete(i)}checkQueue(){this.queue.forEach(async i=>{const{topic:r,message:n,opts:o}=i;await this.publish(r,n,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(fs.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(vt.connection_stalled);return}this.checkQueue()}),this.relayer.on(vt.message_ack,i=>{this.onPublish(i.id.toString())})}}class eb{constructor(){this.map=new Map,this.set=(i,r)=>{const n=this.get(i);this.exists(i,r)||this.map.set(i,[...n,r])},this.get=i=>this.map.get(i)||[],this.exists=(i,r)=>this.get(i).includes(r),this.delete=(i,r)=>{if(typeof r>"u"){this.map.delete(i);return}if(!this.map.has(i))return;const n=this.get(i);if(!this.exists(i,r))return;const o=n.filter(l=>l!==r);if(!o.length){this.map.delete(i);return}this.map.set(i,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var tb=Object.defineProperty,rb=Object.defineProperties,ib=Object.getOwnPropertyDescriptors,nl=Object.getOwnPropertySymbols,sb=Object.prototype.hasOwnProperty,nb=Object.prototype.propertyIsEnumerable,ol=(u,i,r)=>i in u?tb(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,Us=(u,i)=>{for(var r in i||(i={}))sb.call(i,r)&&ol(u,r,i[r]);if(nl)for(var r of nl(i))nb.call(i,r)&&ol(u,r,i[r]);return u},Ja=(u,i)=>rb(u,ib(i));class ob extends cm{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.subscriptions=new Map,this.topicMap=new eb,this.events=new Ar.EventEmitter,this.name=zw,this.version=kw,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=_i,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}});try{const l=ic(o),d={topic:n,relay:l};this.pending.set(n,d);const v=await this.rpcSubscribe(n,l);return this.onSubscribe(v,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}}),v}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),typeof o?.id<"u"?await this.unsubscribeById(n,o.id,o):await this.unsubscribeByTopic(n,o)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((o,l)=>{const d=new ne.Watch;d.start(this.pendingSubscriptionWatchLabel);const v=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(v),d.stop(this.pendingSubscriptionWatchLabel),o(!0)),d.elapsed(this.pendingSubscriptionWatchLabel)>=Hw&&(clearInterval(v),d.stop(this.pendingSubscriptionWatchLabel),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=i,this.logger=Re.generateChildLogger(r,this.name),this.clientId=""}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(i,r){let n=!1;try{n=this.getSubscription(i).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(i,r){const n=this.topicMap.get(i);await Promise.all(n.map(async o=>await this.unsubscribeById(i,o,r)))}async unsubscribeById(i,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:n}});try{const o=ic(n);await this.rpcUnsubscribe(i,r,o);const l=er("USER_DISCONNECTED",`${this.name}, ${i}`);await this.onUnsubscribe(i,r,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:n}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(i,r){const n={method:to(r.protocol).subscribe,params:{topic:i}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await so(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(vt.connection_stalled)}return hs(i+this.clientId)}async rpcBatchSubscribe(i){if(!i.length)return;const r=i[0].relay,n={method:to(r.protocol).batchSubscribe,params:{topics:i.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await so(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(vt.connection_stalled)}}rpcUnsubscribe(i,r,n){const o={method:to(n.protocol).unsubscribe,params:{topic:i,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(i,r){this.setSubscription(i,Ja(Us({},r),{id:i})),this.pending.delete(r.topic)}onBatchSubscribe(i){i.length&&i.forEach(r=>{this.setSubscription(r.id,Us({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(i,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,i)&&this.deleteSubscription(r,n),await this.relayer.messages.del(i)}async setRelayerSubscriptions(i){await this.relayer.core.storage.setItem(this.storageKey,i)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(i,r){this.subscriptions.has(i)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:i,subscription:r}),this.addSubscription(i,r))}addSubscription(i,r){this.subscriptions.set(i,Us({},r)),this.topicMap.set(r.topic,i),this.events.emit(Br.created,r)}getSubscription(i){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:i});const r=this.subscriptions.get(i);if(!r){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(n)}return r}deleteSubscription(i,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:i,reason:r});const n=this.getSubscription(i);this.subscriptions.delete(i),this.topicMap.delete(n.topic,i),this.events.emit(Br.deleted,Ja(Us({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Br.sync)}async reset(){if(this.cached.length){const i=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<i;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Br.resubscribed)}async restore(){try{const i=await this.getRelayerSubscriptions();if(typeof i>"u"||!i.length)return;if(this.subscriptions.size){const{message:r}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(i){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(i)}}async batchSubscribe(i){if(!i.length)return;const r=await this.rpcBatchSubscribe(i);ls(r)&&this.onBatchSubscribe(r.map((n,o)=>Ja(Us({},i[o]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const i=[];this.pending.forEach(r=>{i.push(r)}),await this.batchSubscribe(i)}registerEventListeners(){this.relayer.core.heartbeat.on(fs.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(vt.connect,async()=>{await this.onConnect()}),this.relayer.on(vt.disconnect,()=>{this.onDisconnect()}),this.events.on(Br.created,async i=>{const r=Br.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()}),this.events.on(Br.deleted,async i=>{const r=Br.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=Q("NOT_INITIALIZED",this.name);throw new Error(i)}}async restartToComplete(){this.restartInProgress&&await new Promise(i=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),i())},this.pollingInterval)})}}var ab=Object.defineProperty,al=Object.getOwnPropertySymbols,cb=Object.prototype.hasOwnProperty,ub=Object.prototype.propertyIsEnumerable,cl=(u,i,r)=>i in u?ab(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,hb=(u,i)=>{for(var r in i||(i={}))cb.call(i,r)&&cl(u,r,i[r]);if(al)for(var r of al(i))ub.call(i,r)&&cl(u,r,i[r]);return u};class lb extends om{constructor(i){super(i),this.protocol="wc",this.version=2,this.events=new Ar.EventEmitter,this.name=Fw,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.core=i.core,this.logger=typeof i.logger<"u"&&typeof i.logger!="string"?Re.generateChildLogger(i.logger,this.name):Re.pino(Re.getDefaultLoggerOptions({level:i.logger||Dw})),this.messages=new Zw(this.logger,i.core),this.subscriber=new ob(this,this.logger),this.publisher=new Qw(this,this.logger),this.relayUrl=i?.relayUrl||df,this.projectId=i.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${il}...`),await this.restartTransport(il)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},jw)}get context(){return Re.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(i,r,n){this.isInitialized(),await this.publisher.publish(i,r,n),await this.recordMessageEvent({topic:i,message:r,publishedAt:Date.now()})}async subscribe(i,r){var n;this.isInitialized();let o=((n=this.subscriber.topicMap.get(i))==null?void 0:n[0])||"";return o||(await Promise.all([new Promise(l=>{this.subscriber.once(Br.created,d=>{d.topic===i&&l()})}),new Promise(async l=>{o=await this.subscriber.subscribe(i,r),l()})]),o)}async unsubscribe(i,r){this.isInitialized(),await this.subscriber.unsubscribe(i,r)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(vt.transport_closed))}async transportOpen(i){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=i||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(Br.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,n)=>{await so(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>n(o)).then(()=>r()).finally(()=>this.removeListener(vt.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(vt.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.events.emit(vt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(i){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=i||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(Ms.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(i){return this.staleConnectionErrors.some(r=>i.includes(r))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const i=await this.core.crypto.signJWT(this.relayUrl);this.provider=new bi(new Jm(p1({sdkVersion:Mw,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:i,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(i){const{topic:r,message:n}=i;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(i){const{topic:r,message:n}=i;return await this.subscriber.isSubscribed(r)?this.messages.has(r,n):!0}async onProviderPayload(i){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:i}),mc(i)){if(!i.method.endsWith(Lw))return;const r=i.params,{topic:n,message:o,publishedAt:l}=r.data,d={topic:n,message:o,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(hb({type:"event",event:r.id},d)),this.events.emit(r.id,d),await this.acknowledgePayload(i),await this.onMessageEvent(d)}else fo(i)&&this.events.emit(vt.message_ack,i)}async onMessageEvent(i){await this.shouldIgnoreMessageEvent(i)||(this.events.emit(vt.message,i),await this.recordMessageEvent(i))}async acknowledgePayload(i){const r=vc(i.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(Ms.payload,i=>this.onProviderPayload(i)),this.provider.on(Ms.connect,()=>{this.events.emit(vt.connect)}),this.provider.on(Ms.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(Ms.error,i=>{this.logger.error(i),this.events.emit(vt.error,i)})}registerEventListeners(){this.events.on(vt.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(vt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},ne.toMiliseconds($w))}isInitialized(){if(!this.initialized){const{message:i}=Q("NOT_INITIALIZED",this.name);throw new Error(i)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(i=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),i())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var fb=Object.defineProperty,ul=Object.getOwnPropertySymbols,pb=Object.prototype.hasOwnProperty,db=Object.prototype.propertyIsEnumerable,hl=(u,i,r)=>i in u?fb(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,ll=(u,i)=>{for(var r in i||(i={}))pb.call(i,r)&&hl(u,r,i[r]);if(ul)for(var r of ul(i))db.call(i,r)&&hl(u,r,i[r]);return u};class go extends am{constructor(i,r,n,o=_i,l=void 0){super(i,r,n,o),this.core=i,this.logger=r,this.name=n,this.map=new Map,this.version=Uw,this.cached=[],this.initialized=!1,this.storagePrefix=_i,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!mi(d)?this.map.set(this.getKey(d),d):r1(d)?this.map.set(d.id,d):i1(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,v)=>{this.isInitialized(),this.map.has(d)?await this.update(d,v):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:v}),this.map.set(d,v),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(v=>Object.keys(d).every(w=>Xm(v[w],d[w]))):this.values),this.update=async(d,v)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:v});const w=ll(ll({},this.getData(d)),v);this.map.set(d,w),await this.persist()},this.delete=async(d,v)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:v}),this.map.delete(d),await this.persist())},this.logger=Re.generateChildLogger(r,this.name),this.storagePrefix=o,this.getKey=l}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(i){await this.core.storage.setItem(this.storageKey,i)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(i){const r=this.map.get(i);if(!r){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const i=await this.getDataStore();if(typeof i>"u"||!i.length)return;if(this.map.size){const{message:r}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(i){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(i)}}isInitialized(){if(!this.initialized){const{message:i}=Q("NOT_INITIALIZED",this.name);throw new Error(i)}}}class gb{constructor(i,r){this.core=i,this.logger=r,this.name=Bw,this.version=Vw,this.events=new fc,this.initialized=!1,this.storagePrefix=_i,this.ignoredPayloadTypes=[Dl],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=rc(),o=await this.core.crypto.setSymKey(n),l=Fr(ne.FIVE_MINUTES),d={protocol:pf},v={topic:o,expiry:l,relay:d,active:!1},w=d1({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:n,relay:d});return await this.pairings.set(o,v),await this.core.relayer.subscribe(o),this.core.expirer.set(o,l),{topic:o,uri:w}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:o,symKey:l,relay:d}=g1(n.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const v=Fr(ne.FIVE_MINUTES),w={topic:o,relay:d,expiry:v,active:!1};return await this.pairings.set(o,w),await this.core.crypto.setSymKey(l,o),await this.core.relayer.subscribe(o,{relay:d}),this.core.expirer.set(o,v),n.activatePairing&&await this.activate({topic:o}),w},this.activate=async({topic:n})=>{this.isInitialized();const o=Fr(ne.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:o}),this.core.expirer.set(n,o)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:o}=n;if(this.pairings.keys.includes(o)){const l=await this.sendRequest(o,"wc_pairingPing",{}),{done:d,resolve:v,reject:w}=as();this.events.once(Ft("pairing_ping",l),({error:A})=>{A?w(A):v()}),await d()}},this.updateExpiry=async({topic:n,expiry:o})=>{this.isInitialized(),await this.pairings.update(n,{expiry:o})},this.updateMetadata=async({topic:n,metadata:o})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:o}=n;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",er("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(n,o,l)=>{const d=ho(o,l),v=await this.core.crypto.encode(n,d),w=js[o].req;return this.core.history.set(n,d),this.core.relayer.publish(n,v,w),d.id},this.sendResult=async(n,o,l)=>{const d=vc(n,l),v=await this.core.crypto.encode(o,d),w=await this.core.history.get(o,n),A=js[w.request.method].res;await this.core.relayer.publish(o,v,A),await this.core.history.resolve(d)},this.sendError=async(n,o,l)=>{const d=lo(n,l),v=await this.core.crypto.encode(o,d),w=await this.core.history.get(o,n),A=js[w.request.method]?js[w.request.method].res:js.unregistered_method.res;await this.core.relayer.publish(o,v,A),await this.core.history.resolve(d)},this.deletePairing=async(n,o)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,er("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),o?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(o=>vi(o.expiry));await Promise.all(n.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=n=>{const{topic:o,payload:l}=n,d=l.method;if(this.pairings.keys.includes(o))switch(d){case"wc_pairingPing":return this.onPairingPingRequest(o,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,l);default:return this.onUnknownRpcMethodRequest(o,l)}},this.onRelayEventResponse=async n=>{const{topic:o,payload:l}=n,d=(await this.core.history.get(o,l.id)).request.method;if(this.pairings.keys.includes(o))switch(d){case"wc_pairingPing":return this.onPairingPingResponse(o,l);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(n,o)=>{const{id:l}=o;try{this.isValidPing({topic:n}),await this.sendResult(l,n,!0),this.events.emit("pairing_ping",{id:l,topic:n})}catch(d){await this.sendError(l,n,d),this.logger.error(d)}},this.onPairingPingResponse=(n,o)=>{const{id:l}=o;setTimeout(()=>{ni(o)?this.events.emit(Ft("pairing_ping",l),{}):Lr(o)&&this.events.emit(Ft("pairing_ping",l),{error:o.error})},500)},this.onPairingDeleteRequest=async(n,o)=>{const{id:l}=o;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:l,topic:n})}catch(d){await this.sendError(l,n,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(n,o)=>{const{id:l,method:d}=o;try{if(this.registeredMethods.includes(d))return;const v=er("WC_METHOD_UNSUPPORTED",d);await this.sendError(l,n,v),this.logger.error(v)}catch(v){await this.sendError(l,n,v),this.logger.error(v)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(er("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!ar(n)){const{message:o}=Q("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(o)}if(!y1(n.uri)){const{message:o}=Q("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(o)}},this.isValidPing=async n=>{if(!ar(n)){const{message:l}=Q("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(l)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidDisconnect=async n=>{if(!ar(n)){const{message:l}=Q("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(l)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async n=>{if(!cs(n,!1)){const{message:o}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(o)}if(!this.pairings.keys.includes(n)){const{message:o}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(o)}if(vi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:o}=Q("EXPIRED",`pairing topic: ${n}`);throw new Error(o)}},this.core=i,this.logger=Re.generateChildLogger(r,this.name),this.pairings=new go(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Re.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:i}=Q("NOT_INITIALIZED",this.name);throw new Error(i)}}registerRelayerEvents(){this.core.relayer.on(vt.message,async i=>{const{topic:r,message:n}=i;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const o=await this.core.crypto.decode(r,n);mc(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):fo(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.core.history.delete(r,o.id))})}registerExpirerEvents(){this.core.expirer.on(Sr.expired,async i=>{const{topic:r}=Fl(i.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class yb extends im{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.records=new Map,this.events=new Ar.EventEmitter,this.name=Kw,this.version=Gw,this.cached=[],this.initialized=!1,this.storagePrefix=_i,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,o,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:o,chainId:l}),this.records.has(o.id))return;const d={id:o.id,topic:n,request:{method:o.method,params:o.params||null},chainId:l,expiry:Fr(ne.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(Hr.created,d)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const o=await this.getRecord(n.id);typeof o.response>"u"&&(o.response=Lr(n)?{error:n.error}:{result:n.result},this.records.set(o.id,o),this.events.emit(Hr.updated,o))},this.get=async(n,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:o}),await this.getRecord(o)),this.delete=(n,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(l=>{if(l.topic===n){if(typeof o<"u"&&l.id!==o)return;this.records.delete(l.id),this.events.emit(Hr.deleted,l)}})},this.exists=async(n,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===n:!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const i=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:ho(r.request.method,r.request.params,r.id),chainId:r.chainId};return i.push(n)}),i}async setJsonRpcRecords(i){await this.core.storage.setItem(this.storageKey,i)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(i){this.isInitialized();const r=this.records.get(i);if(!r){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Hr.sync)}async restore(){try{const i=await this.getJsonRpcRecords();if(typeof i>"u"||!i.length)return;if(this.records.size){const{message:r}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}}registerEventListeners(){this.events.on(Hr.created,i=>{const r=Hr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(Hr.updated,i=>{const r=Hr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(Hr.deleted,i=>{const r=Hr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.core.heartbeat.on(fs.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(i=>{ne.toMiliseconds(i.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${i.id}`),this.delete(i.topic,i.id))})}catch(i){this.logger.warn(i)}}isInitialized(){if(!this.initialized){const{message:i}=Q("NOT_INITIALIZED",this.name);throw new Error(i)}}}class vb extends um{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.expirations=new Map,this.events=new Ar.EventEmitter,this.name=Ww,this.version=Jw,this.cached=[],this.initialized=!1,this.storagePrefix=_i,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const o=this.formatTarget(n);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(n,o)=>{this.isInitialized();const l=this.formatTarget(n),d={target:l,expiry:o};this.expirations.set(l,d),this.checkExpiry(l,d),this.events.emit(Sr.created,{target:l,expiration:d})},this.get=n=>{this.isInitialized();const o=this.formatTarget(n);return this.getExpiration(o)},this.del=n=>{if(this.isInitialized(),this.has(n)){const o=this.formatTarget(n),l=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Sr.deleted,{target:o,expiration:l})}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(i){if(typeof i=="string")return v1(i);if(typeof i=="number")return m1(i);const{message:r}=Q("UNKNOWN_TYPE",`Target type: ${typeof i}`);throw new Error(r)}async setExpirations(i){await this.core.storage.setItem(this.storageKey,i)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Sr.sync)}async restore(){try{const i=await this.getExpirations();if(typeof i>"u"||!i.length)return;if(this.expirations.size){const{message:r}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(i){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(i)}}getExpiration(i){const r=this.expirations.get(i);if(!r){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(i,r){const{expiry:n}=r;ne.toMiliseconds(n)-Date.now()<=0&&this.expire(i,r)}expire(i,r){this.expirations.delete(i),this.events.emit(Sr.expired,{target:i,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((i,r)=>this.checkExpiry(r,i))}registerEventListeners(){this.core.heartbeat.on(fs.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Sr.created,i=>{const r=Sr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Sr.expired,i=>{const r=Sr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Sr.deleted,i=>{const r=Sr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=Q("NOT_INITIALIZED",this.name);throw new Error(i)}}}class mb extends hm{constructor(i,r){super(i,r),this.projectId=i,this.logger=r,this.name=Wa,this.initialized=!1,this.init=async n=>{_1()||!Ll()||(this.verifyUrl=n?.verifyUrl||sl,await this.createIframe())},this.register=async n=>{var o;if(this.initialized||await this.init(),!!this.iframe)try{(o=this.iframe.contentWindow)==null||o.postMessage(n.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${n.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async n=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${n.attestationId}`);const l=this.startAbortTimer(ne.FIVE_SECONDS),d=await fetch(`${this.verifyUrl}/attestation/${n.attestationId}`,{signal:this.abortController.signal});return clearTimeout(l),d.status===200?(o=await d.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((n,o)=>{if(document.getElementById(Wa))return n();const l=document.createElement("iframe");l.setAttribute("id",Wa),l.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),l.style.display="none",l.addEventListener("load",()=>{this.initialized=!0,n()}),l.addEventListener("error",d=>{o(d)}),document.body.append(l),this.iframe=l}),new Promise(n=>{setTimeout(()=>n("iframe load timeout"),ne.toMiliseconds(ne.ONE_SECOND/2))})])}catch(n){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(n)}},this.logger=Re.generateChildLogger(r,this.name),this.verifyUrl=sl,this.abortController=new AbortController,this.isDevEnv=w1()&&{}.IS_VITEST}get context(){return Re.getLoggerContext(this.logger)}startAbortTimer(i){return setTimeout(()=>this.abortController.abort(),ne.toMiliseconds(i))}}var _b=Object.defineProperty,fl=Object.getOwnPropertySymbols,wb=Object.prototype.hasOwnProperty,bb=Object.prototype.propertyIsEnumerable,pl=(u,i,r)=>i in u?_b(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,dl=(u,i)=>{for(var r in i||(i={}))wb.call(i,r)&&pl(u,r,i[r]);if(fl)for(var r of fl(i))bb.call(i,r)&&pl(u,r,i[r]);return u};class wc extends rm{constructor(i){super(i),this.protocol=ff,this.version=Ew,this.name=_c,this.events=new Ar.EventEmitter,this.initialized=!1,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.projectId=i?.projectId,this.relayUrl=i?.relayUrl||df;const r=typeof i?.logger<"u"&&typeof i?.logger!="string"?i.logger:Re.pino(Re.getDefaultLoggerOptions({level:i?.logger||xw.logger}));this.logger=Re.generateChildLogger(r,this.name),this.heartbeat=new fs.HeartBeat,this.crypto=new Xw(this,this.logger,i?.keychain),this.history=new yb(this,this.logger),this.expirer=new vb(this,this.logger),this.storage=i!=null&&i.storage?i.storage:new G1(dl(dl({},Iw),i?.storageOptions)),this.relayer=new lb({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new gb(this,this.logger),this.verify=new mb(this.projectId||"",this.logger)}static async init(i){const r=new wc(i);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(qw,n),r}get context(){return Re.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(i){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,i),this.logger.error(i.message),i}}}const Eb=wc,gf="wc",yf=2,vf="client",bc=`${gf}@${yf}:${vf}:`,Ya={name:vf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},xb="WALLETCONNECT_DEEPLINK_CHOICE",Ib="proposal",mf="Proposal expired",Sb="session",Zn=ne.SEVEN_DAYS,Pb="engine",qs={wc_sessionPropose:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1115}}},Xa={min:ne.FIVE_MINUTES,max:ne.SEVEN_DAYS},Ab="request",Cb=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Ob=Object.defineProperty,Rb=Object.defineProperties,Tb=Object.getOwnPropertyDescriptors,gl=Object.getOwnPropertySymbols,Nb=Object.prototype.hasOwnProperty,Db=Object.prototype.propertyIsEnumerable,yl=(u,i,r)=>i in u?Ob(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,Ir=(u,i)=>{for(var r in i||(i={}))Nb.call(i,r)&&yl(u,r,i[r]);if(gl)for(var r of gl(i))Db.call(i,r)&&yl(u,r,i[r]);return u},Za=(u,i)=>Rb(u,Tb(i));class Fb extends fm{constructor(i){super(i),this.name=Pb,this.events=new fc,this.initialized=!1,this.ignoredPayloadTypes=[Dl],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(qs)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const n=Za(Ir({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:o,requiredNamespaces:l,optionalNamespaces:d,sessionProperties:v,relays:w}=n;let A=o,L,K=!1;if(A&&(K=this.client.core.pairing.pairings.get(A).active),!A||!K){const{topic:pe,uri:he}=await this.client.core.pairing.create();A=pe,L=he}const J=await this.client.core.crypto.generateKeyPair(),G=Ir({requiredNamespaces:l,optionalNamespaces:d,relays:w??[{protocol:pf}],proposer:{publicKey:J,metadata:this.client.metadata}},v&&{sessionProperties:v}),{reject:M,resolve:V,done:ie}=as(ne.FIVE_MINUTES,mf);if(this.events.once(Ft("session_connect"),async({error:pe,session:he})=>{if(pe)M(pe);else if(he){he.self.publicKey=J;const le=Za(Ir({},he),{requiredNamespaces:he.requiredNamespaces,optionalNamespaces:he.optionalNamespaces});await this.client.session.set(he.topic,le),await this.setExpiry(he.topic,he.expiry),A&&await this.client.core.pairing.updateMetadata({topic:A,metadata:he.peer.metadata}),V(le)}}),!A){const{message:pe}=Q("NO_MATCHING_KEY",`connect() pairing topic: ${A}`);throw new Error(pe)}const Ee=await this.sendRequest(A,"wc_sessionPropose",G),ge=Fr(ne.FIVE_MINUTES);return await this.setProposal(Ee,Ir({id:Ee,expiry:ge},G)),{uri:L,approval:ie}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:o,namespaces:l,sessionProperties:d}=r,v=this.client.proposal.get(n);let{pairingTopic:w,proposer:A,requiredNamespaces:L,optionalNamespaces:K}=v;w=w||"",ro(L)||(L=E1(l,"approve()"));const J=await this.client.core.crypto.generateKeyPair(),G=A.publicKey,M=await this.client.core.crypto.generateSharedKey(J,G);w&&n&&(await this.client.core.pairing.updateMetadata({topic:w,metadata:A.metadata}),await this.sendResult(n,w,{relay:{protocol:o??"irn"},responderPublicKey:J}),await this.client.proposal.delete(n,er("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:w}));const V=Ir({relay:{protocol:o??"irn"},namespaces:l,requiredNamespaces:L,optionalNamespaces:K,pairingTopic:w,controller:{publicKey:J,metadata:this.client.metadata},expiry:Fr(Zn)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(M),await this.sendRequest(M,"wc_sessionSettle",V);const ie=Za(Ir({},V),{topic:M,pairingTopic:w,acknowledged:!1,self:V.controller,peer:{publicKey:A.publicKey,metadata:A.metadata},controller:J});return await this.client.session.set(M,ie),await this.setExpiry(M,Fr(Zn)),{topic:M,acknowledged:()=>new Promise(Ee=>setTimeout(()=>Ee(this.client.session.get(M)),500))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:n,reason:o}=r,{pairingTopic:l}=this.client.proposal.get(n);l&&(await this.sendError(n,l,o),await this.client.proposal.delete(n,er("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:o}=r,l=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:o}),{done:d,resolve:v,reject:w}=as();return this.events.once(Ft("session_update",l),({error:A})=>{A?w(A):v()}),await this.client.session.update(n,{namespaces:o}),{acknowledged:d}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,o=await this.sendRequest(n,"wc_sessionExtend",{}),{done:l,resolve:d,reject:v}=as();return this.events.once(Ft("session_extend",o),({error:w})=>{w?v(w):d()}),await this.setExpiry(n,Fr(Zn)),{acknowledged:l}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:o,topic:l,expiry:d}=r,v=await this.sendRequest(l,"wc_sessionRequest",{request:o,chainId:n},d),{done:w,resolve:A,reject:L}=as(d);this.events.once(Ft("session_request",v),({error:J,result:G})=>{J?L(J):A(G)}),this.client.events.emit("session_request_sent",{topic:l,request:o,chainId:n,id:v});const K=await this.client.core.storage.getItem(xb);return x1({id:v,topic:l,wcDeepLink:K}),await w()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:o}=r,{id:l}=o;ni(o)?await this.sendResult(l,n,o.result):Lr(o)&&await this.sendError(l,n,o.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const o=await this.sendRequest(n,"wc_sessionPing",{}),{done:l,resolve:d,reject:v}=as();this.events.once(Ft("session_ping",o),({error:w})=>{w?v(w):d()}),await l()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:o,chainId:l}=r;await this.sendRequest(n,"wc_sessionEvent",{event:o,chainId:l})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const o=yc().toString();let l;const d=v=>{v?.id.toString()===o&&(this.client.core.relayer.events.removeListener(vt.message_ack,d),l())};await Promise.all([new Promise(v=>{l=v,this.client.core.relayer.on(vt.message_ack,d)}),this.sendRequest(n,"wc_sessionDelete",er("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(n)}else await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>I1(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(l=>{var d,v;return((d=l.peerMetadata)==null?void 0:d.url)&&((v=l.peerMetadata)==null?void 0:v.url)===r.peer.metadata.url&&l.topic&&l.topic!==n.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(l=>this.client.core.pairing.disconnect({topic:l.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,er("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r)},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,er("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),o?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=qs.wc_sessionRequest.req.ttl,{id:o,topic:l,params:d}=r;await this.client.pendingRequest.set(o,{id:o,topic:l,params:d}),n&&this.client.core.expirer.set(o,Fr(n))},this.sendRequest=async(r,n,o,l,d)=>{const v=ho(n,o);if(Ll()&&Cb.includes(n)){const L=hs(JSON.stringify(v));await this.client.core.verify.register({attestationId:L})}const w=await this.client.core.crypto.encode(r,v),A=qs[n].req;return l&&(A.ttl=l),d&&(A.id=d),this.client.core.history.set(r,v),this.client.core.relayer.publish(r,w,A),v.id},this.sendResult=async(r,n,o)=>{const l=vc(r,o),d=await this.client.core.crypto.encode(n,l),v=await this.client.core.history.get(n,r),w=qs[v.request.method].res;this.client.core.relayer.publish(n,d,w),await this.client.core.history.resolve(l)},this.sendError=async(r,n,o)=>{const l=lo(r,o),d=await this.client.core.crypto.encode(n,l),v=await this.client.core.history.get(n,r),w=qs[v.request.method].res;this.client.core.relayer.publish(n,d,w),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(o=>{vi(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{vi(o.expiry)&&n.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...n.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=r=>{const{topic:n,payload:o}=r,l=o.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(n,o);case"wc_sessionSettle":return this.onSessionSettleRequest(n,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,o);case"wc_sessionExtend":return this.onSessionExtendRequest(n,o);case"wc_sessionPing":return this.onSessionPingRequest(n,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,o);case"wc_sessionRequest":return this.onSessionRequest(n,o);case"wc_sessionEvent":return this.onSessionEventRequest(n,o);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:o}=r,l=(await this.client.core.history.get(n,o.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(n,o);case"wc_sessionSettle":return this.onSessionSettleResponse(n,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,o);case"wc_sessionExtend":return this.onSessionExtendResponse(n,o);case"wc_sessionPing":return this.onSessionPingResponse(n,o);case"wc_sessionRequest":return this.onSessionRequestResponse(n,o);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:o}=Q("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,n)=>{const{params:o,id:l}=n;try{this.isValidConnect(Ir({},n.params));const d=Fr(ne.FIVE_MINUTES),v=Ir({id:l,pairingTopic:r,expiry:d},o);await this.setProposal(l,v);const w=hs(JSON.stringify(n)),A=await this.getVerifyContext(w,v.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:v,verifyContext:A})}catch(d){await this.sendError(l,r,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(r,n)=>{const{id:o}=n;if(ni(n)){const{result:l}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const d=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const v=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:v});const w=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:w});const A=await this.client.core.crypto.generateSharedKey(v,w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:A});const L=await this.client.core.relayer.subscribe(A);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:L}),await this.client.core.pairing.activate({topic:r})}else Lr(n)&&(await this.client.proposal.delete(o,er("USER_DISCONNECTED")),this.events.emit(Ft("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:o,params:l}=n;try{this.isValidSessionSettleRequest(l);const{relay:d,controller:v,expiry:w,namespaces:A,requiredNamespaces:L,optionalNamespaces:K,sessionProperties:J,pairingTopic:G}=n.params,M=Ir({topic:r,relay:d,expiry:w,namespaces:A,acknowledged:!0,pairingTopic:G,requiredNamespaces:L,optionalNamespaces:K,controller:v.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:v.publicKey,metadata:v.metadata}},J&&{sessionProperties:J});await this.sendResult(n.id,r,!0),this.events.emit(Ft("session_connect"),{session:M}),this.cleanupDuplicatePairings(M)}catch(d){await this.sendError(o,r,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(r,n)=>{const{id:o}=n;ni(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ft("session_approve",o),{})):Lr(n)&&(await this.client.session.delete(r,er("USER_DISCONNECTED")),this.events.emit(Ft("session_approve",o),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:o,id:l}=n;try{this.isValidUpdate(Ir({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult(l,r,!0),this.client.events.emit("session_update",{id:l,topic:r,params:o})}catch(d){await this.sendError(l,r,d),this.client.logger.error(d)}},this.onSessionUpdateResponse=(r,n)=>{const{id:o}=n;ni(n)?this.events.emit(Ft("session_update",o),{}):Lr(n)&&this.events.emit(Ft("session_update",o),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:o}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Fr(Zn)),await this.sendResult(o,r,!0),this.client.events.emit("session_extend",{id:o,topic:r})}catch(l){await this.sendError(o,r,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(r,n)=>{const{id:o}=n;ni(n)?this.events.emit(Ft("session_extend",o),{}):Lr(n)&&this.events.emit(Ft("session_extend",o),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:o}=n;try{this.isValidPing({topic:r}),await this.sendResult(o,r,!0),this.client.events.emit("session_ping",{id:o,topic:r})}catch(l){await this.sendError(o,r,l),this.client.logger.error(l)}},this.onSessionPingResponse=(r,n)=>{const{id:o}=n;setTimeout(()=>{ni(n)?this.events.emit(Ft("session_ping",o),{}):Lr(n)&&this.events.emit(Ft("session_ping",o),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(vt.publish,async()=>{l(await this.deleteSession(r))})}),this.sendResult(o,r,!0)]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(l){this.client.logger.error(l)}},this.onSessionRequest=async(r,n)=>{const{id:o,params:l}=n;try{this.isValidRequest(Ir({topic:r},l)),await this.setPendingSessionRequest({id:o,topic:r,params:l});const d=hs(JSON.stringify(n)),v=this.client.session.get(r),w=await this.getVerifyContext(d,v.peer.metadata);this.client.events.emit("session_request",{id:o,topic:r,params:l,verifyContext:w})}catch(d){await this.sendError(o,r,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(r,n)=>{const{id:o}=n;ni(n)?this.events.emit(Ft("session_request",o),{result:n.result}):Lr(n)&&this.events.emit(Ft("session_request",o),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:o,params:l}=n;try{this.isValidEmit(Ir({topic:r},l)),this.client.events.emit("session_event",{id:o,topic:r,params:l})}catch(d){await this.sendError(o,r,d),this.client.logger.error(d)}},this.isValidConnect=async r=>{if(!ar(r)){const{message:w}=Q("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(w)}const{pairingTopic:n,requiredNamespaces:o,optionalNamespaces:l,sessionProperties:d,relays:v}=r;if(mi(n)||await this.isValidPairingTopic(n),!S1(v,!0)){const{message:w}=Q("MISSING_OR_INVALID",`connect() relays: ${v}`);throw new Error(w)}!mi(o)&&ro(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!mi(l)&&ro(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),mi(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(r,n)=>{const o=P1(r,"connect()",n);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!ar(r))throw new Error(Q("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:o,relayProtocol:l,sessionProperties:d}=r;await this.isValidProposalId(n);const v=this.client.proposal.get(n),w=qa(o,"approve()");if(w)throw new Error(w.message);const A=Sh(v.requiredNamespaces,o,"approve()");if(A)throw new Error(A.message);if(!cs(l,!0)){const{message:L}=Q("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(L)}mi(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async r=>{if(!ar(r)){const{message:l}=Q("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(l)}const{id:n,reason:o}=r;if(await this.isValidProposalId(n),!A1(o)){const{message:l}=Q("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(l)}},this.isValidSessionSettleRequest=r=>{if(!ar(r)){const{message:A}=Q("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(A)}const{relay:n,controller:o,namespaces:l,expiry:d}=r;if(!C1(n)){const{message:A}=Q("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(A)}const v=O1(o,"onSessionSettleRequest()");if(v)throw new Error(v.message);const w=qa(l,"onSessionSettleRequest()");if(w)throw new Error(w.message);if(vi(d)){const{message:A}=Q("EXPIRED","onSessionSettleRequest()");throw new Error(A)}},this.isValidUpdate=async r=>{if(!ar(r)){const{message:w}=Q("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(w)}const{topic:n,namespaces:o}=r;await this.isValidSessionTopic(n);const l=this.client.session.get(n),d=qa(o,"update()");if(d)throw new Error(d.message);const v=Sh(l.requiredNamespaces,o,"update()");if(v)throw new Error(v.message)},this.isValidExtend=async r=>{if(!ar(r)){const{message:o}=Q("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!ar(r)){const{message:w}=Q("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(w)}const{topic:n,request:o,chainId:l,expiry:d}=r;await this.isValidSessionTopic(n);const{namespaces:v}=this.client.session.get(n);if(!Ph(v,l)){const{message:w}=Q("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(w)}if(!R1(o)){const{message:w}=Q("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(w)}if(!T1(v,l,o.method)){const{message:w}=Q("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(w)}if(d&&!N1(d,Xa)){const{message:w}=Q("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${Xa.min} and ${Xa.max}`);throw new Error(w)}},this.isValidRespond=async r=>{if(!ar(r)){const{message:l}=Q("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:n,response:o}=r;if(await this.isValidSessionTopic(n),!D1(o)){const{message:l}=Q("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!ar(r)){const{message:o}=Q("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!ar(r)){const{message:v}=Q("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(v)}const{topic:n,event:o,chainId:l}=r;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!Ph(d,l)){const{message:v}=Q("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(v)}if(!F1(o)){const{message:v}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(v)}if(!L1(d,l,o.name)){const{message:v}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(v)}},this.isValidDisconnect=async r=>{if(!ar(r)){const{message:o}=Q("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const o={verified:{verifyUrl:n.verifyUrl||"",validation:"UNKNOWN",origin:n.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});l&&(o.verified.origin=l,o.verified.validation=l===n.url?"VALID":"INVALID")}catch(l){this.client.logger.error(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(o=>{if(!cs(o,!1)){const{message:l}=Q("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(l)}})}}isInitialized(){if(!this.initialized){const{message:i}=Q("NOT_INITIALIZED",this.name);throw new Error(i)}}registerRelayerEvents(){this.client.core.relayer.on(vt.message,async i=>{const{topic:r,message:n}=i;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const o=await this.client.core.crypto.decode(r,n);mc(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):fo(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.client.core.history.delete(r,o.id)):this.onRelayEventUnknownPayload({topic:r,payload:o})})}registerExpirerEvents(){this.client.core.expirer.on(Sr.expired,async i=>{const{topic:r,id:n}=Fl(i.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,Q("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(i){if(!cs(i,!1)){const{message:r}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(i)){const{message:r}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(r)}if(vi(this.client.core.pairing.pairings.get(i).expiry)){const{message:r}=Q("EXPIRED",`pairing topic: ${i}`);throw new Error(r)}}async isValidSessionTopic(i){if(!cs(i,!1)){const{message:r}=Q("MISSING_OR_INVALID",`session topic should be a string: ${i}`);throw new Error(r)}if(!this.client.session.keys.includes(i)){const{message:r}=Q("NO_MATCHING_KEY",`session topic doesn't exist: ${i}`);throw new Error(r)}if(vi(this.client.session.get(i).expiry)){await this.deleteSession(i);const{message:r}=Q("EXPIRED",`session topic: ${i}`);throw new Error(r)}}async isValidSessionOrPairingTopic(i){if(this.client.session.keys.includes(i))await this.isValidSessionTopic(i);else if(this.client.core.pairing.pairings.keys.includes(i))this.isValidPairingTopic(i);else if(cs(i,!1)){const{message:r}=Q("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${i}`);throw new Error(r)}else{const{message:r}=Q("MISSING_OR_INVALID",`session or pairing topic should be a string: ${i}`);throw new Error(r)}}async isValidProposalId(i){if(!$1(i)){const{message:r}=Q("MISSING_OR_INVALID",`proposal id should be a number: ${i}`);throw new Error(r)}if(!this.client.proposal.keys.includes(i)){const{message:r}=Q("NO_MATCHING_KEY",`proposal id doesn't exist: ${i}`);throw new Error(r)}if(vi(this.client.proposal.get(i).expiry)){await this.deleteProposal(i);const{message:r}=Q("EXPIRED",`proposal id: ${i}`);throw new Error(r)}}}class Lb extends go{constructor(i,r){super(i,r,Ib,bc),this.core=i,this.logger=r}}class $b extends go{constructor(i,r){super(i,r,Sb,bc),this.core=i,this.logger=r}}class Mb extends go{constructor(i,r){super(i,r,Ab,bc,n=>n.id),this.core=i,this.logger=r}}let jb=class _f extends lm{constructor(i){super(i),this.protocol=gf,this.version=yf,this.name=Ya.name,this.events=new Ar.EventEmitter,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(o){throw this.logger.error(o.message),o}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(o){throw this.logger.error(o.message),o}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(o){throw this.logger.error(o.message),o}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(o){throw this.logger.error(o.message),o}},this.update=async n=>{try{return await this.engine.update(n)}catch(o){throw this.logger.error(o.message),o}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(o){throw this.logger.error(o.message),o}},this.request=async n=>{try{return await this.engine.request(n)}catch(o){throw this.logger.error(o.message),o}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(o){throw this.logger.error(o.message),o}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(o){throw this.logger.error(o.message),o}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(o){throw this.logger.error(o.message),o}},this.find=n=>{try{return this.engine.find(n)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=i?.name||Ya.name,this.metadata=i?.metadata||b1();const r=typeof i?.logger<"u"&&typeof i?.logger!="string"?i.logger:Re.pino(Re.getDefaultLoggerOptions({level:i?.logger||Ya.logger}));this.core=i?.core||new Eb(i),this.logger=Re.generateChildLogger(r,this.name),this.session=new $b(this.core,this.logger),this.proposal=new Lb(this.core,this.logger),this.pendingRequest=new Mb(this.core,this.logger),this.engine=new Fb(this)}static async init(i){const r=new _f(i);return await r.initialize(),r}get context(){return Re.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(i){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(i.message),i}}};var oc={exports:{}};(function(u,i){var r=typeof self<"u"?self:cr,n=function(){function l(){this.fetch=!1,this.DOMException=r.DOMException}return l.prototype=r,new l}();(function(l){(function(d){var v={searchParams:"URLSearchParams"in l,iterable:"Symbol"in l&&"iterator"in Symbol,blob:"FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in l,arrayBuffer:"ArrayBuffer"in l};function w(y){return y&&DataView.prototype.isPrototypeOf(y)}if(v.arrayBuffer)var A=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],L=ArrayBuffer.isView||function(y){return y&&A.indexOf(Object.prototype.toString.call(y))>-1};function K(y){if(typeof y!="string"&&(y=String(y)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(y))throw new TypeError("Invalid character in header field name");return y.toLowerCase()}function J(y){return typeof y!="string"&&(y=String(y)),y}function G(y){var E={next:function(){var X=y.shift();return{done:X===void 0,value:X}}};return v.iterable&&(E[Symbol.iterator]=function(){return E}),E}function M(y){this.map={},y instanceof M?y.forEach(function(E,X){this.append(X,E)},this):Array.isArray(y)?y.forEach(function(E){this.append(E[0],E[1])},this):y&&Object.getOwnPropertyNames(y).forEach(function(E){this.append(E,y[E])},this)}M.prototype.append=function(y,E){y=K(y),E=J(E);var X=this.map[y];this.map[y]=X?X+", "+E:E},M.prototype.delete=function(y){delete this.map[K(y)]},M.prototype.get=function(y){return y=K(y),this.has(y)?this.map[y]:null},M.prototype.has=function(y){return this.map.hasOwnProperty(K(y))},M.prototype.set=function(y,E){this.map[K(y)]=J(E)},M.prototype.forEach=function(y,E){for(var X in this.map)this.map.hasOwnProperty(X)&&y.call(E,this.map[X],X,this)},M.prototype.keys=function(){var y=[];return this.forEach(function(E,X){y.push(X)}),G(y)},M.prototype.values=function(){var y=[];return this.forEach(function(E){y.push(E)}),G(y)},M.prototype.entries=function(){var y=[];return this.forEach(function(E,X){y.push([X,E])}),G(y)},v.iterable&&(M.prototype[Symbol.iterator]=M.prototype.entries);function V(y){if(y.bodyUsed)return Promise.reject(new TypeError("Already read"));y.bodyUsed=!0}function ie(y){return new Promise(function(E,X){y.onload=function(){E(y.result)},y.onerror=function(){X(y.error)}})}function Ee(y){var E=new FileReader,X=ie(E);return E.readAsArrayBuffer(y),X}function ge(y){var E=new FileReader,X=ie(E);return E.readAsText(y),X}function pe(y){for(var E=new Uint8Array(y),X=new Array(E.length),ce=0;ce<E.length;ce++)X[ce]=String.fromCharCode(E[ce]);return X.join("")}function he(y){if(y.slice)return y.slice(0);var E=new Uint8Array(y.byteLength);return E.set(new Uint8Array(y)),E.buffer}function le(){return this.bodyUsed=!1,this._initBody=function(y){this._bodyInit=y,y?typeof y=="string"?this._bodyText=y:v.blob&&Blob.prototype.isPrototypeOf(y)?this._bodyBlob=y:v.formData&&FormData.prototype.isPrototypeOf(y)?this._bodyFormData=y:v.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)?this._bodyText=y.toString():v.arrayBuffer&&v.blob&&w(y)?(this._bodyArrayBuffer=he(y.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):v.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(y)||L(y))?this._bodyArrayBuffer=he(y):this._bodyText=y=Object.prototype.toString.call(y):this._bodyText="",this.headers.get("content-type")||(typeof y=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):v.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},v.blob&&(this.blob=function(){var y=V(this);if(y)return y;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?V(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Ee)}),this.text=function(){var y=V(this);if(y)return y;if(this._bodyBlob)return ge(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(pe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(ye)}),this.json=function(){return this.text().then(JSON.parse)},this}var T=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function j(y){var E=y.toUpperCase();return T.indexOf(E)>-1?E:y}function B(y,E){E=E||{};var X=E.body;if(y instanceof B){if(y.bodyUsed)throw new TypeError("Already read");this.url=y.url,this.credentials=y.credentials,E.headers||(this.headers=new M(y.headers)),this.method=y.method,this.mode=y.mode,this.signal=y.signal,!X&&y._bodyInit!=null&&(X=y._bodyInit,y.bodyUsed=!0)}else this.url=String(y);if(this.credentials=E.credentials||this.credentials||"same-origin",(E.headers||!this.headers)&&(this.headers=new M(E.headers)),this.method=j(E.method||this.method||"GET"),this.mode=E.mode||this.mode||null,this.signal=E.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&X)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(X)}B.prototype.clone=function(){return new B(this,{body:this._bodyInit})};function ye(y){var E=new FormData;return y.trim().split("&").forEach(function(X){if(X){var ce=X.split("="),k=ce.shift().replace(/\+/g," "),U=ce.join("=").replace(/\+/g," ");E.append(decodeURIComponent(k),decodeURIComponent(U))}}),E}function re(y){var E=new M,X=y.replace(/\r?\n[\t ]+/g," ");return X.split(/\r?\n/).forEach(function(ce){var k=ce.split(":"),U=k.shift().trim();if(U){var z=k.join(":").trim();E.append(U,z)}}),E}le.call(B.prototype);function ue(y,E){E||(E={}),this.type="default",this.status=E.status===void 0?200:E.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in E?E.statusText:"OK",this.headers=new M(E.headers),this.url=E.url||"",this._initBody(y)}le.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new M(this.headers),url:this.url})},ue.error=function(){var y=new ue(null,{status:0,statusText:""});return y.type="error",y};var Te=[301,302,303,307,308];ue.redirect=function(y,E){if(Te.indexOf(E)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:E,headers:{location:y}})},d.DOMException=l.DOMException;try{new d.DOMException}catch{d.DOMException=function(E,X){this.message=E,this.name=X;var ce=Error(E);this.stack=ce.stack},d.DOMException.prototype=Object.create(Error.prototype),d.DOMException.prototype.constructor=d.DOMException}function qe(y,E){return new Promise(function(X,ce){var k=new B(y,E);if(k.signal&&k.signal.aborted)return ce(new d.DOMException("Aborted","AbortError"));var U=new XMLHttpRequest;function z(){U.abort()}U.onload=function(){var H={status:U.status,statusText:U.statusText,headers:re(U.getAllResponseHeaders()||"")};H.url="responseURL"in U?U.responseURL:H.headers.get("X-Request-URL");var Je="response"in U?U.response:U.responseText;X(new ue(Je,H))},U.onerror=function(){ce(new TypeError("Network request failed"))},U.ontimeout=function(){ce(new TypeError("Network request failed"))},U.onabort=function(){ce(new d.DOMException("Aborted","AbortError"))},U.open(k.method,k.url,!0),k.credentials==="include"?U.withCredentials=!0:k.credentials==="omit"&&(U.withCredentials=!1),"responseType"in U&&v.blob&&(U.responseType="blob"),k.headers.forEach(function(H,Je){U.setRequestHeader(Je,H)}),k.signal&&(k.signal.addEventListener("abort",z),U.onreadystatechange=function(){U.readyState===4&&k.signal.removeEventListener("abort",z)}),U.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return qe.polyfill=!0,l.fetch||(l.fetch=qe,l.Headers=M,l.Request=B,l.Response=ue),d.Headers=M,d.Request=B,d.Response=ue,d.fetch=qe,Object.defineProperty(d,"__esModule",{value:!0}),d})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;i=o.fetch,i.default=o.fetch,i.fetch=o.fetch,i.Headers=o.Headers,i.Request=o.Request,i.Response=o.Response,u.exports=i})(oc,oc.exports);var Ub=oc.exports;const vl=Nl(Ub),qb={Accept:"application/json","Content-Type":"application/json"},zb="POST",ml={headers:qb,method:zb},_l=10;class qi{constructor(i,r=!1){if(this.url=i,this.disableProviderPing=r,this.events=new Ar.EventEmitter,this.isAvailable=!1,this.registering=!1,!Kh(i))throw new Error(`Provided URL is not compatible with HTTP connection: ${i}`);this.url=i,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async open(i=this.url){await this.register(i)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(i,r){this.isAvailable||await this.register();try{const n=Bs(i),l=await(await vl(this.url,Object.assign(Object.assign({},ml),{body:n}))).json();this.onPayload({data:l})}catch(n){this.onError(i.id,n)}}async register(i=this.url){if(!Kh(i))throw new Error(`Provided URL is not compatible with HTTP connection: ${i}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,o)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),o(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));n()})})}this.url=i,this.registering=!0;try{if(!this.disableProviderPing){const r=Bs({id:1,jsonrpc:"2.0",method:"test",params:[]});await vl(i,Object.assign(Object.assign({},ml),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(i){if(typeof i.data>"u")return;const r=typeof i.data=="string"?pc(i.data):i.data;this.events.emit("payload",r)}onError(i,r){const n=this.parseError(r),o=n.message||n.toString(),l=lo(i,o);this.events.emit("payload",l)}parseError(i,r=this.url){return Jl(i,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>_l&&this.events.setMaxListeners(_l)}}const wl="error",kb="wss://relay.walletconnect.com",Hb="wc",Bb="universal_provider",bl=`${Hb}@2:${Bb}:`,Vb="https://rpc.walletconnect.com/v1",Ei={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var zs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ac={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(u,i){(function(){var r,n="4.17.21",o=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",v="Invalid `variable` option passed into `_.template`",w="__lodash_hash_undefined__",A=500,L="__lodash_placeholder__",K=1,J=2,G=4,M=1,V=2,ie=1,Ee=2,ge=4,pe=8,he=16,le=32,T=64,j=128,B=256,ye=512,re=30,ue="...",Te=800,qe=16,y=1,E=2,X=3,ce=1/0,k=9007199254740991,U=17976931348623157e292,z=0/0,H=4294967295,Je=H-1,He=H>>>1,$r=[["ary",j],["bind",ie],["bindKey",Ee],["curry",pe],["curryRight",he],["flip",ye],["partial",le],["partialRight",T],["rearg",B]],xe="[object Arguments]",It="[object Array]",R="[object AsyncFunction]",O="[object Boolean]",P="[object Date]",c="[object DOMException]",b="[object Error]",ee="[object Function]",fe="[object GeneratorFunction]",we="[object Map]",Ne="[object Number]",Fe="[object Null]",Pe="[object Object]",St="[object Promise]",mt="[object Proxy]",nt="[object RegExp]",$e="[object Set]",Xe="[object String]",Ze="[object Symbol]",ot="[object Undefined]",ze="[object WeakMap]",Qe="[object WeakSet]",De="[object ArrayBuffer]",Be="[object DataView]",ut="[object Float32Array]",je="[object Float64Array]",Pt="[object Int8Array]",Lt="[object Int16Array]",zt="[object Int32Array]",kt="[object Uint8Array]",jt="[object Uint8ClampedArray]",Gt="[object Uint16Array]",tr="[object Uint32Array]",Mr=/\b__p \+= '';/g,Wt=/\b(__p \+=) '' \+/g,Vr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,oi=/&(?:amp|lt|gt|quot|#39);/g,xi=/[&<>"']/g,ht=RegExp(oi.source),rt=RegExp(xi.source),lt=/<%-([\s\S]+?)%>/g,ft=/<%([\s\S]+?)%>/g,at=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,At=/^\w*$/,Ct=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pt=/[\\^$.*+?()[\]{}|]/g,Ot=RegExp(pt.source),dt=/^\s+/,_t=/\s/,gt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ye=/\{\n\/\* \[wrapped with (.+)\] \*/,Rt=/,? & /,Tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,yo=/[()=,{}\[\]\/\s]/,vo=/\\(\\)?/g,mo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,gr=/\w*$/,_o=/^[-+]0x[0-9a-f]+$/i,wo=/^0b[01]+$/i,bo=/^\[object .+?Constructor\]$/,Eo=/^0o[0-7]+$/i,xo=/^(?:0|[1-9]\d*)$/,Kr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,zi=/($^)/,Io=/['\n\r\u2028\u2029\\]/g,ki="\\ud800-\\udfff",So="\\u0300-\\u036f",Po="\\ufe20-\\ufe2f",Hi="\\u20d0-\\u20ff",Gs=So+Po+Hi,Ws="\\u2700-\\u27bf",Cr="a-z\\xdf-\\xf6\\xf8-\\xff",Ao="\\xac\\xb1\\xd7\\xf7",Co="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Oo="\\u2000-\\u206f",Ro=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Js="A-Z\\xc0-\\xd6\\xd8-\\xde",Ys="\\ufe0e\\ufe0f",Ii=Ao+Co+Oo+Ro,ps="[']",Si="["+ki+"]",ds="["+Ii+"]",Pi="["+Gs+"]",Xs="\\d+",To="["+Ws+"]",Zs="["+Cr+"]",Qs="[^"+ki+Ii+Xs+Ws+Cr+Js+"]",Bi="\\ud83c[\\udffb-\\udfff]",No="(?:"+Pi+"|"+Bi+")",en="[^"+ki+"]",Vi="(?:\\ud83c[\\udde6-\\uddff]){2}",ai="[\\ud800-\\udbff][\\udc00-\\udfff]",ur="["+Js+"]",tn="\\u200d",rn="(?:"+Zs+"|"+Qs+")",jr="(?:"+ur+"|"+Qs+")",sn="(?:"+ps+"(?:d|ll|m|re|s|t|ve))?",nn="(?:"+ps+"(?:D|LL|M|RE|S|T|VE))?",on=No+"?",an="["+Ys+"]?",Do="(?:"+tn+"(?:"+[en,Vi,ai].join("|")+")"+an+on+")*",Gr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",cn="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",un=an+on+Do,Ki="(?:"+[To,Vi,ai].join("|")+")"+un,Fo="(?:"+[en+Pi+"?",Pi,Vi,ai,Si].join("|")+")",gs=RegExp(ps,"g"),Lo=RegExp(Pi,"g"),Gi=RegExp(Bi+"(?="+Bi+")|"+Fo+un,"g"),hn=RegExp([ur+"?"+Zs+"+"+sn+"(?="+[ds,ur,"$"].join("|")+")",jr+"+"+nn+"(?="+[ds,ur+rn,"$"].join("|")+")",ur+"?"+rn+"+"+sn,ur+"+"+nn,cn,Gr,Xs,Ki].join("|"),"g"),ln=RegExp("["+tn+ki+Gs+Ys+"]"),Ai=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,fn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],$o=-1,Ve={};Ve[ut]=Ve[je]=Ve[Pt]=Ve[Lt]=Ve[zt]=Ve[kt]=Ve[jt]=Ve[Gt]=Ve[tr]=!0,Ve[xe]=Ve[It]=Ve[De]=Ve[O]=Ve[Be]=Ve[P]=Ve[b]=Ve[ee]=Ve[we]=Ve[Ne]=Ve[Pe]=Ve[nt]=Ve[$e]=Ve[Xe]=Ve[ze]=!1;var ke={};ke[xe]=ke[It]=ke[De]=ke[Be]=ke[O]=ke[P]=ke[ut]=ke[je]=ke[Pt]=ke[Lt]=ke[zt]=ke[we]=ke[Ne]=ke[Pe]=ke[nt]=ke[$e]=ke[Xe]=ke[Ze]=ke[kt]=ke[jt]=ke[Gt]=ke[tr]=!0,ke[b]=ke[ee]=ke[ze]=!1;var g={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},x={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Y={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ke=parseFloat,ve=parseInt,et=typeof zs=="object"&&zs&&zs.Object===Object&&zs,Nt=typeof self=="object"&&self&&self.Object===Object&&self,Ce=et||Nt||Function("return this")(),Ge=i&&!i.nodeType&&i,wt=Ge&&!0&&u&&!u.nodeType&&u,rr=wt&&wt.exports===Ge,Dt=rr&&et.process,tt=function(){try{var I=wt&&wt.require&&wt.require("util").types;return I||Dt&&Dt.binding&&Dt.binding("util")}catch{}}(),Jt=tt&&tt.isArrayBuffer,Or=tt&&tt.isDate,yr=tt&&tt.isMap,Ur=tt&&tt.isRegExp,ys=tt&&tt.isSet,Ci=tt&&tt.isTypedArray;function Ut(I,N,C){switch(C.length){case 0:return I.call(N);case 1:return I.call(N,C[0]);case 2:return I.call(N,C[0],C[1]);case 3:return I.call(N,C[0],C[1],C[2])}return I.apply(N,C)}function Ef(I,N,C,Z){for(var de=-1,Le=I==null?0:I.length;++de<Le;){var $t=I[de];N(Z,$t,C($t),I)}return Z}function vr(I,N){for(var C=-1,Z=I==null?0:I.length;++C<Z&&N(I[C],C,I)!==!1;);return I}function xf(I,N){for(var C=I==null?0:I.length;C--&&N(I[C],C,I)!==!1;);return I}function Ic(I,N){for(var C=-1,Z=I==null?0:I.length;++C<Z;)if(!N(I[C],C,I))return!1;return!0}function ci(I,N){for(var C=-1,Z=I==null?0:I.length,de=0,Le=[];++C<Z;){var $t=I[C];N($t,C,I)&&(Le[de++]=$t)}return Le}function pn(I,N){var C=I==null?0:I.length;return!!C&&Wi(I,N,0)>-1}function Mo(I,N,C){for(var Z=-1,de=I==null?0:I.length;++Z<de;)if(C(N,I[Z]))return!0;return!1}function st(I,N){for(var C=-1,Z=I==null?0:I.length,de=Array(Z);++C<Z;)de[C]=N(I[C],C,I);return de}function ui(I,N){for(var C=-1,Z=N.length,de=I.length;++C<Z;)I[de+C]=N[C];return I}function jo(I,N,C,Z){var de=-1,Le=I==null?0:I.length;for(Z&&Le&&(C=I[++de]);++de<Le;)C=N(C,I[de],de,I);return C}function If(I,N,C,Z){var de=I==null?0:I.length;for(Z&&de&&(C=I[--de]);de--;)C=N(C,I[de],de,I);return C}function Uo(I,N){for(var C=-1,Z=I==null?0:I.length;++C<Z;)if(N(I[C],C,I))return!0;return!1}var Sf=qo("length");function Pf(I){return I.split("")}function Af(I){return I.match(Tt)||[]}function Sc(I,N,C){var Z;return C(I,function(de,Le,$t){if(N(de,Le,$t))return Z=Le,!1}),Z}function dn(I,N,C,Z){for(var de=I.length,Le=C+(Z?1:-1);Z?Le--:++Le<de;)if(N(I[Le],Le,I))return Le;return-1}function Wi(I,N,C){return N===N?Uf(I,N,C):dn(I,Pc,C)}function Cf(I,N,C,Z){for(var de=C-1,Le=I.length;++de<Le;)if(Z(I[de],N))return de;return-1}function Pc(I){return I!==I}function Ac(I,N){var C=I==null?0:I.length;return C?ko(I,N)/C:z}function qo(I){return function(N){return N==null?r:N[I]}}function zo(I){return function(N){return I==null?r:I[N]}}function Cc(I,N,C,Z,de){return de(I,function(Le,$t,We){C=Z?(Z=!1,Le):N(C,Le,$t,We)}),C}function Of(I,N){var C=I.length;for(I.sort(N);C--;)I[C]=I[C].value;return I}function ko(I,N){for(var C,Z=-1,de=I.length;++Z<de;){var Le=N(I[Z]);Le!==r&&(C=C===r?Le:C+Le)}return C}function Ho(I,N){for(var C=-1,Z=Array(I);++C<I;)Z[C]=N(C);return Z}function Rf(I,N){return st(N,function(C){return[C,I[C]]})}function Oc(I){return I&&I.slice(0,Dc(I)+1).replace(dt,"")}function hr(I){return function(N){return I(N)}}function Bo(I,N){return st(N,function(C){return I[C]})}function vs(I,N){return I.has(N)}function Rc(I,N){for(var C=-1,Z=I.length;++C<Z&&Wi(N,I[C],0)>-1;);return C}function Tc(I,N){for(var C=I.length;C--&&Wi(N,I[C],0)>-1;);return C}function Tf(I,N){for(var C=I.length,Z=0;C--;)I[C]===N&&++Z;return Z}var Nf=zo(g),Df=zo(x);function Ff(I){return"\\"+Y[I]}function Lf(I,N){return I==null?r:I[N]}function Ji(I){return ln.test(I)}function $f(I){return Ai.test(I)}function Mf(I){for(var N,C=[];!(N=I.next()).done;)C.push(N.value);return C}function Vo(I){var N=-1,C=Array(I.size);return I.forEach(function(Z,de){C[++N]=[de,Z]}),C}function Nc(I,N){return function(C){return I(N(C))}}function hi(I,N){for(var C=-1,Z=I.length,de=0,Le=[];++C<Z;){var $t=I[C];($t===N||$t===L)&&(I[C]=L,Le[de++]=C)}return Le}function gn(I){var N=-1,C=Array(I.size);return I.forEach(function(Z){C[++N]=Z}),C}function jf(I){var N=-1,C=Array(I.size);return I.forEach(function(Z){C[++N]=[Z,Z]}),C}function Uf(I,N,C){for(var Z=C-1,de=I.length;++Z<de;)if(I[Z]===N)return Z;return-1}function qf(I,N,C){for(var Z=C+1;Z--;)if(I[Z]===N)return Z;return Z}function Yi(I){return Ji(I)?kf(I):Sf(I)}function Rr(I){return Ji(I)?Hf(I):Pf(I)}function Dc(I){for(var N=I.length;N--&&_t.test(I.charAt(N)););return N}var zf=zo($);function kf(I){for(var N=Gi.lastIndex=0;Gi.test(I);)++N;return N}function Hf(I){return I.match(Gi)||[]}function Bf(I){return I.match(hn)||[]}var Vf=function I(N){N=N==null?Ce:Xi.defaults(Ce.Object(),N,Xi.pick(Ce,fn));var C=N.Array,Z=N.Date,de=N.Error,Le=N.Function,$t=N.Math,We=N.Object,Ko=N.RegExp,Kf=N.String,mr=N.TypeError,yn=C.prototype,Gf=Le.prototype,Zi=We.prototype,vn=N["__core-js_shared__"],mn=Gf.toString,Ue=Zi.hasOwnProperty,Wf=0,Fc=function(){var e=/[^.]+$/.exec(vn&&vn.keys&&vn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),_n=Zi.toString,Jf=mn.call(We),Yf=Ce._,Xf=Ko("^"+mn.call(Ue).replace(pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),wn=rr?N.Buffer:r,li=N.Symbol,bn=N.Uint8Array,Lc=wn?wn.allocUnsafe:r,En=Nc(We.getPrototypeOf,We),$c=We.create,Mc=Zi.propertyIsEnumerable,xn=yn.splice,jc=li?li.isConcatSpreadable:r,ms=li?li.iterator:r,Oi=li?li.toStringTag:r,In=function(){try{var e=Fi(We,"defineProperty");return e({},"",{}),e}catch{}}(),Zf=N.clearTimeout!==Ce.clearTimeout&&N.clearTimeout,Qf=Z&&Z.now!==Ce.Date.now&&Z.now,ep=N.setTimeout!==Ce.setTimeout&&N.setTimeout,Sn=$t.ceil,Pn=$t.floor,Go=We.getOwnPropertySymbols,tp=wn?wn.isBuffer:r,Uc=N.isFinite,rp=yn.join,ip=Nc(We.keys,We),Mt=$t.max,Vt=$t.min,sp=Z.now,np=N.parseInt,qc=$t.random,op=yn.reverse,Wo=Fi(N,"DataView"),_s=Fi(N,"Map"),Jo=Fi(N,"Promise"),Qi=Fi(N,"Set"),ws=Fi(N,"WeakMap"),bs=Fi(We,"create"),An=ws&&new ws,es={},ap=Li(Wo),cp=Li(_s),up=Li(Jo),hp=Li(Qi),lp=Li(ws),Cn=li?li.prototype:r,Es=Cn?Cn.valueOf:r,zc=Cn?Cn.toString:r;function f(e){if(yt(e)&&!me(e)&&!(e instanceof Ae)){if(e instanceof _r)return e;if(Ue.call(e,"__wrapped__"))return ku(e)}return new _r(e)}var ts=function(){function e(){}return function(t){if(!ct(t))return{};if($c)return $c(t);e.prototype=t;var s=new e;return e.prototype=r,s}}();function On(){}function _r(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=r}f.templateSettings={escape:lt,evaluate:ft,interpolate:at,variable:"",imports:{_:f}},f.prototype=On.prototype,f.prototype.constructor=f,_r.prototype=ts(On.prototype),_r.prototype.constructor=_r;function Ae(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=H,this.__views__=[]}function fp(){var e=new Ae(this.__wrapped__);return e.__actions__=ir(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ir(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ir(this.__views__),e}function pp(){if(this.__filtered__){var e=new Ae(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function dp(){var e=this.__wrapped__.value(),t=this.__dir__,s=me(e),a=t<0,h=s?e.length:0,p=Pd(0,h,this.__views__),m=p.start,_=p.end,S=_-m,D=a?_:m-1,F=this.__iteratees__,q=F.length,W=0,te=Vt(S,this.__takeCount__);if(!s||!a&&h==S&&te==S)return lu(e,this.__actions__);var oe=[];e:for(;S--&&W<te;){D+=t;for(var be=-1,ae=e[D];++be<q;){var Se=F[be],Oe=Se.iteratee,pr=Se.type,Zt=Oe(ae);if(pr==E)ae=Zt;else if(!Zt){if(pr==y)continue e;break e}}oe[W++]=ae}return oe}Ae.prototype=ts(On.prototype),Ae.prototype.constructor=Ae;function Ri(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function gp(){this.__data__=bs?bs(null):{},this.size=0}function yp(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function vp(e){var t=this.__data__;if(bs){var s=t[e];return s===w?r:s}return Ue.call(t,e)?t[e]:r}function mp(e){var t=this.__data__;return bs?t[e]!==r:Ue.call(t,e)}function _p(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=bs&&t===r?w:t,this}Ri.prototype.clear=gp,Ri.prototype.delete=yp,Ri.prototype.get=vp,Ri.prototype.has=mp,Ri.prototype.set=_p;function Wr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function wp(){this.__data__=[],this.size=0}function bp(e){var t=this.__data__,s=Rn(t,e);if(s<0)return!1;var a=t.length-1;return s==a?t.pop():xn.call(t,s,1),--this.size,!0}function Ep(e){var t=this.__data__,s=Rn(t,e);return s<0?r:t[s][1]}function xp(e){return Rn(this.__data__,e)>-1}function Ip(e,t){var s=this.__data__,a=Rn(s,e);return a<0?(++this.size,s.push([e,t])):s[a][1]=t,this}Wr.prototype.clear=wp,Wr.prototype.delete=bp,Wr.prototype.get=Ep,Wr.prototype.has=xp,Wr.prototype.set=Ip;function Jr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function Sp(){this.size=0,this.__data__={hash:new Ri,map:new(_s||Wr),string:new Ri}}function Pp(e){var t=kn(this,e).delete(e);return this.size-=t?1:0,t}function Ap(e){return kn(this,e).get(e)}function Cp(e){return kn(this,e).has(e)}function Op(e,t){var s=kn(this,e),a=s.size;return s.set(e,t),this.size+=s.size==a?0:1,this}Jr.prototype.clear=Sp,Jr.prototype.delete=Pp,Jr.prototype.get=Ap,Jr.prototype.has=Cp,Jr.prototype.set=Op;function Ti(e){var t=-1,s=e==null?0:e.length;for(this.__data__=new Jr;++t<s;)this.add(e[t])}function Rp(e){return this.__data__.set(e,w),this}function Tp(e){return this.__data__.has(e)}Ti.prototype.add=Ti.prototype.push=Rp,Ti.prototype.has=Tp;function Tr(e){var t=this.__data__=new Wr(e);this.size=t.size}function Np(){this.__data__=new Wr,this.size=0}function Dp(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}function Fp(e){return this.__data__.get(e)}function Lp(e){return this.__data__.has(e)}function $p(e,t){var s=this.__data__;if(s instanceof Wr){var a=s.__data__;if(!_s||a.length<o-1)return a.push([e,t]),this.size=++s.size,this;s=this.__data__=new Jr(a)}return s.set(e,t),this.size=s.size,this}Tr.prototype.clear=Np,Tr.prototype.delete=Dp,Tr.prototype.get=Fp,Tr.prototype.has=Lp,Tr.prototype.set=$p;function kc(e,t){var s=me(e),a=!s&&$i(e),h=!s&&!a&&yi(e),p=!s&&!a&&!h&&ns(e),m=s||a||h||p,_=m?Ho(e.length,Kf):[],S=_.length;for(var D in e)(t||Ue.call(e,D))&&!(m&&(D=="length"||h&&(D=="offset"||D=="parent")||p&&(D=="buffer"||D=="byteLength"||D=="byteOffset")||Qr(D,S)))&&_.push(D);return _}function Hc(e){var t=e.length;return t?e[oa(0,t-1)]:r}function Mp(e,t){return Hn(ir(e),Ni(t,0,e.length))}function jp(e){return Hn(ir(e))}function Yo(e,t,s){(s!==r&&!Nr(e[t],s)||s===r&&!(t in e))&&Yr(e,t,s)}function xs(e,t,s){var a=e[t];(!(Ue.call(e,t)&&Nr(a,s))||s===r&&!(t in e))&&Yr(e,t,s)}function Rn(e,t){for(var s=e.length;s--;)if(Nr(e[s][0],t))return s;return-1}function Up(e,t,s,a){return fi(e,function(h,p,m){t(a,h,s(h),m)}),a}function Bc(e,t){return e&&zr(t,qt(t),e)}function qp(e,t){return e&&zr(t,nr(t),e)}function Yr(e,t,s){t=="__proto__"&&In?In(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}function Xo(e,t){for(var s=-1,a=t.length,h=C(a),p=e==null;++s<a;)h[s]=p?r:Ta(e,t[s]);return h}function Ni(e,t,s){return e===e&&(s!==r&&(e=e<=s?e:s),t!==r&&(e=e>=t?e:t)),e}function wr(e,t,s,a,h,p){var m,_=t&K,S=t&J,D=t&G;if(s&&(m=h?s(e,a,h,p):s(e)),m!==r)return m;if(!ct(e))return e;var F=me(e);if(F){if(m=Cd(e),!_)return ir(e,m)}else{var q=Kt(e),W=q==ee||q==fe;if(yi(e))return du(e,_);if(q==Pe||q==xe||W&&!h){if(m=S||W?{}:Du(e),!_)return S?vd(e,qp(m,e)):yd(e,Bc(m,e))}else{if(!ke[q])return h?e:{};m=Od(e,q,_)}}p||(p=new Tr);var te=p.get(e);if(te)return te;p.set(e,m),ch(e)?e.forEach(function(ae){m.add(wr(ae,t,s,ae,e,p))}):oh(e)&&e.forEach(function(ae,Se){m.set(Se,wr(ae,t,s,Se,e,p))});var oe=D?S?va:ya:S?nr:qt,be=F?r:oe(e);return vr(be||e,function(ae,Se){be&&(Se=ae,ae=e[Se]),xs(m,Se,wr(ae,t,s,Se,e,p))}),m}function zp(e){var t=qt(e);return function(s){return Vc(s,e,t)}}function Vc(e,t,s){var a=s.length;if(e==null)return!a;for(e=We(e);a--;){var h=s[a],p=t[h],m=e[h];if(m===r&&!(h in e)||!p(m))return!1}return!0}function Kc(e,t,s){if(typeof e!="function")throw new mr(d);return Rs(function(){e.apply(r,s)},t)}function Is(e,t,s,a){var h=-1,p=pn,m=!0,_=e.length,S=[],D=t.length;if(!_)return S;s&&(t=st(t,hr(s))),a?(p=Mo,m=!1):t.length>=o&&(p=vs,m=!1,t=new Ti(t));e:for(;++h<_;){var F=e[h],q=s==null?F:s(F);if(F=a||F!==0?F:0,m&&q===q){for(var W=D;W--;)if(t[W]===q)continue e;S.push(F)}else p(t,q,a)||S.push(F)}return S}var fi=_u(qr),Gc=_u(Qo,!0);function kp(e,t){var s=!0;return fi(e,function(a,h,p){return s=!!t(a,h,p),s}),s}function Tn(e,t,s){for(var a=-1,h=e.length;++a<h;){var p=e[a],m=t(p);if(m!=null&&(_===r?m===m&&!fr(m):s(m,_)))var _=m,S=p}return S}function Hp(e,t,s,a){var h=e.length;for(s=_e(s),s<0&&(s=-s>h?0:h+s),a=a===r||a>h?h:_e(a),a<0&&(a+=h),a=s>a?0:hh(a);s<a;)e[s++]=t;return e}function Wc(e,t){var s=[];return fi(e,function(a,h,p){t(a,h,p)&&s.push(a)}),s}function Ht(e,t,s,a,h){var p=-1,m=e.length;for(s||(s=Td),h||(h=[]);++p<m;){var _=e[p];t>0&&s(_)?t>1?Ht(_,t-1,s,a,h):ui(h,_):a||(h[h.length]=_)}return h}var Zo=wu(),Jc=wu(!0);function qr(e,t){return e&&Zo(e,t,qt)}function Qo(e,t){return e&&Jc(e,t,qt)}function Nn(e,t){return ci(t,function(s){return ei(e[s])})}function Di(e,t){t=di(t,e);for(var s=0,a=t.length;e!=null&&s<a;)e=e[kr(t[s++])];return s&&s==a?e:r}function Yc(e,t,s){var a=t(e);return me(e)?a:ui(a,s(e))}function Yt(e){return e==null?e===r?ot:Fe:Oi&&Oi in We(e)?Sd(e):jd(e)}function ea(e,t){return e>t}function Bp(e,t){return e!=null&&Ue.call(e,t)}function Vp(e,t){return e!=null&&t in We(e)}function Kp(e,t,s){return e>=Vt(t,s)&&e<Mt(t,s)}function ta(e,t,s){for(var a=s?Mo:pn,h=e[0].length,p=e.length,m=p,_=C(p),S=1/0,D=[];m--;){var F=e[m];m&&t&&(F=st(F,hr(t))),S=Vt(F.length,S),_[m]=!s&&(t||h>=120&&F.length>=120)?new Ti(m&&F):r}F=e[0];var q=-1,W=_[0];e:for(;++q<h&&D.length<S;){var te=F[q],oe=t?t(te):te;if(te=s||te!==0?te:0,!(W?vs(W,oe):a(D,oe,s))){for(m=p;--m;){var be=_[m];if(!(be?vs(be,oe):a(e[m],oe,s)))continue e}W&&W.push(oe),D.push(te)}}return D}function Gp(e,t,s,a){return qr(e,function(h,p,m){t(a,s(h),p,m)}),a}function Ss(e,t,s){t=di(t,e),e=Mu(e,t);var a=e==null?e:e[kr(Er(t))];return a==null?r:Ut(a,e,s)}function Xc(e){return yt(e)&&Yt(e)==xe}function Wp(e){return yt(e)&&Yt(e)==De}function Jp(e){return yt(e)&&Yt(e)==P}function Ps(e,t,s,a,h){return e===t?!0:e==null||t==null||!yt(e)&&!yt(t)?e!==e&&t!==t:Yp(e,t,s,a,Ps,h)}function Yp(e,t,s,a,h,p){var m=me(e),_=me(t),S=m?It:Kt(e),D=_?It:Kt(t);S=S==xe?Pe:S,D=D==xe?Pe:D;var F=S==Pe,q=D==Pe,W=S==D;if(W&&yi(e)){if(!yi(t))return!1;m=!0,F=!1}if(W&&!F)return p||(p=new Tr),m||ns(e)?Ru(e,t,s,a,h,p):xd(e,t,S,s,a,h,p);if(!(s&M)){var te=F&&Ue.call(e,"__wrapped__"),oe=q&&Ue.call(t,"__wrapped__");if(te||oe){var be=te?e.value():e,ae=oe?t.value():t;return p||(p=new Tr),h(be,ae,s,a,p)}}return W?(p||(p=new Tr),Id(e,t,s,a,h,p)):!1}function Xp(e){return yt(e)&&Kt(e)==we}function ra(e,t,s,a){var h=s.length,p=h,m=!a;if(e==null)return!p;for(e=We(e);h--;){var _=s[h];if(m&&_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++h<p;){_=s[h];var S=_[0],D=e[S],F=_[1];if(m&&_[2]){if(D===r&&!(S in e))return!1}else{var q=new Tr;if(a)var W=a(D,F,S,e,t,q);if(!(W===r?Ps(F,D,M|V,a,q):W))return!1}}return!0}function Zc(e){if(!ct(e)||Dd(e))return!1;var t=ei(e)?Xf:bo;return t.test(Li(e))}function Zp(e){return yt(e)&&Yt(e)==nt}function Qp(e){return yt(e)&&Kt(e)==$e}function ed(e){return yt(e)&&Jn(e.length)&&!!Ve[Yt(e)]}function Qc(e){return typeof e=="function"?e:e==null?or:typeof e=="object"?me(e)?ru(e[0],e[1]):tu(e):bh(e)}function ia(e){if(!Os(e))return ip(e);var t=[];for(var s in We(e))Ue.call(e,s)&&s!="constructor"&&t.push(s);return t}function td(e){if(!ct(e))return Md(e);var t=Os(e),s=[];for(var a in e)a=="constructor"&&(t||!Ue.call(e,a))||s.push(a);return s}function sa(e,t){return e<t}function eu(e,t){var s=-1,a=sr(e)?C(e.length):[];return fi(e,function(h,p,m){a[++s]=t(h,p,m)}),a}function tu(e){var t=_a(e);return t.length==1&&t[0][2]?Lu(t[0][0],t[0][1]):function(s){return s===e||ra(s,e,t)}}function ru(e,t){return ba(e)&&Fu(t)?Lu(kr(e),t):function(s){var a=Ta(s,e);return a===r&&a===t?Na(s,e):Ps(t,a,M|V)}}function Dn(e,t,s,a,h){e!==t&&Zo(t,function(p,m){if(h||(h=new Tr),ct(p))rd(e,t,m,s,Dn,a,h);else{var _=a?a(xa(e,m),p,m+"",e,t,h):r;_===r&&(_=p),Yo(e,m,_)}},nr)}function rd(e,t,s,a,h,p,m){var _=xa(e,s),S=xa(t,s),D=m.get(S);if(D){Yo(e,s,D);return}var F=p?p(_,S,s+"",e,t,m):r,q=F===r;if(q){var W=me(S),te=!W&&yi(S),oe=!W&&!te&&ns(S);F=S,W||te||oe?me(_)?F=_:bt(_)?F=ir(_):te?(q=!1,F=du(S,!0)):oe?(q=!1,F=gu(S,!0)):F=[]:Ts(S)||$i(S)?(F=_,$i(_)?F=lh(_):(!ct(_)||ei(_))&&(F=Du(S))):q=!1}q&&(m.set(S,F),h(F,S,a,p,m),m.delete(S)),Yo(e,s,F)}function iu(e,t){var s=e.length;if(s)return t+=t<0?s:0,Qr(t,s)?e[t]:r}function su(e,t,s){t.length?t=st(t,function(p){return me(p)?function(m){return Di(m,p.length===1?p[0]:p)}:p}):t=[or];var a=-1;t=st(t,hr(se()));var h=eu(e,function(p,m,_){var S=st(t,function(D){return D(p)});return{criteria:S,index:++a,value:p}});return Of(h,function(p,m){return gd(p,m,s)})}function id(e,t){return nu(e,t,function(s,a){return Na(e,a)})}function nu(e,t,s){for(var a=-1,h=t.length,p={};++a<h;){var m=t[a],_=Di(e,m);s(_,m)&&As(p,di(m,e),_)}return p}function sd(e){return function(t){return Di(t,e)}}function na(e,t,s,a){var h=a?Cf:Wi,p=-1,m=t.length,_=e;for(e===t&&(t=ir(t)),s&&(_=st(e,hr(s)));++p<m;)for(var S=0,D=t[p],F=s?s(D):D;(S=h(_,F,S,a))>-1;)_!==e&&xn.call(_,S,1),xn.call(e,S,1);return e}function ou(e,t){for(var s=e?t.length:0,a=s-1;s--;){var h=t[s];if(s==a||h!==p){var p=h;Qr(h)?xn.call(e,h,1):ua(e,h)}}return e}function oa(e,t){return e+Pn(qc()*(t-e+1))}function nd(e,t,s,a){for(var h=-1,p=Mt(Sn((t-e)/(s||1)),0),m=C(p);p--;)m[a?p:++h]=e,e+=s;return m}function aa(e,t){var s="";if(!e||t<1||t>k)return s;do t%2&&(s+=e),t=Pn(t/2),t&&(e+=e);while(t);return s}function Ie(e,t){return Ia($u(e,t,or),e+"")}function od(e){return Hc(os(e))}function ad(e,t){var s=os(e);return Hn(s,Ni(t,0,s.length))}function As(e,t,s,a){if(!ct(e))return e;t=di(t,e);for(var h=-1,p=t.length,m=p-1,_=e;_!=null&&++h<p;){var S=kr(t[h]),D=s;if(S==="__proto__"||S==="constructor"||S==="prototype")return e;if(h!=m){var F=_[S];D=a?a(F,S,_):r,D===r&&(D=ct(F)?F:Qr(t[h+1])?[]:{})}xs(_,S,D),_=_[S]}return e}var au=An?function(e,t){return An.set(e,t),e}:or,cd=In?function(e,t){return In(e,"toString",{configurable:!0,enumerable:!1,value:Fa(t),writable:!0})}:or;function ud(e){return Hn(os(e))}function br(e,t,s){var a=-1,h=e.length;t<0&&(t=-t>h?0:h+t),s=s>h?h:s,s<0&&(s+=h),h=t>s?0:s-t>>>0,t>>>=0;for(var p=C(h);++a<h;)p[a]=e[a+t];return p}function hd(e,t){var s;return fi(e,function(a,h,p){return s=t(a,h,p),!s}),!!s}function Fn(e,t,s){var a=0,h=e==null?a:e.length;if(typeof t=="number"&&t===t&&h<=He){for(;a<h;){var p=a+h>>>1,m=e[p];m!==null&&!fr(m)&&(s?m<=t:m<t)?a=p+1:h=p}return h}return ca(e,t,or,s)}function ca(e,t,s,a){var h=0,p=e==null?0:e.length;if(p===0)return 0;t=s(t);for(var m=t!==t,_=t===null,S=fr(t),D=t===r;h<p;){var F=Pn((h+p)/2),q=s(e[F]),W=q!==r,te=q===null,oe=q===q,be=fr(q);if(m)var ae=a||oe;else D?ae=oe&&(a||W):_?ae=oe&&W&&(a||!te):S?ae=oe&&W&&!te&&(a||!be):te||be?ae=!1:ae=a?q<=t:q<t;ae?h=F+1:p=F}return Vt(p,Je)}function cu(e,t){for(var s=-1,a=e.length,h=0,p=[];++s<a;){var m=e[s],_=t?t(m):m;if(!s||!Nr(_,S)){var S=_;p[h++]=m===0?0:m}}return p}function uu(e){return typeof e=="number"?e:fr(e)?z:+e}function lr(e){if(typeof e=="string")return e;if(me(e))return st(e,lr)+"";if(fr(e))return zc?zc.call(e):"";var t=e+"";return t=="0"&&1/e==-ce?"-0":t}function pi(e,t,s){var a=-1,h=pn,p=e.length,m=!0,_=[],S=_;if(s)m=!1,h=Mo;else if(p>=o){var D=t?null:bd(e);if(D)return gn(D);m=!1,h=vs,S=new Ti}else S=t?[]:_;e:for(;++a<p;){var F=e[a],q=t?t(F):F;if(F=s||F!==0?F:0,m&&q===q){for(var W=S.length;W--;)if(S[W]===q)continue e;t&&S.push(q),_.push(F)}else h(S,q,s)||(S!==_&&S.push(q),_.push(F))}return _}function ua(e,t){return t=di(t,e),e=Mu(e,t),e==null||delete e[kr(Er(t))]}function hu(e,t,s,a){return As(e,t,s(Di(e,t)),a)}function Ln(e,t,s,a){for(var h=e.length,p=a?h:-1;(a?p--:++p<h)&&t(e[p],p,e););return s?br(e,a?0:p,a?p+1:h):br(e,a?p+1:0,a?h:p)}function lu(e,t){var s=e;return s instanceof Ae&&(s=s.value()),jo(t,function(a,h){return h.func.apply(h.thisArg,ui([a],h.args))},s)}function ha(e,t,s){var a=e.length;if(a<2)return a?pi(e[0]):[];for(var h=-1,p=C(a);++h<a;)for(var m=e[h],_=-1;++_<a;)_!=h&&(p[h]=Is(p[h]||m,e[_],t,s));return pi(Ht(p,1),t,s)}function fu(e,t,s){for(var a=-1,h=e.length,p=t.length,m={};++a<h;){var _=a<p?t[a]:r;s(m,e[a],_)}return m}function la(e){return bt(e)?e:[]}function fa(e){return typeof e=="function"?e:or}function di(e,t){return me(e)?e:ba(e,t)?[e]:zu(Me(e))}var ld=Ie;function gi(e,t,s){var a=e.length;return s=s===r?a:s,!t&&s>=a?e:br(e,t,s)}var pu=Zf||function(e){return Ce.clearTimeout(e)};function du(e,t){if(t)return e.slice();var s=e.length,a=Lc?Lc(s):new e.constructor(s);return e.copy(a),a}function pa(e){var t=new e.constructor(e.byteLength);return new bn(t).set(new bn(e)),t}function fd(e,t){var s=t?pa(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function pd(e){var t=new e.constructor(e.source,gr.exec(e));return t.lastIndex=e.lastIndex,t}function dd(e){return Es?We(Es.call(e)):{}}function gu(e,t){var s=t?pa(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function yu(e,t){if(e!==t){var s=e!==r,a=e===null,h=e===e,p=fr(e),m=t!==r,_=t===null,S=t===t,D=fr(t);if(!_&&!D&&!p&&e>t||p&&m&&S&&!_&&!D||a&&m&&S||!s&&S||!h)return 1;if(!a&&!p&&!D&&e<t||D&&s&&h&&!a&&!p||_&&s&&h||!m&&h||!S)return-1}return 0}function gd(e,t,s){for(var a=-1,h=e.criteria,p=t.criteria,m=h.length,_=s.length;++a<m;){var S=yu(h[a],p[a]);if(S){if(a>=_)return S;var D=s[a];return S*(D=="desc"?-1:1)}}return e.index-t.index}function vu(e,t,s,a){for(var h=-1,p=e.length,m=s.length,_=-1,S=t.length,D=Mt(p-m,0),F=C(S+D),q=!a;++_<S;)F[_]=t[_];for(;++h<m;)(q||h<p)&&(F[s[h]]=e[h]);for(;D--;)F[_++]=e[h++];return F}function mu(e,t,s,a){for(var h=-1,p=e.length,m=-1,_=s.length,S=-1,D=t.length,F=Mt(p-_,0),q=C(F+D),W=!a;++h<F;)q[h]=e[h];for(var te=h;++S<D;)q[te+S]=t[S];for(;++m<_;)(W||h<p)&&(q[te+s[m]]=e[h++]);return q}function ir(e,t){var s=-1,a=e.length;for(t||(t=C(a));++s<a;)t[s]=e[s];return t}function zr(e,t,s,a){var h=!s;s||(s={});for(var p=-1,m=t.length;++p<m;){var _=t[p],S=a?a(s[_],e[_],_,s,e):r;S===r&&(S=e[_]),h?Yr(s,_,S):xs(s,_,S)}return s}function yd(e,t){return zr(e,wa(e),t)}function vd(e,t){return zr(e,Tu(e),t)}function $n(e,t){return function(s,a){var h=me(s)?Ef:Up,p=t?t():{};return h(s,e,se(a,2),p)}}function rs(e){return Ie(function(t,s){var a=-1,h=s.length,p=h>1?s[h-1]:r,m=h>2?s[2]:r;for(p=e.length>3&&typeof p=="function"?(h--,p):r,m&&Xt(s[0],s[1],m)&&(p=h<3?r:p,h=1),t=We(t);++a<h;){var _=s[a];_&&e(t,_,a,p)}return t})}function _u(e,t){return function(s,a){if(s==null)return s;if(!sr(s))return e(s,a);for(var h=s.length,p=t?h:-1,m=We(s);(t?p--:++p<h)&&a(m[p],p,m)!==!1;);return s}}function wu(e){return function(t,s,a){for(var h=-1,p=We(t),m=a(t),_=m.length;_--;){var S=m[e?_:++h];if(s(p[S],S,p)===!1)break}return t}}function md(e,t,s){var a=t&ie,h=Cs(e);function p(){var m=this&&this!==Ce&&this instanceof p?h:e;return m.apply(a?s:this,arguments)}return p}function bu(e){return function(t){t=Me(t);var s=Ji(t)?Rr(t):r,a=s?s[0]:t.charAt(0),h=s?gi(s,1).join(""):t.slice(1);return a[e]()+h}}function is(e){return function(t){return jo(_h(mh(t).replace(gs,"")),e,"")}}function Cs(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var s=ts(e.prototype),a=e.apply(s,t);return ct(a)?a:s}}function _d(e,t,s){var a=Cs(e);function h(){for(var p=arguments.length,m=C(p),_=p,S=ss(h);_--;)m[_]=arguments[_];var D=p<3&&m[0]!==S&&m[p-1]!==S?[]:hi(m,S);if(p-=D.length,p<s)return Pu(e,t,Mn,h.placeholder,r,m,D,r,r,s-p);var F=this&&this!==Ce&&this instanceof h?a:e;return Ut(F,this,m)}return h}function Eu(e){return function(t,s,a){var h=We(t);if(!sr(t)){var p=se(s,3);t=qt(t),s=function(_){return p(h[_],_,h)}}var m=e(t,s,a);return m>-1?h[p?t[m]:m]:r}}function xu(e){return Zr(function(t){var s=t.length,a=s,h=_r.prototype.thru;for(e&&t.reverse();a--;){var p=t[a];if(typeof p!="function")throw new mr(d);if(h&&!m&&zn(p)=="wrapper")var m=new _r([],!0)}for(a=m?a:s;++a<s;){p=t[a];var _=zn(p),S=_=="wrapper"?ma(p):r;S&&Ea(S[0])&&S[1]==(j|pe|le|B)&&!S[4].length&&S[9]==1?m=m[zn(S[0])].apply(m,S[3]):m=p.length==1&&Ea(p)?m[_]():m.thru(p)}return function(){var D=arguments,F=D[0];if(m&&D.length==1&&me(F))return m.plant(F).value();for(var q=0,W=s?t[q].apply(this,D):F;++q<s;)W=t[q].call(this,W);return W}})}function Mn(e,t,s,a,h,p,m,_,S,D){var F=t&j,q=t&ie,W=t&Ee,te=t&(pe|he),oe=t&ye,be=W?r:Cs(e);function ae(){for(var Se=arguments.length,Oe=C(Se),pr=Se;pr--;)Oe[pr]=arguments[pr];if(te)var Zt=ss(ae),dr=Tf(Oe,Zt);if(a&&(Oe=vu(Oe,a,h,te)),p&&(Oe=mu(Oe,p,m,te)),Se-=dr,te&&Se<D){var Et=hi(Oe,Zt);return Pu(e,t,Mn,ae.placeholder,s,Oe,Et,_,S,D-Se)}var Dr=q?s:this,ri=W?Dr[e]:e;return Se=Oe.length,_?Oe=Ud(Oe,_):oe&&Se>1&&Oe.reverse(),F&&S<Se&&(Oe.length=S),this&&this!==Ce&&this instanceof ae&&(ri=be||Cs(ri)),ri.apply(Dr,Oe)}return ae}function Iu(e,t){return function(s,a){return Gp(s,e,t(a),{})}}function jn(e,t){return function(s,a){var h;if(s===r&&a===r)return t;if(s!==r&&(h=s),a!==r){if(h===r)return a;typeof s=="string"||typeof a=="string"?(s=lr(s),a=lr(a)):(s=uu(s),a=uu(a)),h=e(s,a)}return h}}function da(e){return Zr(function(t){return t=st(t,hr(se())),Ie(function(s){var a=this;return e(t,function(h){return Ut(h,a,s)})})})}function Un(e,t){t=t===r?" ":lr(t);var s=t.length;if(s<2)return s?aa(t,e):t;var a=aa(t,Sn(e/Yi(t)));return Ji(t)?gi(Rr(a),0,e).join(""):a.slice(0,e)}function wd(e,t,s,a){var h=t&ie,p=Cs(e);function m(){for(var _=-1,S=arguments.length,D=-1,F=a.length,q=C(F+S),W=this&&this!==Ce&&this instanceof m?p:e;++D<F;)q[D]=a[D];for(;S--;)q[D++]=arguments[++_];return Ut(W,h?s:this,q)}return m}function Su(e){return function(t,s,a){return a&&typeof a!="number"&&Xt(t,s,a)&&(s=a=r),t=ti(t),s===r?(s=t,t=0):s=ti(s),a=a===r?t<s?1:-1:ti(a),nd(t,s,a,e)}}function qn(e){return function(t,s){return typeof t=="string"&&typeof s=="string"||(t=xr(t),s=xr(s)),e(t,s)}}function Pu(e,t,s,a,h,p,m,_,S,D){var F=t&pe,q=F?m:r,W=F?r:m,te=F?p:r,oe=F?r:p;t|=F?le:T,t&=~(F?T:le),t&ge||(t&=~(ie|Ee));var be=[e,t,h,te,q,oe,W,_,S,D],ae=s.apply(r,be);return Ea(e)&&ju(ae,be),ae.placeholder=a,Uu(ae,e,t)}function ga(e){var t=$t[e];return function(s,a){if(s=xr(s),a=a==null?0:Vt(_e(a),292),a&&Uc(s)){var h=(Me(s)+"e").split("e"),p=t(h[0]+"e"+(+h[1]+a));return h=(Me(p)+"e").split("e"),+(h[0]+"e"+(+h[1]-a))}return t(s)}}var bd=Qi&&1/gn(new Qi([,-0]))[1]==ce?function(e){return new Qi(e)}:Ma;function Au(e){return function(t){var s=Kt(t);return s==we?Vo(t):s==$e?jf(t):Rf(t,e(t))}}function Xr(e,t,s,a,h,p,m,_){var S=t&Ee;if(!S&&typeof e!="function")throw new mr(d);var D=a?a.length:0;if(D||(t&=~(le|T),a=h=r),m=m===r?m:Mt(_e(m),0),_=_===r?_:_e(_),D-=h?h.length:0,t&T){var F=a,q=h;a=h=r}var W=S?r:ma(e),te=[e,t,s,a,h,F,q,p,m,_];if(W&&$d(te,W),e=te[0],t=te[1],s=te[2],a=te[3],h=te[4],_=te[9]=te[9]===r?S?0:e.length:Mt(te[9]-D,0),!_&&t&(pe|he)&&(t&=~(pe|he)),!t||t==ie)var oe=md(e,t,s);else t==pe||t==he?oe=_d(e,t,_):(t==le||t==(ie|le))&&!h.length?oe=wd(e,t,s,a):oe=Mn.apply(r,te);var be=W?au:ju;return Uu(be(oe,te),e,t)}function Cu(e,t,s,a){return e===r||Nr(e,Zi[s])&&!Ue.call(a,s)?t:e}function Ou(e,t,s,a,h,p){return ct(e)&&ct(t)&&(p.set(t,e),Dn(e,t,r,Ou,p),p.delete(t)),e}function Ed(e){return Ts(e)?r:e}function Ru(e,t,s,a,h,p){var m=s&M,_=e.length,S=t.length;if(_!=S&&!(m&&S>_))return!1;var D=p.get(e),F=p.get(t);if(D&&F)return D==t&&F==e;var q=-1,W=!0,te=s&V?new Ti:r;for(p.set(e,t),p.set(t,e);++q<_;){var oe=e[q],be=t[q];if(a)var ae=m?a(be,oe,q,t,e,p):a(oe,be,q,e,t,p);if(ae!==r){if(ae)continue;W=!1;break}if(te){if(!Uo(t,function(Se,Oe){if(!vs(te,Oe)&&(oe===Se||h(oe,Se,s,a,p)))return te.push(Oe)})){W=!1;break}}else if(!(oe===be||h(oe,be,s,a,p))){W=!1;break}}return p.delete(e),p.delete(t),W}function xd(e,t,s,a,h,p,m){switch(s){case Be:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case De:return!(e.byteLength!=t.byteLength||!p(new bn(e),new bn(t)));case O:case P:case Ne:return Nr(+e,+t);case b:return e.name==t.name&&e.message==t.message;case nt:case Xe:return e==t+"";case we:var _=Vo;case $e:var S=a&M;if(_||(_=gn),e.size!=t.size&&!S)return!1;var D=m.get(e);if(D)return D==t;a|=V,m.set(e,t);var F=Ru(_(e),_(t),a,h,p,m);return m.delete(e),F;case Ze:if(Es)return Es.call(e)==Es.call(t)}return!1}function Id(e,t,s,a,h,p){var m=s&M,_=ya(e),S=_.length,D=ya(t),F=D.length;if(S!=F&&!m)return!1;for(var q=S;q--;){var W=_[q];if(!(m?W in t:Ue.call(t,W)))return!1}var te=p.get(e),oe=p.get(t);if(te&&oe)return te==t&&oe==e;var be=!0;p.set(e,t),p.set(t,e);for(var ae=m;++q<S;){W=_[q];var Se=e[W],Oe=t[W];if(a)var pr=m?a(Oe,Se,W,t,e,p):a(Se,Oe,W,e,t,p);if(!(pr===r?Se===Oe||h(Se,Oe,s,a,p):pr)){be=!1;break}ae||(ae=W=="constructor")}if(be&&!ae){var Zt=e.constructor,dr=t.constructor;Zt!=dr&&"constructor"in e&&"constructor"in t&&!(typeof Zt=="function"&&Zt instanceof Zt&&typeof dr=="function"&&dr instanceof dr)&&(be=!1)}return p.delete(e),p.delete(t),be}function Zr(e){return Ia($u(e,r,Vu),e+"")}function ya(e){return Yc(e,qt,wa)}function va(e){return Yc(e,nr,Tu)}var ma=An?function(e){return An.get(e)}:Ma;function zn(e){for(var t=e.name+"",s=es[t],a=Ue.call(es,t)?s.length:0;a--;){var h=s[a],p=h.func;if(p==null||p==e)return h.name}return t}function ss(e){var t=Ue.call(f,"placeholder")?f:e;return t.placeholder}function se(){var e=f.iteratee||La;return e=e===La?Qc:e,arguments.length?e(arguments[0],arguments[1]):e}function kn(e,t){var s=e.__data__;return Nd(t)?s[typeof t=="string"?"string":"hash"]:s.map}function _a(e){for(var t=qt(e),s=t.length;s--;){var a=t[s],h=e[a];t[s]=[a,h,Fu(h)]}return t}function Fi(e,t){var s=Lf(e,t);return Zc(s)?s:r}function Sd(e){var t=Ue.call(e,Oi),s=e[Oi];try{e[Oi]=r;var a=!0}catch{}var h=_n.call(e);return a&&(t?e[Oi]=s:delete e[Oi]),h}var wa=Go?function(e){return e==null?[]:(e=We(e),ci(Go(e),function(t){return Mc.call(e,t)}))}:ja,Tu=Go?function(e){for(var t=[];e;)ui(t,wa(e)),e=En(e);return t}:ja,Kt=Yt;(Wo&&Kt(new Wo(new ArrayBuffer(1)))!=Be||_s&&Kt(new _s)!=we||Jo&&Kt(Jo.resolve())!=St||Qi&&Kt(new Qi)!=$e||ws&&Kt(new ws)!=ze)&&(Kt=function(e){var t=Yt(e),s=t==Pe?e.constructor:r,a=s?Li(s):"";if(a)switch(a){case ap:return Be;case cp:return we;case up:return St;case hp:return $e;case lp:return ze}return t});function Pd(e,t,s){for(var a=-1,h=s.length;++a<h;){var p=s[a],m=p.size;switch(p.type){case"drop":e+=m;break;case"dropRight":t-=m;break;case"take":t=Vt(t,e+m);break;case"takeRight":e=Mt(e,t-m);break}}return{start:e,end:t}}function Ad(e){var t=e.match(Ye);return t?t[1].split(Rt):[]}function Nu(e,t,s){t=di(t,e);for(var a=-1,h=t.length,p=!1;++a<h;){var m=kr(t[a]);if(!(p=e!=null&&s(e,m)))break;e=e[m]}return p||++a!=h?p:(h=e==null?0:e.length,!!h&&Jn(h)&&Qr(m,h)&&(me(e)||$i(e)))}function Cd(e){var t=e.length,s=new e.constructor(t);return t&&typeof e[0]=="string"&&Ue.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function Du(e){return typeof e.constructor=="function"&&!Os(e)?ts(En(e)):{}}function Od(e,t,s){var a=e.constructor;switch(t){case De:return pa(e);case O:case P:return new a(+e);case Be:return fd(e,s);case ut:case je:case Pt:case Lt:case zt:case kt:case jt:case Gt:case tr:return gu(e,s);case we:return new a;case Ne:case Xe:return new a(e);case nt:return pd(e);case $e:return new a;case Ze:return dd(e)}}function Rd(e,t){var s=t.length;if(!s)return e;var a=s-1;return t[a]=(s>1?"& ":"")+t[a],t=t.join(s>2?", ":" "),e.replace(gt,`{
/* [wrapped with `+t+`] */
`)}function Td(e){return me(e)||$i(e)||!!(jc&&e&&e[jc])}function Qr(e,t){var s=typeof e;return t=t??k,!!t&&(s=="number"||s!="symbol"&&xo.test(e))&&e>-1&&e%1==0&&e<t}function Xt(e,t,s){if(!ct(s))return!1;var a=typeof t;return(a=="number"?sr(s)&&Qr(t,s.length):a=="string"&&t in s)?Nr(s[t],e):!1}function ba(e,t){if(me(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||fr(e)?!0:At.test(e)||!it.test(e)||t!=null&&e in We(t)}function Nd(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Ea(e){var t=zn(e),s=f[t];if(typeof s!="function"||!(t in Ae.prototype))return!1;if(e===s)return!0;var a=ma(s);return!!a&&e===a[0]}function Dd(e){return!!Fc&&Fc in e}var Fd=vn?ei:Ua;function Os(e){var t=e&&e.constructor,s=typeof t=="function"&&t.prototype||Zi;return e===s}function Fu(e){return e===e&&!ct(e)}function Lu(e,t){return function(s){return s==null?!1:s[e]===t&&(t!==r||e in We(s))}}function Ld(e){var t=Gn(e,function(a){return s.size===A&&s.clear(),a}),s=t.cache;return t}function $d(e,t){var s=e[1],a=t[1],h=s|a,p=h<(ie|Ee|j),m=a==j&&s==pe||a==j&&s==B&&e[7].length<=t[8]||a==(j|B)&&t[7].length<=t[8]&&s==pe;if(!(p||m))return e;a&ie&&(e[2]=t[2],h|=s&ie?0:ge);var _=t[3];if(_){var S=e[3];e[3]=S?vu(S,_,t[4]):_,e[4]=S?hi(e[3],L):t[4]}return _=t[5],_&&(S=e[5],e[5]=S?mu(S,_,t[6]):_,e[6]=S?hi(e[5],L):t[6]),_=t[7],_&&(e[7]=_),a&j&&(e[8]=e[8]==null?t[8]:Vt(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=h,e}function Md(e){var t=[];if(e!=null)for(var s in We(e))t.push(s);return t}function jd(e){return _n.call(e)}function $u(e,t,s){return t=Mt(t===r?e.length-1:t,0),function(){for(var a=arguments,h=-1,p=Mt(a.length-t,0),m=C(p);++h<p;)m[h]=a[t+h];h=-1;for(var _=C(t+1);++h<t;)_[h]=a[h];return _[t]=s(m),Ut(e,this,_)}}function Mu(e,t){return t.length<2?e:Di(e,br(t,0,-1))}function Ud(e,t){for(var s=e.length,a=Vt(t.length,s),h=ir(e);a--;){var p=t[a];e[a]=Qr(p,s)?h[p]:r}return e}function xa(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var ju=qu(au),Rs=ep||function(e,t){return Ce.setTimeout(e,t)},Ia=qu(cd);function Uu(e,t,s){var a=t+"";return Ia(e,Rd(a,qd(Ad(a),s)))}function qu(e){var t=0,s=0;return function(){var a=sp(),h=qe-(a-s);if(s=a,h>0){if(++t>=Te)return arguments[0]}else t=0;return e.apply(r,arguments)}}function Hn(e,t){var s=-1,a=e.length,h=a-1;for(t=t===r?a:t;++s<t;){var p=oa(s,h),m=e[p];e[p]=e[s],e[s]=m}return e.length=t,e}var zu=Ld(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ct,function(s,a,h,p){t.push(h?p.replace(vo,"$1"):a||s)}),t});function kr(e){if(typeof e=="string"||fr(e))return e;var t=e+"";return t=="0"&&1/e==-ce?"-0":t}function Li(e){if(e!=null){try{return mn.call(e)}catch{}try{return e+""}catch{}}return""}function qd(e,t){return vr($r,function(s){var a="_."+s[0];t&s[1]&&!pn(e,a)&&e.push(a)}),e.sort()}function ku(e){if(e instanceof Ae)return e.clone();var t=new _r(e.__wrapped__,e.__chain__);return t.__actions__=ir(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function zd(e,t,s){(s?Xt(e,t,s):t===r)?t=1:t=Mt(_e(t),0);var a=e==null?0:e.length;if(!a||t<1)return[];for(var h=0,p=0,m=C(Sn(a/t));h<a;)m[p++]=br(e,h,h+=t);return m}function kd(e){for(var t=-1,s=e==null?0:e.length,a=0,h=[];++t<s;){var p=e[t];p&&(h[a++]=p)}return h}function Hd(){var e=arguments.length;if(!e)return[];for(var t=C(e-1),s=arguments[0],a=e;a--;)t[a-1]=arguments[a];return ui(me(s)?ir(s):[s],Ht(t,1))}var Bd=Ie(function(e,t){return bt(e)?Is(e,Ht(t,1,bt,!0)):[]}),Vd=Ie(function(e,t){var s=Er(t);return bt(s)&&(s=r),bt(e)?Is(e,Ht(t,1,bt,!0),se(s,2)):[]}),Kd=Ie(function(e,t){var s=Er(t);return bt(s)&&(s=r),bt(e)?Is(e,Ht(t,1,bt,!0),r,s):[]});function Gd(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===r?1:_e(t),br(e,t<0?0:t,a)):[]}function Wd(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===r?1:_e(t),t=a-t,br(e,0,t<0?0:t)):[]}function Jd(e,t){return e&&e.length?Ln(e,se(t,3),!0,!0):[]}function Yd(e,t){return e&&e.length?Ln(e,se(t,3),!0):[]}function Xd(e,t,s,a){var h=e==null?0:e.length;return h?(s&&typeof s!="number"&&Xt(e,t,s)&&(s=0,a=h),Hp(e,t,s,a)):[]}function Hu(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var h=s==null?0:_e(s);return h<0&&(h=Mt(a+h,0)),dn(e,se(t,3),h)}function Bu(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var h=a-1;return s!==r&&(h=_e(s),h=s<0?Mt(a+h,0):Vt(h,a-1)),dn(e,se(t,3),h,!0)}function Vu(e){var t=e==null?0:e.length;return t?Ht(e,1):[]}function Zd(e){var t=e==null?0:e.length;return t?Ht(e,ce):[]}function Qd(e,t){var s=e==null?0:e.length;return s?(t=t===r?1:_e(t),Ht(e,t)):[]}function eg(e){for(var t=-1,s=e==null?0:e.length,a={};++t<s;){var h=e[t];a[h[0]]=h[1]}return a}function Ku(e){return e&&e.length?e[0]:r}function tg(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var h=s==null?0:_e(s);return h<0&&(h=Mt(a+h,0)),Wi(e,t,h)}function rg(e){var t=e==null?0:e.length;return t?br(e,0,-1):[]}var ig=Ie(function(e){var t=st(e,la);return t.length&&t[0]===e[0]?ta(t):[]}),sg=Ie(function(e){var t=Er(e),s=st(e,la);return t===Er(s)?t=r:s.pop(),s.length&&s[0]===e[0]?ta(s,se(t,2)):[]}),ng=Ie(function(e){var t=Er(e),s=st(e,la);return t=typeof t=="function"?t:r,t&&s.pop(),s.length&&s[0]===e[0]?ta(s,r,t):[]});function og(e,t){return e==null?"":rp.call(e,t)}function Er(e){var t=e==null?0:e.length;return t?e[t-1]:r}function ag(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var h=a;return s!==r&&(h=_e(s),h=h<0?Mt(a+h,0):Vt(h,a-1)),t===t?qf(e,t,h):dn(e,Pc,h,!0)}function cg(e,t){return e&&e.length?iu(e,_e(t)):r}var ug=Ie(Gu);function Gu(e,t){return e&&e.length&&t&&t.length?na(e,t):e}function hg(e,t,s){return e&&e.length&&t&&t.length?na(e,t,se(s,2)):e}function lg(e,t,s){return e&&e.length&&t&&t.length?na(e,t,r,s):e}var fg=Zr(function(e,t){var s=e==null?0:e.length,a=Xo(e,t);return ou(e,st(t,function(h){return Qr(h,s)?+h:h}).sort(yu)),a});function pg(e,t){var s=[];if(!(e&&e.length))return s;var a=-1,h=[],p=e.length;for(t=se(t,3);++a<p;){var m=e[a];t(m,a,e)&&(s.push(m),h.push(a))}return ou(e,h),s}function Sa(e){return e==null?e:op.call(e)}function dg(e,t,s){var a=e==null?0:e.length;return a?(s&&typeof s!="number"&&Xt(e,t,s)?(t=0,s=a):(t=t==null?0:_e(t),s=s===r?a:_e(s)),br(e,t,s)):[]}function gg(e,t){return Fn(e,t)}function yg(e,t,s){return ca(e,t,se(s,2))}function vg(e,t){var s=e==null?0:e.length;if(s){var a=Fn(e,t);if(a<s&&Nr(e[a],t))return a}return-1}function mg(e,t){return Fn(e,t,!0)}function _g(e,t,s){return ca(e,t,se(s,2),!0)}function wg(e,t){var s=e==null?0:e.length;if(s){var a=Fn(e,t,!0)-1;if(Nr(e[a],t))return a}return-1}function bg(e){return e&&e.length?cu(e):[]}function Eg(e,t){return e&&e.length?cu(e,se(t,2)):[]}function xg(e){var t=e==null?0:e.length;return t?br(e,1,t):[]}function Ig(e,t,s){return e&&e.length?(t=s||t===r?1:_e(t),br(e,0,t<0?0:t)):[]}function Sg(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===r?1:_e(t),t=a-t,br(e,t<0?0:t,a)):[]}function Pg(e,t){return e&&e.length?Ln(e,se(t,3),!1,!0):[]}function Ag(e,t){return e&&e.length?Ln(e,se(t,3)):[]}var Cg=Ie(function(e){return pi(Ht(e,1,bt,!0))}),Og=Ie(function(e){var t=Er(e);return bt(t)&&(t=r),pi(Ht(e,1,bt,!0),se(t,2))}),Rg=Ie(function(e){var t=Er(e);return t=typeof t=="function"?t:r,pi(Ht(e,1,bt,!0),r,t)});function Tg(e){return e&&e.length?pi(e):[]}function Ng(e,t){return e&&e.length?pi(e,se(t,2)):[]}function Dg(e,t){return t=typeof t=="function"?t:r,e&&e.length?pi(e,r,t):[]}function Pa(e){if(!(e&&e.length))return[];var t=0;return e=ci(e,function(s){if(bt(s))return t=Mt(s.length,t),!0}),Ho(t,function(s){return st(e,qo(s))})}function Wu(e,t){if(!(e&&e.length))return[];var s=Pa(e);return t==null?s:st(s,function(a){return Ut(t,r,a)})}var Fg=Ie(function(e,t){return bt(e)?Is(e,t):[]}),Lg=Ie(function(e){return ha(ci(e,bt))}),$g=Ie(function(e){var t=Er(e);return bt(t)&&(t=r),ha(ci(e,bt),se(t,2))}),Mg=Ie(function(e){var t=Er(e);return t=typeof t=="function"?t:r,ha(ci(e,bt),r,t)}),jg=Ie(Pa);function Ug(e,t){return fu(e||[],t||[],xs)}function qg(e,t){return fu(e||[],t||[],As)}var zg=Ie(function(e){var t=e.length,s=t>1?e[t-1]:r;return s=typeof s=="function"?(e.pop(),s):r,Wu(e,s)});function Ju(e){var t=f(e);return t.__chain__=!0,t}function kg(e,t){return t(e),e}function Bn(e,t){return t(e)}var Hg=Zr(function(e){var t=e.length,s=t?e[0]:0,a=this.__wrapped__,h=function(p){return Xo(p,e)};return t>1||this.__actions__.length||!(a instanceof Ae)||!Qr(s)?this.thru(h):(a=a.slice(s,+s+(t?1:0)),a.__actions__.push({func:Bn,args:[h],thisArg:r}),new _r(a,this.__chain__).thru(function(p){return t&&!p.length&&p.push(r),p}))});function Bg(){return Ju(this)}function Vg(){return new _r(this.value(),this.__chain__)}function Kg(){this.__values__===r&&(this.__values__=uh(this.value()));var e=this.__index__>=this.__values__.length,t=e?r:this.__values__[this.__index__++];return{done:e,value:t}}function Gg(){return this}function Wg(e){for(var t,s=this;s instanceof On;){var a=ku(s);a.__index__=0,a.__values__=r,t?h.__wrapped__=a:t=a;var h=a;s=s.__wrapped__}return h.__wrapped__=e,t}function Jg(){var e=this.__wrapped__;if(e instanceof Ae){var t=e;return this.__actions__.length&&(t=new Ae(this)),t=t.reverse(),t.__actions__.push({func:Bn,args:[Sa],thisArg:r}),new _r(t,this.__chain__)}return this.thru(Sa)}function Yg(){return lu(this.__wrapped__,this.__actions__)}var Xg=$n(function(e,t,s){Ue.call(e,s)?++e[s]:Yr(e,s,1)});function Zg(e,t,s){var a=me(e)?Ic:kp;return s&&Xt(e,t,s)&&(t=r),a(e,se(t,3))}function Qg(e,t){var s=me(e)?ci:Wc;return s(e,se(t,3))}var ey=Eu(Hu),ty=Eu(Bu);function ry(e,t){return Ht(Vn(e,t),1)}function iy(e,t){return Ht(Vn(e,t),ce)}function sy(e,t,s){return s=s===r?1:_e(s),Ht(Vn(e,t),s)}function Yu(e,t){var s=me(e)?vr:fi;return s(e,se(t,3))}function Xu(e,t){var s=me(e)?xf:Gc;return s(e,se(t,3))}var ny=$n(function(e,t,s){Ue.call(e,s)?e[s].push(t):Yr(e,s,[t])});function oy(e,t,s,a){e=sr(e)?e:os(e),s=s&&!a?_e(s):0;var h=e.length;return s<0&&(s=Mt(h+s,0)),Yn(e)?s<=h&&e.indexOf(t,s)>-1:!!h&&Wi(e,t,s)>-1}var ay=Ie(function(e,t,s){var a=-1,h=typeof t=="function",p=sr(e)?C(e.length):[];return fi(e,function(m){p[++a]=h?Ut(t,m,s):Ss(m,t,s)}),p}),cy=$n(function(e,t,s){Yr(e,s,t)});function Vn(e,t){var s=me(e)?st:eu;return s(e,se(t,3))}function uy(e,t,s,a){return e==null?[]:(me(t)||(t=t==null?[]:[t]),s=a?r:s,me(s)||(s=s==null?[]:[s]),su(e,t,s))}var hy=$n(function(e,t,s){e[s?0:1].push(t)},function(){return[[],[]]});function ly(e,t,s){var a=me(e)?jo:Cc,h=arguments.length<3;return a(e,se(t,4),s,h,fi)}function fy(e,t,s){var a=me(e)?If:Cc,h=arguments.length<3;return a(e,se(t,4),s,h,Gc)}function py(e,t){var s=me(e)?ci:Wc;return s(e,Wn(se(t,3)))}function dy(e){var t=me(e)?Hc:od;return t(e)}function gy(e,t,s){(s?Xt(e,t,s):t===r)?t=1:t=_e(t);var a=me(e)?Mp:ad;return a(e,t)}function yy(e){var t=me(e)?jp:ud;return t(e)}function vy(e){if(e==null)return 0;if(sr(e))return Yn(e)?Yi(e):e.length;var t=Kt(e);return t==we||t==$e?e.size:ia(e).length}function my(e,t,s){var a=me(e)?Uo:hd;return s&&Xt(e,t,s)&&(t=r),a(e,se(t,3))}var _y=Ie(function(e,t){if(e==null)return[];var s=t.length;return s>1&&Xt(e,t[0],t[1])?t=[]:s>2&&Xt(t[0],t[1],t[2])&&(t=[t[0]]),su(e,Ht(t,1),[])}),Kn=Qf||function(){return Ce.Date.now()};function wy(e,t){if(typeof t!="function")throw new mr(d);return e=_e(e),function(){if(--e<1)return t.apply(this,arguments)}}function Zu(e,t,s){return t=s?r:t,t=e&&t==null?e.length:t,Xr(e,j,r,r,r,r,t)}function Qu(e,t){var s;if(typeof t!="function")throw new mr(d);return e=_e(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=r),s}}var Aa=Ie(function(e,t,s){var a=ie;if(s.length){var h=hi(s,ss(Aa));a|=le}return Xr(e,a,t,s,h)}),eh=Ie(function(e,t,s){var a=ie|Ee;if(s.length){var h=hi(s,ss(eh));a|=le}return Xr(t,a,e,s,h)});function th(e,t,s){t=s?r:t;var a=Xr(e,pe,r,r,r,r,r,t);return a.placeholder=th.placeholder,a}function rh(e,t,s){t=s?r:t;var a=Xr(e,he,r,r,r,r,r,t);return a.placeholder=rh.placeholder,a}function ih(e,t,s){var a,h,p,m,_,S,D=0,F=!1,q=!1,W=!0;if(typeof e!="function")throw new mr(d);t=xr(t)||0,ct(s)&&(F=!!s.leading,q="maxWait"in s,p=q?Mt(xr(s.maxWait)||0,t):p,W="trailing"in s?!!s.trailing:W);function te(Et){var Dr=a,ri=h;return a=h=r,D=Et,m=e.apply(ri,Dr),m}function oe(Et){return D=Et,_=Rs(Se,t),F?te(Et):m}function be(Et){var Dr=Et-S,ri=Et-D,Eh=t-Dr;return q?Vt(Eh,p-ri):Eh}function ae(Et){var Dr=Et-S,ri=Et-D;return S===r||Dr>=t||Dr<0||q&&ri>=p}function Se(){var Et=Kn();if(ae(Et))return Oe(Et);_=Rs(Se,be(Et))}function Oe(Et){return _=r,W&&a?te(Et):(a=h=r,m)}function pr(){_!==r&&pu(_),D=0,a=S=h=_=r}function Zt(){return _===r?m:Oe(Kn())}function dr(){var Et=Kn(),Dr=ae(Et);if(a=arguments,h=this,S=Et,Dr){if(_===r)return oe(S);if(q)return pu(_),_=Rs(Se,t),te(S)}return _===r&&(_=Rs(Se,t)),m}return dr.cancel=pr,dr.flush=Zt,dr}var by=Ie(function(e,t){return Kc(e,1,t)}),Ey=Ie(function(e,t,s){return Kc(e,xr(t)||0,s)});function xy(e){return Xr(e,ye)}function Gn(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new mr(d);var s=function(){var a=arguments,h=t?t.apply(this,a):a[0],p=s.cache;if(p.has(h))return p.get(h);var m=e.apply(this,a);return s.cache=p.set(h,m)||p,m};return s.cache=new(Gn.Cache||Jr),s}Gn.Cache=Jr;function Wn(e){if(typeof e!="function")throw new mr(d);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function Iy(e){return Qu(2,e)}var Sy=ld(function(e,t){t=t.length==1&&me(t[0])?st(t[0],hr(se())):st(Ht(t,1),hr(se()));var s=t.length;return Ie(function(a){for(var h=-1,p=Vt(a.length,s);++h<p;)a[h]=t[h].call(this,a[h]);return Ut(e,this,a)})}),Ca=Ie(function(e,t){var s=hi(t,ss(Ca));return Xr(e,le,r,t,s)}),sh=Ie(function(e,t){var s=hi(t,ss(sh));return Xr(e,T,r,t,s)}),Py=Zr(function(e,t){return Xr(e,B,r,r,r,t)});function Ay(e,t){if(typeof e!="function")throw new mr(d);return t=t===r?t:_e(t),Ie(e,t)}function Cy(e,t){if(typeof e!="function")throw new mr(d);return t=t==null?0:Mt(_e(t),0),Ie(function(s){var a=s[t],h=gi(s,0,t);return a&&ui(h,a),Ut(e,this,h)})}function Oy(e,t,s){var a=!0,h=!0;if(typeof e!="function")throw new mr(d);return ct(s)&&(a="leading"in s?!!s.leading:a,h="trailing"in s?!!s.trailing:h),ih(e,t,{leading:a,maxWait:t,trailing:h})}function Ry(e){return Zu(e,1)}function Ty(e,t){return Ca(fa(t),e)}function Ny(){if(!arguments.length)return[];var e=arguments[0];return me(e)?e:[e]}function Dy(e){return wr(e,G)}function Fy(e,t){return t=typeof t=="function"?t:r,wr(e,G,t)}function Ly(e){return wr(e,K|G)}function $y(e,t){return t=typeof t=="function"?t:r,wr(e,K|G,t)}function My(e,t){return t==null||Vc(e,t,qt(t))}function Nr(e,t){return e===t||e!==e&&t!==t}var jy=qn(ea),Uy=qn(function(e,t){return e>=t}),$i=Xc(function(){return arguments}())?Xc:function(e){return yt(e)&&Ue.call(e,"callee")&&!Mc.call(e,"callee")},me=C.isArray,qy=Jt?hr(Jt):Wp;function sr(e){return e!=null&&Jn(e.length)&&!ei(e)}function bt(e){return yt(e)&&sr(e)}function zy(e){return e===!0||e===!1||yt(e)&&Yt(e)==O}var yi=tp||Ua,ky=Or?hr(Or):Jp;function Hy(e){return yt(e)&&e.nodeType===1&&!Ts(e)}function By(e){if(e==null)return!0;if(sr(e)&&(me(e)||typeof e=="string"||typeof e.splice=="function"||yi(e)||ns(e)||$i(e)))return!e.length;var t=Kt(e);if(t==we||t==$e)return!e.size;if(Os(e))return!ia(e).length;for(var s in e)if(Ue.call(e,s))return!1;return!0}function Vy(e,t){return Ps(e,t)}function Ky(e,t,s){s=typeof s=="function"?s:r;var a=s?s(e,t):r;return a===r?Ps(e,t,r,s):!!a}function Oa(e){if(!yt(e))return!1;var t=Yt(e);return t==b||t==c||typeof e.message=="string"&&typeof e.name=="string"&&!Ts(e)}function Gy(e){return typeof e=="number"&&Uc(e)}function ei(e){if(!ct(e))return!1;var t=Yt(e);return t==ee||t==fe||t==R||t==mt}function nh(e){return typeof e=="number"&&e==_e(e)}function Jn(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=k}function ct(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function yt(e){return e!=null&&typeof e=="object"}var oh=yr?hr(yr):Xp;function Wy(e,t){return e===t||ra(e,t,_a(t))}function Jy(e,t,s){return s=typeof s=="function"?s:r,ra(e,t,_a(t),s)}function Yy(e){return ah(e)&&e!=+e}function Xy(e){if(Fd(e))throw new de(l);return Zc(e)}function Zy(e){return e===null}function Qy(e){return e==null}function ah(e){return typeof e=="number"||yt(e)&&Yt(e)==Ne}function Ts(e){if(!yt(e)||Yt(e)!=Pe)return!1;var t=En(e);if(t===null)return!0;var s=Ue.call(t,"constructor")&&t.constructor;return typeof s=="function"&&s instanceof s&&mn.call(s)==Jf}var Ra=Ur?hr(Ur):Zp;function e0(e){return nh(e)&&e>=-k&&e<=k}var ch=ys?hr(ys):Qp;function Yn(e){return typeof e=="string"||!me(e)&&yt(e)&&Yt(e)==Xe}function fr(e){return typeof e=="symbol"||yt(e)&&Yt(e)==Ze}var ns=Ci?hr(Ci):ed;function t0(e){return e===r}function r0(e){return yt(e)&&Kt(e)==ze}function i0(e){return yt(e)&&Yt(e)==Qe}var s0=qn(sa),n0=qn(function(e,t){return e<=t});function uh(e){if(!e)return[];if(sr(e))return Yn(e)?Rr(e):ir(e);if(ms&&e[ms])return Mf(e[ms]());var t=Kt(e),s=t==we?Vo:t==$e?gn:os;return s(e)}function ti(e){if(!e)return e===0?e:0;if(e=xr(e),e===ce||e===-ce){var t=e<0?-1:1;return t*U}return e===e?e:0}function _e(e){var t=ti(e),s=t%1;return t===t?s?t-s:t:0}function hh(e){return e?Ni(_e(e),0,H):0}function xr(e){if(typeof e=="number")return e;if(fr(e))return z;if(ct(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ct(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Oc(e);var s=wo.test(e);return s||Eo.test(e)?ve(e.slice(2),s?2:8):_o.test(e)?z:+e}function lh(e){return zr(e,nr(e))}function o0(e){return e?Ni(_e(e),-k,k):e===0?e:0}function Me(e){return e==null?"":lr(e)}var a0=rs(function(e,t){if(Os(t)||sr(t)){zr(t,qt(t),e);return}for(var s in t)Ue.call(t,s)&&xs(e,s,t[s])}),fh=rs(function(e,t){zr(t,nr(t),e)}),Xn=rs(function(e,t,s,a){zr(t,nr(t),e,a)}),c0=rs(function(e,t,s,a){zr(t,qt(t),e,a)}),u0=Zr(Xo);function h0(e,t){var s=ts(e);return t==null?s:Bc(s,t)}var l0=Ie(function(e,t){e=We(e);var s=-1,a=t.length,h=a>2?t[2]:r;for(h&&Xt(t[0],t[1],h)&&(a=1);++s<a;)for(var p=t[s],m=nr(p),_=-1,S=m.length;++_<S;){var D=m[_],F=e[D];(F===r||Nr(F,Zi[D])&&!Ue.call(e,D))&&(e[D]=p[D])}return e}),f0=Ie(function(e){return e.push(r,Ou),Ut(ph,r,e)});function p0(e,t){return Sc(e,se(t,3),qr)}function d0(e,t){return Sc(e,se(t,3),Qo)}function g0(e,t){return e==null?e:Zo(e,se(t,3),nr)}function y0(e,t){return e==null?e:Jc(e,se(t,3),nr)}function v0(e,t){return e&&qr(e,se(t,3))}function m0(e,t){return e&&Qo(e,se(t,3))}function _0(e){return e==null?[]:Nn(e,qt(e))}function w0(e){return e==null?[]:Nn(e,nr(e))}function Ta(e,t,s){var a=e==null?r:Di(e,t);return a===r?s:a}function b0(e,t){return e!=null&&Nu(e,t,Bp)}function Na(e,t){return e!=null&&Nu(e,t,Vp)}var E0=Iu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=_n.call(t)),e[t]=s},Fa(or)),x0=Iu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=_n.call(t)),Ue.call(e,t)?e[t].push(s):e[t]=[s]},se),I0=Ie(Ss);function qt(e){return sr(e)?kc(e):ia(e)}function nr(e){return sr(e)?kc(e,!0):td(e)}function S0(e,t){var s={};return t=se(t,3),qr(e,function(a,h,p){Yr(s,t(a,h,p),a)}),s}function P0(e,t){var s={};return t=se(t,3),qr(e,function(a,h,p){Yr(s,h,t(a,h,p))}),s}var A0=rs(function(e,t,s){Dn(e,t,s)}),ph=rs(function(e,t,s,a){Dn(e,t,s,a)}),C0=Zr(function(e,t){var s={};if(e==null)return s;var a=!1;t=st(t,function(p){return p=di(p,e),a||(a=p.length>1),p}),zr(e,va(e),s),a&&(s=wr(s,K|J|G,Ed));for(var h=t.length;h--;)ua(s,t[h]);return s});function O0(e,t){return dh(e,Wn(se(t)))}var R0=Zr(function(e,t){return e==null?{}:id(e,t)});function dh(e,t){if(e==null)return{};var s=st(va(e),function(a){return[a]});return t=se(t),nu(e,s,function(a,h){return t(a,h[0])})}function T0(e,t,s){t=di(t,e);var a=-1,h=t.length;for(h||(h=1,e=r);++a<h;){var p=e==null?r:e[kr(t[a])];p===r&&(a=h,p=s),e=ei(p)?p.call(e):p}return e}function N0(e,t,s){return e==null?e:As(e,t,s)}function D0(e,t,s,a){return a=typeof a=="function"?a:r,e==null?e:As(e,t,s,a)}var gh=Au(qt),yh=Au(nr);function F0(e,t,s){var a=me(e),h=a||yi(e)||ns(e);if(t=se(t,4),s==null){var p=e&&e.constructor;h?s=a?new p:[]:ct(e)?s=ei(p)?ts(En(e)):{}:s={}}return(h?vr:qr)(e,function(m,_,S){return t(s,m,_,S)}),s}function L0(e,t){return e==null?!0:ua(e,t)}function $0(e,t,s){return e==null?e:hu(e,t,fa(s))}function M0(e,t,s,a){return a=typeof a=="function"?a:r,e==null?e:hu(e,t,fa(s),a)}function os(e){return e==null?[]:Bo(e,qt(e))}function j0(e){return e==null?[]:Bo(e,nr(e))}function U0(e,t,s){return s===r&&(s=t,t=r),s!==r&&(s=xr(s),s=s===s?s:0),t!==r&&(t=xr(t),t=t===t?t:0),Ni(xr(e),t,s)}function q0(e,t,s){return t=ti(t),s===r?(s=t,t=0):s=ti(s),e=xr(e),Kp(e,t,s)}function z0(e,t,s){if(s&&typeof s!="boolean"&&Xt(e,t,s)&&(t=s=r),s===r&&(typeof t=="boolean"?(s=t,t=r):typeof e=="boolean"&&(s=e,e=r)),e===r&&t===r?(e=0,t=1):(e=ti(e),t===r?(t=e,e=0):t=ti(t)),e>t){var a=e;e=t,t=a}if(s||e%1||t%1){var h=qc();return Vt(e+h*(t-e+Ke("1e-"+((h+"").length-1))),t)}return oa(e,t)}var k0=is(function(e,t,s){return t=t.toLowerCase(),e+(s?vh(t):t)});function vh(e){return Da(Me(e).toLowerCase())}function mh(e){return e=Me(e),e&&e.replace(Kr,Nf).replace(Lo,"")}function H0(e,t,s){e=Me(e),t=lr(t);var a=e.length;s=s===r?a:Ni(_e(s),0,a);var h=s;return s-=t.length,s>=0&&e.slice(s,h)==t}function B0(e){return e=Me(e),e&&rt.test(e)?e.replace(xi,Df):e}function V0(e){return e=Me(e),e&&Ot.test(e)?e.replace(pt,"\\$&"):e}var K0=is(function(e,t,s){return e+(s?"-":"")+t.toLowerCase()}),G0=is(function(e,t,s){return e+(s?" ":"")+t.toLowerCase()}),W0=bu("toLowerCase");function J0(e,t,s){e=Me(e),t=_e(t);var a=t?Yi(e):0;if(!t||a>=t)return e;var h=(t-a)/2;return Un(Pn(h),s)+e+Un(Sn(h),s)}function Y0(e,t,s){e=Me(e),t=_e(t);var a=t?Yi(e):0;return t&&a<t?e+Un(t-a,s):e}function X0(e,t,s){e=Me(e),t=_e(t);var a=t?Yi(e):0;return t&&a<t?Un(t-a,s)+e:e}function Z0(e,t,s){return s||t==null?t=0:t&&(t=+t),np(Me(e).replace(dt,""),t||0)}function Q0(e,t,s){return(s?Xt(e,t,s):t===r)?t=1:t=_e(t),aa(Me(e),t)}function ev(){var e=arguments,t=Me(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var tv=is(function(e,t,s){return e+(s?"_":"")+t.toLowerCase()});function rv(e,t,s){return s&&typeof s!="number"&&Xt(e,t,s)&&(t=s=r),s=s===r?H:s>>>0,s?(e=Me(e),e&&(typeof t=="string"||t!=null&&!Ra(t))&&(t=lr(t),!t&&Ji(e))?gi(Rr(e),0,s):e.split(t,s)):[]}var iv=is(function(e,t,s){return e+(s?" ":"")+Da(t)});function sv(e,t,s){return e=Me(e),s=s==null?0:Ni(_e(s),0,e.length),t=lr(t),e.slice(s,s+t.length)==t}function nv(e,t,s){var a=f.templateSettings;s&&Xt(e,t,s)&&(t=r),e=Me(e),t=Xn({},t,a,Cu);var h=Xn({},t.imports,a.imports,Cu),p=qt(h),m=Bo(h,p),_,S,D=0,F=t.interpolate||zi,q="__p += '",W=Ko((t.escape||zi).source+"|"+F.source+"|"+(F===at?mo:zi).source+"|"+(t.evaluate||zi).source+"|$","g"),te="//# sourceURL="+(Ue.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++$o+"]")+`
`;e.replace(W,function(ae,Se,Oe,pr,Zt,dr){return Oe||(Oe=pr),q+=e.slice(D,dr).replace(Io,Ff),Se&&(_=!0,q+=`' +
__e(`+Se+`) +
'`),Zt&&(S=!0,q+=`';
`+Zt+`;
__p += '`),Oe&&(q+=`' +
((__t = (`+Oe+`)) == null ? '' : __t) +
'`),D=dr+ae.length,ae}),q+=`';
`;var oe=Ue.call(t,"variable")&&t.variable;if(!oe)q=`with (obj) {
`+q+`
}
`;else if(yo.test(oe))throw new de(v);q=(S?q.replace(Mr,""):q).replace(Wt,"$1").replace(Vr,"$1;"),q="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_?", __e = _.escape":"")+(S?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+q+`return __p
}`;var be=wh(function(){return Le(p,te+"return "+q).apply(r,m)});if(be.source=q,Oa(be))throw be;return be}function ov(e){return Me(e).toLowerCase()}function av(e){return Me(e).toUpperCase()}function cv(e,t,s){if(e=Me(e),e&&(s||t===r))return Oc(e);if(!e||!(t=lr(t)))return e;var a=Rr(e),h=Rr(t),p=Rc(a,h),m=Tc(a,h)+1;return gi(a,p,m).join("")}function uv(e,t,s){if(e=Me(e),e&&(s||t===r))return e.slice(0,Dc(e)+1);if(!e||!(t=lr(t)))return e;var a=Rr(e),h=Tc(a,Rr(t))+1;return gi(a,0,h).join("")}function hv(e,t,s){if(e=Me(e),e&&(s||t===r))return e.replace(dt,"");if(!e||!(t=lr(t)))return e;var a=Rr(e),h=Rc(a,Rr(t));return gi(a,h).join("")}function lv(e,t){var s=re,a=ue;if(ct(t)){var h="separator"in t?t.separator:h;s="length"in t?_e(t.length):s,a="omission"in t?lr(t.omission):a}e=Me(e);var p=e.length;if(Ji(e)){var m=Rr(e);p=m.length}if(s>=p)return e;var _=s-Yi(a);if(_<1)return a;var S=m?gi(m,0,_).join(""):e.slice(0,_);if(h===r)return S+a;if(m&&(_+=S.length-_),Ra(h)){if(e.slice(_).search(h)){var D,F=S;for(h.global||(h=Ko(h.source,Me(gr.exec(h))+"g")),h.lastIndex=0;D=h.exec(F);)var q=D.index;S=S.slice(0,q===r?_:q)}}else if(e.indexOf(lr(h),_)!=_){var W=S.lastIndexOf(h);W>-1&&(S=S.slice(0,W))}return S+a}function fv(e){return e=Me(e),e&&ht.test(e)?e.replace(oi,zf):e}var pv=is(function(e,t,s){return e+(s?" ":"")+t.toUpperCase()}),Da=bu("toUpperCase");function _h(e,t,s){return e=Me(e),t=s?r:t,t===r?$f(e)?Bf(e):Af(e):e.match(t)||[]}var wh=Ie(function(e,t){try{return Ut(e,r,t)}catch(s){return Oa(s)?s:new de(s)}}),dv=Zr(function(e,t){return vr(t,function(s){s=kr(s),Yr(e,s,Aa(e[s],e))}),e});function gv(e){var t=e==null?0:e.length,s=se();return e=t?st(e,function(a){if(typeof a[1]!="function")throw new mr(d);return[s(a[0]),a[1]]}):[],Ie(function(a){for(var h=-1;++h<t;){var p=e[h];if(Ut(p[0],this,a))return Ut(p[1],this,a)}})}function yv(e){return zp(wr(e,K))}function Fa(e){return function(){return e}}function vv(e,t){return e==null||e!==e?t:e}var mv=xu(),_v=xu(!0);function or(e){return e}function La(e){return Qc(typeof e=="function"?e:wr(e,K))}function wv(e){return tu(wr(e,K))}function bv(e,t){return ru(e,wr(t,K))}var Ev=Ie(function(e,t){return function(s){return Ss(s,e,t)}}),xv=Ie(function(e,t){return function(s){return Ss(e,s,t)}});function $a(e,t,s){var a=qt(t),h=Nn(t,a);s==null&&!(ct(t)&&(h.length||!a.length))&&(s=t,t=e,e=this,h=Nn(t,qt(t)));var p=!(ct(s)&&"chain"in s)||!!s.chain,m=ei(e);return vr(h,function(_){var S=t[_];e[_]=S,m&&(e.prototype[_]=function(){var D=this.__chain__;if(p||D){var F=e(this.__wrapped__),q=F.__actions__=ir(this.__actions__);return q.push({func:S,args:arguments,thisArg:e}),F.__chain__=D,F}return S.apply(e,ui([this.value()],arguments))})}),e}function Iv(){return Ce._===this&&(Ce._=Yf),this}function Ma(){}function Sv(e){return e=_e(e),Ie(function(t){return iu(t,e)})}var Pv=da(st),Av=da(Ic),Cv=da(Uo);function bh(e){return ba(e)?qo(kr(e)):sd(e)}function Ov(e){return function(t){return e==null?r:Di(e,t)}}var Rv=Su(),Tv=Su(!0);function ja(){return[]}function Ua(){return!1}function Nv(){return{}}function Dv(){return""}function Fv(){return!0}function Lv(e,t){if(e=_e(e),e<1||e>k)return[];var s=H,a=Vt(e,H);t=se(t),e-=H;for(var h=Ho(a,t);++s<e;)t(s);return h}function $v(e){return me(e)?st(e,kr):fr(e)?[e]:ir(zu(Me(e)))}function Mv(e){var t=++Wf;return Me(e)+t}var jv=jn(function(e,t){return e+t},0),Uv=ga("ceil"),qv=jn(function(e,t){return e/t},1),zv=ga("floor");function kv(e){return e&&e.length?Tn(e,or,ea):r}function Hv(e,t){return e&&e.length?Tn(e,se(t,2),ea):r}function Bv(e){return Ac(e,or)}function Vv(e,t){return Ac(e,se(t,2))}function Kv(e){return e&&e.length?Tn(e,or,sa):r}function Gv(e,t){return e&&e.length?Tn(e,se(t,2),sa):r}var Wv=jn(function(e,t){return e*t},1),Jv=ga("round"),Yv=jn(function(e,t){return e-t},0);function Xv(e){return e&&e.length?ko(e,or):0}function Zv(e,t){return e&&e.length?ko(e,se(t,2)):0}return f.after=wy,f.ary=Zu,f.assign=a0,f.assignIn=fh,f.assignInWith=Xn,f.assignWith=c0,f.at=u0,f.before=Qu,f.bind=Aa,f.bindAll=dv,f.bindKey=eh,f.castArray=Ny,f.chain=Ju,f.chunk=zd,f.compact=kd,f.concat=Hd,f.cond=gv,f.conforms=yv,f.constant=Fa,f.countBy=Xg,f.create=h0,f.curry=th,f.curryRight=rh,f.debounce=ih,f.defaults=l0,f.defaultsDeep=f0,f.defer=by,f.delay=Ey,f.difference=Bd,f.differenceBy=Vd,f.differenceWith=Kd,f.drop=Gd,f.dropRight=Wd,f.dropRightWhile=Jd,f.dropWhile=Yd,f.fill=Xd,f.filter=Qg,f.flatMap=ry,f.flatMapDeep=iy,f.flatMapDepth=sy,f.flatten=Vu,f.flattenDeep=Zd,f.flattenDepth=Qd,f.flip=xy,f.flow=mv,f.flowRight=_v,f.fromPairs=eg,f.functions=_0,f.functionsIn=w0,f.groupBy=ny,f.initial=rg,f.intersection=ig,f.intersectionBy=sg,f.intersectionWith=ng,f.invert=E0,f.invertBy=x0,f.invokeMap=ay,f.iteratee=La,f.keyBy=cy,f.keys=qt,f.keysIn=nr,f.map=Vn,f.mapKeys=S0,f.mapValues=P0,f.matches=wv,f.matchesProperty=bv,f.memoize=Gn,f.merge=A0,f.mergeWith=ph,f.method=Ev,f.methodOf=xv,f.mixin=$a,f.negate=Wn,f.nthArg=Sv,f.omit=C0,f.omitBy=O0,f.once=Iy,f.orderBy=uy,f.over=Pv,f.overArgs=Sy,f.overEvery=Av,f.overSome=Cv,f.partial=Ca,f.partialRight=sh,f.partition=hy,f.pick=R0,f.pickBy=dh,f.property=bh,f.propertyOf=Ov,f.pull=ug,f.pullAll=Gu,f.pullAllBy=hg,f.pullAllWith=lg,f.pullAt=fg,f.range=Rv,f.rangeRight=Tv,f.rearg=Py,f.reject=py,f.remove=pg,f.rest=Ay,f.reverse=Sa,f.sampleSize=gy,f.set=N0,f.setWith=D0,f.shuffle=yy,f.slice=dg,f.sortBy=_y,f.sortedUniq=bg,f.sortedUniqBy=Eg,f.split=rv,f.spread=Cy,f.tail=xg,f.take=Ig,f.takeRight=Sg,f.takeRightWhile=Pg,f.takeWhile=Ag,f.tap=kg,f.throttle=Oy,f.thru=Bn,f.toArray=uh,f.toPairs=gh,f.toPairsIn=yh,f.toPath=$v,f.toPlainObject=lh,f.transform=F0,f.unary=Ry,f.union=Cg,f.unionBy=Og,f.unionWith=Rg,f.uniq=Tg,f.uniqBy=Ng,f.uniqWith=Dg,f.unset=L0,f.unzip=Pa,f.unzipWith=Wu,f.update=$0,f.updateWith=M0,f.values=os,f.valuesIn=j0,f.without=Fg,f.words=_h,f.wrap=Ty,f.xor=Lg,f.xorBy=$g,f.xorWith=Mg,f.zip=jg,f.zipObject=Ug,f.zipObjectDeep=qg,f.zipWith=zg,f.entries=gh,f.entriesIn=yh,f.extend=fh,f.extendWith=Xn,$a(f,f),f.add=jv,f.attempt=wh,f.camelCase=k0,f.capitalize=vh,f.ceil=Uv,f.clamp=U0,f.clone=Dy,f.cloneDeep=Ly,f.cloneDeepWith=$y,f.cloneWith=Fy,f.conformsTo=My,f.deburr=mh,f.defaultTo=vv,f.divide=qv,f.endsWith=H0,f.eq=Nr,f.escape=B0,f.escapeRegExp=V0,f.every=Zg,f.find=ey,f.findIndex=Hu,f.findKey=p0,f.findLast=ty,f.findLastIndex=Bu,f.findLastKey=d0,f.floor=zv,f.forEach=Yu,f.forEachRight=Xu,f.forIn=g0,f.forInRight=y0,f.forOwn=v0,f.forOwnRight=m0,f.get=Ta,f.gt=jy,f.gte=Uy,f.has=b0,f.hasIn=Na,f.head=Ku,f.identity=or,f.includes=oy,f.indexOf=tg,f.inRange=q0,f.invoke=I0,f.isArguments=$i,f.isArray=me,f.isArrayBuffer=qy,f.isArrayLike=sr,f.isArrayLikeObject=bt,f.isBoolean=zy,f.isBuffer=yi,f.isDate=ky,f.isElement=Hy,f.isEmpty=By,f.isEqual=Vy,f.isEqualWith=Ky,f.isError=Oa,f.isFinite=Gy,f.isFunction=ei,f.isInteger=nh,f.isLength=Jn,f.isMap=oh,f.isMatch=Wy,f.isMatchWith=Jy,f.isNaN=Yy,f.isNative=Xy,f.isNil=Qy,f.isNull=Zy,f.isNumber=ah,f.isObject=ct,f.isObjectLike=yt,f.isPlainObject=Ts,f.isRegExp=Ra,f.isSafeInteger=e0,f.isSet=ch,f.isString=Yn,f.isSymbol=fr,f.isTypedArray=ns,f.isUndefined=t0,f.isWeakMap=r0,f.isWeakSet=i0,f.join=og,f.kebabCase=K0,f.last=Er,f.lastIndexOf=ag,f.lowerCase=G0,f.lowerFirst=W0,f.lt=s0,f.lte=n0,f.max=kv,f.maxBy=Hv,f.mean=Bv,f.meanBy=Vv,f.min=Kv,f.minBy=Gv,f.stubArray=ja,f.stubFalse=Ua,f.stubObject=Nv,f.stubString=Dv,f.stubTrue=Fv,f.multiply=Wv,f.nth=cg,f.noConflict=Iv,f.noop=Ma,f.now=Kn,f.pad=J0,f.padEnd=Y0,f.padStart=X0,f.parseInt=Z0,f.random=z0,f.reduce=ly,f.reduceRight=fy,f.repeat=Q0,f.replace=ev,f.result=T0,f.round=Jv,f.runInContext=I,f.sample=dy,f.size=vy,f.snakeCase=tv,f.some=my,f.sortedIndex=gg,f.sortedIndexBy=yg,f.sortedIndexOf=vg,f.sortedLastIndex=mg,f.sortedLastIndexBy=_g,f.sortedLastIndexOf=wg,f.startCase=iv,f.startsWith=sv,f.subtract=Yv,f.sum=Xv,f.sumBy=Zv,f.template=nv,f.times=Lv,f.toFinite=ti,f.toInteger=_e,f.toLength=hh,f.toLower=ov,f.toNumber=xr,f.toSafeInteger=o0,f.toString=Me,f.toUpper=av,f.trim=cv,f.trimEnd=uv,f.trimStart=hv,f.truncate=lv,f.unescape=fv,f.uniqueId=Mv,f.upperCase=pv,f.upperFirst=Da,f.each=Yu,f.eachRight=Xu,f.first=Ku,$a(f,function(){var e={};return qr(f,function(t,s){Ue.call(f.prototype,s)||(e[s]=t)}),e}(),{chain:!1}),f.VERSION=n,vr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),vr(["drop","take"],function(e,t){Ae.prototype[e]=function(s){s=s===r?1:Mt(_e(s),0);var a=this.__filtered__&&!t?new Ae(this):this.clone();return a.__filtered__?a.__takeCount__=Vt(s,a.__takeCount__):a.__views__.push({size:Vt(s,H),type:e+(a.__dir__<0?"Right":"")}),a},Ae.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),vr(["filter","map","takeWhile"],function(e,t){var s=t+1,a=s==y||s==X;Ae.prototype[e]=function(h){var p=this.clone();return p.__iteratees__.push({iteratee:se(h,3),type:s}),p.__filtered__=p.__filtered__||a,p}}),vr(["head","last"],function(e,t){var s="take"+(t?"Right":"");Ae.prototype[e]=function(){return this[s](1).value()[0]}}),vr(["initial","tail"],function(e,t){var s="drop"+(t?"":"Right");Ae.prototype[e]=function(){return this.__filtered__?new Ae(this):this[s](1)}}),Ae.prototype.compact=function(){return this.filter(or)},Ae.prototype.find=function(e){return this.filter(e).head()},Ae.prototype.findLast=function(e){return this.reverse().find(e)},Ae.prototype.invokeMap=Ie(function(e,t){return typeof e=="function"?new Ae(this):this.map(function(s){return Ss(s,e,t)})}),Ae.prototype.reject=function(e){return this.filter(Wn(se(e)))},Ae.prototype.slice=function(e,t){e=_e(e);var s=this;return s.__filtered__&&(e>0||t<0)?new Ae(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),t!==r&&(t=_e(t),s=t<0?s.dropRight(-t):s.take(t-e)),s)},Ae.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ae.prototype.toArray=function(){return this.take(H)},qr(Ae.prototype,function(e,t){var s=/^(?:filter|find|map|reject)|While$/.test(t),a=/^(?:head|last)$/.test(t),h=f[a?"take"+(t=="last"?"Right":""):t],p=a||/^find/.test(t);h&&(f.prototype[t]=function(){var m=this.__wrapped__,_=a?[1]:arguments,S=m instanceof Ae,D=_[0],F=S||me(m),q=function(Se){var Oe=h.apply(f,ui([Se],_));return a&&W?Oe[0]:Oe};F&&s&&typeof D=="function"&&D.length!=1&&(S=F=!1);var W=this.__chain__,te=!!this.__actions__.length,oe=p&&!W,be=S&&!te;if(!p&&F){m=be?m:new Ae(this);var ae=e.apply(m,_);return ae.__actions__.push({func:Bn,args:[q],thisArg:r}),new _r(ae,W)}return oe&&be?e.apply(this,_):(ae=this.thru(q),oe?a?ae.value()[0]:ae.value():ae)})}),vr(["pop","push","shift","sort","splice","unshift"],function(e){var t=yn[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",a=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var h=arguments;if(a&&!this.__chain__){var p=this.value();return t.apply(me(p)?p:[],h)}return this[s](function(m){return t.apply(me(m)?m:[],h)})}}),qr(Ae.prototype,function(e,t){var s=f[t];if(s){var a=s.name+"";Ue.call(es,a)||(es[a]=[]),es[a].push({name:t,func:s})}}),es[Mn(r,Ee).name]=[{name:"wrapper",func:r}],Ae.prototype.clone=fp,Ae.prototype.reverse=pp,Ae.prototype.value=dp,f.prototype.at=Hg,f.prototype.chain=Bg,f.prototype.commit=Vg,f.prototype.next=Kg,f.prototype.plant=Wg,f.prototype.reverse=Jg,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=Yg,f.prototype.first=f.prototype.head,ms&&(f.prototype[ms]=Gg),f},Xi=Vf();wt?((wt.exports=Xi)._=Xi,Ge._=Xi):Ce._=Xi}).call(zs)})(ac,ac.exports);var Kb=Object.defineProperty,Gb=Object.defineProperties,Wb=Object.getOwnPropertyDescriptors,El=Object.getOwnPropertySymbols,Jb=Object.prototype.hasOwnProperty,Yb=Object.prototype.propertyIsEnumerable,xl=(u,i,r)=>i in u?Kb(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,Qn=(u,i)=>{for(var r in i||(i={}))Jb.call(i,r)&&xl(u,r,i[r]);if(El)for(var r of El(i))Yb.call(i,r)&&xl(u,r,i[r]);return u},Xb=(u,i)=>Gb(u,Wb(i));function Pr(u,i,r){let n;const o=cc(u);return i.rpcMap&&(n=i.rpcMap[o]),n||(n=`${Vb}?chainId=eip155:${o}&projectId=${r}`),n}function cc(u){return u.includes("eip155")?Number(u.split(":")[1]):Number(u)}function wf(u){return u.map(i=>`${i.split(":")[0]}:${i.split(":")[1]}`)}function Zb(u,i){const r=Object.keys(i.namespaces).filter(o=>o.includes(u));if(!r.length)return[];const n=[];return r.forEach(o=>{const l=i.namespaces[o].accounts;n.push(...l)}),n}function Qb(u={},i={}){const r=Il(u),n=Il(i);return ac.exports.merge(r,n)}function Il(u){var i,r,n,o;const l={};if(!ro(u))return l;for(const[d,v]of Object.entries(u)){const w=jl(d)?[d]:v.chains,A=v.methods||[],L=v.events||[],K=v.rpcMap||{},J=io(d);l[J]=Xb(Qn(Qn({},l[J]),v),{chains:za(w,(i=l[J])==null?void 0:i.chains),methods:za(A,(r=l[J])==null?void 0:r.methods),events:za(L,(n=l[J])==null?void 0:n.events),rpcMap:Qn(Qn({},K),(o=l[J])==null?void 0:o.rpcMap)})}return l}function eE(u){return u.includes(":")?u.split(":")[2]:u}function tE(u){const i={};for(const[r,n]of Object.entries(u)){const o=n.methods||[],l=n.events||[],d=n.accounts||[],v=jl(r)?[r]:n.chains?n.chains:wf(n.accounts);i[r]={chains:v,methods:o,events:l,accounts:d}}return i}const bf={},xt=u=>bf[u],Qa=(u,i)=>{bf[u]=i};class rE{constructor(i){this.name="polkadot",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const n=r||Pr(`${this.name}:${i}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;i[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Pr(i,this.namespace);return typeof n>"u"?void 0:new bi(new qi(n,xt("disableProviderPing")))}}class iE{constructor(i){this.name="eip155",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(i){switch(i.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(i);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(i.request.method)?await this.client.request(i):this.getHttpProvider().request(i.request)}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}setDefaultChain(i,r){const n=cc(i);if(!this.httpProviders[n]){const o=r||Pr(`${this.name}:${n}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);this.setHttpProvider(n,o)}this.chainId=n,this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}createHttpProvider(i,r){const n=r||Pr(`${this.name}:${i}`,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new bi(new qi(n,xt("disableProviderPing")))}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const o=cc(r);i[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const i=this.chainId,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}async handleSwitchChain(i){var r,n;let o=i.request.params?(r=i.request.params[0])==null?void 0:r.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const l=parseInt(o,16);if(this.isChainApproved(l))this.setDefaultChain(`${l}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:i.topic,request:{method:i.request.method,params:[{chainId:o}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${l}`);else throw new Error(`Failed to switch to chain 'eip155:${l}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(i){return this.namespace.chains.includes(`${this.name}:${i}`)}}class sE{constructor(i){this.name="solana",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(!this.httpProviders[i]){const n=r||Pr(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.chainId=i,this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;i[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Pr(i,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new bi(new qi(n,xt("disableProviderPing")))}}class nE{constructor(i){this.name="cosmos",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const n=r||Pr(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;i[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Pr(i,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new bi(new qi(n,xt("disableProviderPing")))}}class oE{constructor(i){this.name="cip34",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const n=r||this.getCardanoRPCUrl(i);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r);i[r]=this.createHttpProvider(r,n)}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}getCardanoRPCUrl(i){const r=this.namespace.rpcMap;if(r)return r[i]}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||this.getCardanoRPCUrl(i);return typeof n>"u"?void 0:new bi(new qi(n,xt("disableProviderPing")))}}class aE{constructor(i){this.name="elrond",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(!this.httpProviders[i]){const n=r||Pr(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.chainId=i,this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;i[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Pr(i,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new bi(new qi(n,xt("disableProviderPing")))}}class cE{constructor(i){this.name="multiversx",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(!this.httpProviders[i]){const n=r||Pr(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.chainId=i,this.events.emit(Ei.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;i[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Pr(i,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new bi(new qi(n,xt("disableProviderPing")))}}var uE=Object.defineProperty,hE=Object.defineProperties,lE=Object.getOwnPropertyDescriptors,Sl=Object.getOwnPropertySymbols,fE=Object.prototype.hasOwnProperty,pE=Object.prototype.propertyIsEnumerable,Pl=(u,i,r)=>i in u?uE(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,eo=(u,i)=>{for(var r in i||(i={}))fE.call(i,r)&&Pl(u,r,i[r]);if(Sl)for(var r of Sl(i))pE.call(i,r)&&Pl(u,r,i[r]);return u},ec=(u,i)=>hE(u,lE(i));class Ec{constructor(i){this.events=new fc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=i,this.logger=typeof i?.logger<"u"&&typeof i?.logger!="string"?i.logger:Re.pino(Re.getDefaultLoggerOptions({level:i?.logger||wl})),this.disableProviderPing=i?.disableProviderPing||!1}static async init(i){const r=new Ec(i);return await r.initialize(),r}async request(i,r){const[n,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:eo({},i),chainId:`${n}:${o}`,topic:this.session.topic})}sendAsync(i,r,n){this.request(i,n).then(o=>r(null,o)).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var i;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(i=this.session)==null?void 0:i.topic,reason:er("USER_DISCONNECTED")}),await this.cleanup()}async connect(i){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(i),await this.cleanupPendingPairings(),!i.skipPairing)return await this.pair(i.pairingTopic)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}removeListener(i,r){this.events.removeListener(i,r)}off(i,r){this.events.off(i,r)}get isWalletConnect(){return!0}async pair(i){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:o}=await this.client.connect({pairingTopic:i,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await o().then(l=>{this.session=l,this.namespaces||(this.namespaces=tE(l.namespaces),this.persist("namespaces",this.namespaces))}).catch(l=>{if(l.message!==mf)throw l;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(i,r){try{if(!this.session)return;const[n,o]=this.validateChain(i);this.getProvider(n).setDefaultChain(o,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(i={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(ls(r)){for(const n of r)i.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const i=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[i]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await jb.init({logger:this.providerOpts.logger||wl,relayUrl:this.providerOpts.relayUrl||kb,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const i=[...new Set(Object.keys(this.session.namespaces).map(r=>io(r)))];Qa("client",this.client),Qa("events",this.events),Qa("disableProviderPing",this.disableProviderPing),i.forEach(r=>{if(!this.session)return;const n=Zb(r,this.session),o=wf(n),l=Qb(this.namespaces,this.optionalNamespaces),d=ec(eo({},l[r]),{accounts:n,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new iE({namespace:d});break;case"solana":this.rpcProviders[r]=new sE({namespace:d});break;case"cosmos":this.rpcProviders[r]=new nE({namespace:d});break;case"polkadot":this.rpcProviders[r]=new rE({namespace:d});break;case"cip34":this.rpcProviders[r]=new oE({namespace:d});break;case"elrond":this.rpcProviders[r]=new aE({namespace:d});break;case"multiversx":this.rpcProviders[r]=new cE({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",i=>{this.events.emit("session_ping",i)}),this.client.on("session_event",i=>{const{params:r}=i,{event:n}=r;if(n.name==="accountsChanged"){const o=n.data;o&&ls(o)&&this.events.emit("accountsChanged",o.map(eE))}else n.name==="chainChanged"?this.onChainChanged(r.chainId):this.events.emit(n.name,n.data);this.events.emit("session_event",i)}),this.client.on("session_update",({topic:i,params:r})=>{var n;const{namespaces:o}=r,l=(n=this.client)==null?void 0:n.session.get(i);this.session=ec(eo({},l),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:i,params:r})}),this.client.on("session_delete",async i=>{await this.cleanup(),this.events.emit("session_delete",i),this.events.emit("disconnect",ec(eo({},er("USER_DISCONNECTED")),{data:i.topic}))}),this.on(Ei.DEFAULT_CHAIN_CHANGED,i=>{this.onChainChanged(i,!0)})}getProvider(i){if(!this.rpcProviders[i])throw new Error(`Provider not found: ${i}`);return this.rpcProviders[i]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(i=>{var r;this.getProvider(i).updateNamespace((r=this.session)==null?void 0:r.namespaces[i])})}setNamespaces(i){const{namespaces:r,optionalNamespaces:n,sessionProperties:o}=i;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(i){const[r,n]=i?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(d=>io(d)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const o=io(Object.keys(this.namespaces)[0]),l=this.rpcProviders[o].getDefaultChain();return[o,l]}async requestAccounts(){const[i]=this.validateChain();return await this.getProvider(i).requestAccounts()}onChainChanged(i,r=!1){var n;if(!this.namespaces)return;const[o,l]=this.validateChain(i);r||this.getProvider(o).setDefaultChain(l),((n=this.namespaces[o])!=null?n:this.namespaces[`${o}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(i,r){this.client.core.storage.setItem(`${bl}/${i}`,r)}async getFromStore(i){return await this.client.core.storage.getItem(`${bl}/${i}`)}}const dE=Ec,gE="wc",yE="ethereum_provider",vE=`${gE}@2:${yE}:`,mE="https://rpc.walletconnect.com/v1/",uc=["eth_sendTransaction","personal_sign"],_E=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],hc=["chainChanged","accountsChanged"],wE=["message","disconnect","connect"];var bE=Object.defineProperty,EE=Object.defineProperties,xE=Object.getOwnPropertyDescriptors,Al=Object.getOwnPropertySymbols,IE=Object.prototype.hasOwnProperty,SE=Object.prototype.propertyIsEnumerable,Cl=(u,i,r)=>i in u?bE(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,ks=(u,i)=>{for(var r in i||(i={}))IE.call(i,r)&&Cl(u,r,i[r]);if(Al)for(var r of Al(i))SE.call(i,r)&&Cl(u,r,i[r]);return u},Ol=(u,i)=>EE(u,xE(i));function ao(u){return Number(u[0].split(":")[1])}function tc(u){return`0x${u.toString(16)}`}function PE(u){const{chains:i,optionalChains:r,methods:n,optionalMethods:o,events:l,optionalEvents:d,rpcMap:v}=u;if(!ls(i))throw new Error("Invalid chains");const w={chains:i,methods:n||uc,events:l||hc,rpcMap:ks({},i.length?{[ao(i)]:v[ao(i)]}:{})},A=l?.filter(G=>!hc.includes(G)),L=n?.filter(G=>!uc.includes(G));if(!r&&!d&&!o&&!(A!=null&&A.length)&&!(L!=null&&L.length))return{required:i.length?w:void 0};const K=A?.length&&L?.length||!r,J={chains:[...new Set(K?w.chains.concat(r||[]):r)],methods:[...new Set(w.methods.concat(o!=null&&o.length?o:_E))],events:[...new Set(w.events.concat(d||wE))],rpcMap:v};return{required:i.length?w:void 0,optional:r.length?J:void 0}}class xc{constructor(){this.events=new Ar.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=vE,this.on=(i,r)=>(this.events.on(i,r),this),this.once=(i,r)=>(this.events.once(i,r),this),this.removeListener=(i,r)=>(this.events.removeListener(i,r),this),this.off=(i,r)=>(this.events.off(i,r),this),this.parseAccount=i=>this.isCompatibleChainId(i)?this.parseAccountId(i).address:i,this.signer={},this.rpc={}}static async init(i){const r=new xc;return await r.initialize(i),r}async request(i){return await this.signer.request(i,this.formatChainId(this.chainId))}sendAsync(i,r){this.signer.sendAsync(i,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(i){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(i);const{required:r,optional:n}=PE(this.rpc);try{const o=await new Promise(async(d,v)=>{var w;this.rpc.showQrModal&&((w=this.modal)==null||w.subscribeModal(A=>{!A.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),v(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Ol(ks({namespaces:ks({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:i?.pairingTopic})).then(A=>{d(A)}).catch(A=>{v(new Error(A.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const l=M1(o.namespaces,[this.namespace]);this.setAccounts(l),this.events.emit("connect",{chainId:tc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",i=>{const{params:r}=i,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",i)}),this.signer.on("chainChanged",i=>{const r=parseInt(i);this.chainId=r,this.events.emit("chainChanged",tc(this.chainId)),this.persist()}),this.signer.on("session_update",i=>{this.events.emit("session_update",i)}),this.signer.on("session_delete",i=>{this.reset(),this.events.emit("session_delete",i),this.events.emit("disconnect",Ol(ks({},er("USER_DISCONNECTED")),{data:i.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",i=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:i})),this.events.emit("display_uri",i)})}switchEthereumChain(i){this.request({method:"wallet_switchEthereumChain",params:[{chainId:i.toString(16)}]})}isCompatibleChainId(i){return typeof i=="string"?i.startsWith(`${this.namespace}:`):!1}formatChainId(i){return`${this.namespace}:${i}`}parseChainId(i){return Number(i.split(":")[1])}setChainIds(i){const r=i.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",tc(this.chainId)),this.persist())}setChainId(i){if(this.isCompatibleChainId(i)){const r=this.parseChainId(i);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(i){const[r,n,o]=i.split(":");return{chainId:`${r}:${n}`,address:o}}setAccounts(i){this.accounts=i.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(i){var r,n;const o=(r=i?.chains)!=null?r:[],l=(n=i?.optionalChains)!=null?n:[],d=o.concat(l);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const v=o.length?i?.methods||uc:[],w=o.length?i?.events||hc:[],A=i?.optionalMethods||[],L=i?.optionalEvents||[],K=i?.rpcMap||this.buildRpcMap(d,i.projectId),J=i?.qrModalOptions||void 0;return{chains:o?.map(G=>this.formatChainId(G)),optionalChains:l.map(G=>this.formatChainId(G)),methods:v,events:w,optionalMethods:A,optionalEvents:L,rpcMap:K,showQrModal:!!(i!=null&&i.showQrModal),qrModalOptions:J,projectId:i.projectId,metadata:i.metadata}}buildRpcMap(i,r){const n={};return i.forEach(o=>{n[o]=this.getRpcUrl(o,r)}),n}async initialize(i){if(this.rpc=this.getRpcConfig(i),this.chainId=this.rpc.chains.length?ao(this.rpc.chains):ao(this.rpc.optionalChains),this.signer=await dE.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:i.disableProviderPing,relayUrl:i.relayUrl,storageOptions:i.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await j1(()=>import("./index-6a8693ef.js").then(o=>o.a),["assets/index-6a8693ef.js","assets/index-3938b977.js","assets/index-316e0ff5.css"]);r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(ks({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(i){if(!i)return;const{chains:r,optionalChains:n,rpcMap:o}=i;r&&ls(r)&&(this.rpc.chains=r.map(l=>this.formatChainId(l)),r.forEach(l=>{this.rpc.rpcMap[l]=o?.[l]||this.getRpcUrl(l)})),n&&ls(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n?.map(l=>this.formatChainId(l)),n.forEach(l=>{this.rpc.rpcMap[l]=o?.[l]||this.getRpcUrl(l)}))}getRpcUrl(i,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[i])||`${mE}?chainId=eip155:${i}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const i=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${i}`]?this.session.namespaces[`${this.namespace}:${i}`]:this.session.namespaces[this.namespace];this.setChainIds(i?[this.formatChainId(i)]:r?.accounts),this.setAccounts(r?.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(i){return typeof i=="string"||i instanceof String?[this.parseAccount(i)]:i.map(r=>this.parseAccount(r))}}const $E=xc;export{$E as EthereumProvider,wE as OPTIONAL_EVENTS,_E as OPTIONAL_METHODS,hc as REQUIRED_EVENTS,uc as REQUIRED_METHODS,xc as default};
